(function(e){e.parser.plugins.push("monthbox"),e.fn.monthbox=function(t,i){if("string"==typeof t){var s=e.fn.editgrid.methods[t];if(s)return s(this,i);throw"不存在此方法："+s}return t=t||{},this.each(function(){var i=e.extend({},e.fn.datebox.parseOptions(this),t);e.fn.datebox.call(e(this),e.extend(!0,{onShowPanel:function(){var t=e(this),i=t.datebox("panel"),s=i.find("div.calendar-title span");s.trigger("click"),setTimeout(function(){tds=i.find("div.calendar-menu-month-inner td"),tds.click(function(i){i.stopPropagation();var n=/\d{4}/.exec(s.html())[0],a=parseInt(e(this).attr("abbr"),10);a<10&&(a="0"+a),t.datebox("hidePanel"),t.datebox("setValue",n+"-"+a)})},0)},parser:function(e){if(!e)return new Date;var t=e.split("-");return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,1)},formatter:function(e){var t=e.getFullYear(),i=e.getMonth()+1;return parseInt(i)<10&&(i="0"+i),t+"-"+i}},i))})}})(jQuery),function(e){function t(t,i){var s=e.data(t,"pekeywords").options,n=s.items,a=i.split("-");return 1==a.length?n[a[0]]:2==a.length?n[a[0]].items[a[1]]:3==a.length?n[a[0]].items[a[1]].items[a[2]]:void 0}function i(t){var i=e(t).empty(),n=e.data(t,"pekeywords").options;"blue"!=n.labelCls&&i.addClass("keywords-label"+n.labelCls);var a="";e.each(n.items,function(t,i){if("chapter"==i.type)a+='<div class="kw-chapter">',""!=i.text&&(a+="<a></a>"+e.hisui.getTrans(i.text)),a+='</div><div class="kw-line"></div>',e.each(i.items,function(s,n){if("section"==n.type)a+='<div class="kw-section"><div class="kw-section-header">'+e.hisui.getTrans(n.text)+"</div>",n.items&&(a+='<ul class="kw-section-list keywords">'),e.each(n.items,function(i,n){var r=n.selected?'class="selected"':"";a+='<li id="'+(n.id||n.text)+'" rowid="'+t+"-"+s+"-"+i+'" '+r+"><a>"+e.hisui.getTrans(n.text)+"</a></li>"}),n.items&&(a+="</ul>"),a+="</div>";else{0==s&&(a+='<ul class="kw-section-list keywords">');var r=n.selected?'class="selected"':"";a+='<li id="'+(n.id||n.text)+'" rowid="'+t+"-"+s+'" '+r+"><a>"+e.hisui.getTrans(n.text)+"</a></li>",s==i.items.length-1&&(a+="</ul>")}});else if("section"==i.type)a+='<div class="kw-section"><div class="kw-section-header">'+e.hisui.getTrans(i.text)+"</div>",i.items&&(a+='<ul class="kw-section-list keywords">'),e.each(i.items,function(i,s){var n=s.selected?'class="selected"':"";a+='<li id="'+(s.id||s.text)+'" rowid="'+t+"-"+i+'" '+n+"><a>"+e.hisui.getTrans(s.text)+"</a></li>"}),i.items&&(a+="</ul>"),a+="</div>";else{0==t&&(a+='<ul class="kw-section-list keywords">');var s=i.selected?" selected ":"";s+=i.labelCls&&""!=i.labelCls?"pe-keywords-a-"+i.labelCls+" ":"",s+=n.superTag?" superTag ":"";var r=n.superTag?' class="superTag" ':"",l=""!=s?'class="'+s+'"':"",o=i.numTag?i.numTag:0,d=o>0?"<span id='numTag_"+(i.id||i.text)+"' class = 'num-tag' >"+o+"</span>":"";a+='<li id="'+(i.id||i.text)+'" rowid="'+t+'" '+l+"><a"+r+" >"+e.hisui.getTrans(i.text)+d+"</a></li>",t==n.items.length-1&&(a+="</ul>")}}),i.append(a),i.off("click").on("click","ul.kw-section-list>li",function(i,n){var a=e(this).attr("id");return s(t,a),!1})}function s(i,s){var n=e(i),a=e.data(i,"pekeywords").options;a.singleSelect&&n.find("li.selected").removeClass("selected");var r=n.find("li#"+s);r.toggleClass("selected");var l=t(i,r.attr("rowid"));a.onClick.call(this,l),a.singleSelect||(r.hasClass("selected")?a.onSelect.call(this,l):a.onUnselect.call(this,l))}function n(t){console.log(t),e(t).find("li.selected").removeClass("selected")}function a(i){var s=[];return e(i).find("li.selected").each(function(){s.push(t(i,e(this).attr("rowid")))}),s}$.parser.plugins.push("pekeywords"),e.fn.pekeywords=function(t,s){return"string"==typeof t?e.fn.pekeywords.methods[t](this,s):(t=t||{},this.each(function(){var s=e.data(this,"pekeywords");s?e.extend(s.options,t):e.data(this,"pekeywords",{options:e.extend({},e.fn.pekeywords.defaults,e.fn.pekeywords.parseOptions(this),t)}),i(this)}))},e.fn.pekeywords.methods={options:function(t){if(t.length>0)return e.data(t[0],"pekeywords").options},getSelected:function(e){if(e.length>0)return a(e[0])},select:function(e,t){if(e.length>0)return s(e[0],t)},switchById:function(e,t){if(e.length>0)return s(e[0],t)},clearAllSelected:function(e,t){e.each(function(e,t){n(t)})}},e.fn.pekeywords.parseOptions=function(t){var i=e(t);return e.extend({},e.parser.parseOptions(t,["id","iconCls","iconAlign","group","size",{plain:"boolean",toggle:"boolean",selected:"boolean"}]),{disabled:!!i.attr("disabled")||void 0})},e.fn.pekeywords.defaults={singleSelect:!1,labelCls:"blue",superTag:!1,onClick:function(e){},onUnselect:function(e){},onSelect:function(e){}}}(jQuery),$.extend($.fn.datagrid.methods,{keyCtr:function(e){return e.each(function(){var e=$(this);e.datagrid("getPanel").panel("panel").attr("tabindex",1).bind("keydown",function(t){switch(t.keyCode){case 38:var i=e.datagrid("getSelected"),s=e.datagrid("getRows");if(i){var n=e.datagrid("getRowIndex",i);n>0&&e.datagrid("selectRow",n-1)}else e.datagrid("selectRow",s.length-1);break;case 40:i=e.datagrid("getSelected");if(i){n=e.datagrid("getRowIndex",i);n<e.datagrid("getRows").length-1&&e.datagrid("selectRow",n+1)}else e.datagrid("selectRow",0);break;case 13:i=e.datagrid("getSelected");if(i){var a=e.datagrid("options").enterHandler;"function"==typeof a&&a(i)}}})})}}),function(e){e.fn._size=function(t,i){function s(t,i,s){if(!i.length)return!1;var n=e(t)[0],a=i[0],r=a.fcount||0;return s?(n.fitted||(n.fitted=!0,a.fcount=r+1,e(a).addClass("panel-noscroll"),"BODY"==a.tagName&&e("html").addClass("panel-fit")),{width:e(a).width()||1,height:e(a).height()||1}):(n.fitted&&(n.fitted=!1,a.fcount=r-1,0==a.fcount&&(e(a).removeClass("panel-noscroll"),"BODY"==a.tagName&&e("html").removeClass("panel-fit"))),!1)}function n(t,i,s,n){var a=e(t),r=i,l=r.substr(0,1).toUpperCase()+r.substr(1),o=e.parser.parseValue("min"+l,n["min"+l],s),d=e.parser.parseValue("max"+l,n["max"+l],s),c=e.parser.parseValue(r,n[r],s),u=String(n[r]||"").indexOf("%")>=0;if(isNaN(c))a._size(r,""),a._size("min"+l,o),a._size("max"+l,d);else{var h=Math.min(Math.max(c,o||0),d||99999);u||(n[r]=h),a._size("min"+l,""),a._size("max"+l,""),a._size(r,h)}return u||n.fit}function a(t,i,s){function n(){return i.toLowerCase().indexOf("width")>=0?a.outerWidth()-a.width():a.outerHeight()-a.height()}var a=e(t);if(null==s){if(s=parseInt(t.style[i]),isNaN(s))return;return e._boxModel&&(s+=n()),s}""===s?a.css(i,""):(e._boxModel&&(s-=n(),s<0&&(s=0)),a.css(i,s+"px"))}return"string"==typeof t?"clear"==t?this.each(function(){e(this).css({width:"",minWidth:"",maxWidth:"",height:"",minHeight:"",maxHeight:""})}):"fit"==t?this.each(function(){s(this,"BODY"==this.tagName?e("body"):e(this).parent(),!0)}):"unfit"==t?this.each(function(){s(this,e(this).parent(),!1)}):null==i?a(this[0],t):this.each(function(){a(this,t,i)}):this.each(function(){i=i||e(this).parent(),e.extend(t,s(this,i,t.fit)||{});var a=n(this,"width",i,t),r=n(this,"height",i,t);a||r?e(this).addClass("easyui-fluid"):e(this).removeClass("easyui-fluid")})}}(jQuery);