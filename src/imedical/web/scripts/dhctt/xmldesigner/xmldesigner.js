(XML="undefined"==typeof XML?function(){}:XML).ObjTree=function(){return this},XML.ObjTree.VERSION="0.23",XML.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="gb2312" ?>\n',XML.ObjTree.prototype.attr_prefix="-",XML.ObjTree.prototype.parseXML=function(t){if(window.DOMParser){var e=new DOMParser,a=e.parseFromString(t,"application/xml");if(!a)return;a=a.documentElement}else window.ActiveXObject&&((e=new ActiveXObject("Microsoft.XMLDOM"))["async"]=!1,e.loadXML(t),a=e.documentElement);if(a)return this.parseDOM(a)},XML.ObjTree.prototype.parseHTTP=function(t,e,a){var n,o,d,l,r,i,s={};for(n in e)s[n]=e[n];return s.method||("undefined"==typeof s.postBody&&"undefined"==typeof s.postbody&&"undefined"==typeof s.parameters?s.method="get":s.method="post"),a?(s.asynchronous=!0,o=this,d=a,l=s.onComplete,s.onComplete=function(t){var e;t&&t.responseXML&&t.responseXML.documentElement&&(e=o.parseDOM(t.responseXML.documentElement)),d(e,t),l&&l(t)}):s.asynchronous=!1,"undefined"!=typeof HTTP&&HTTP.Request?(s.uri=t,(i=new HTTP.Request(s))&&(r=i.transport)):"undefined"!=typeof Ajax&&Ajax.Request&&(i=new Ajax.Request(t,s))&&(r=i.transport),a?r:r&&r.responseXML&&r.responseXML.documentElement?this.parseDOM(r.responseXML.documentElement):void 0},XML.ObjTree.prototype.parseDOM=function(t){if(t){if(this.__force_array={},this.force_array)for(var e=0;e<this.force_array.length;e++)this.__force_array[this.force_array[e]]=1;var a,n=this.parseElement(t);return this.__force_array[t.nodeName]&&(n=[n]),11!=t.nodeType&&((a={})[t.nodeName]=n,n=a),n}},XML.ObjTree.prototype.parseElement=function(t){if(7!=t.nodeType){if(3==t.nodeType||4==t.nodeType)return null==t.nodeValue.match(/[^\x00-\x20]/)?void 0:t.nodeValue;var e={};if(t.attributes&&t.attributes.length)for(var a={},n=0;n<t.attributes.length;n++)"string"==typeof(l=t.attributes[n].nodeName)&&(r=t.attributes[n].nodeValue)&&("undefined"==typeof e[l=this.attr_prefix+l]&&(e[l]=0),e[l]++,this.addNode(a,l,e[l],r));if(t.childNodes&&t.childNodes.length){var o=!0;a&&(o=!1);for(n=0;n<t.childNodes.length&&o;n++){var d=t.childNodes[n].nodeType;3!=d&&4!=d&&(o=!1)}if(o){a=a||"";for(n=0;n<t.childNodes.length;n++)a+=t.childNodes[n].nodeValue}else{a=a||{};for(var l,r,n=0;n<t.childNodes.length;n++)"string"==typeof(l=t.childNodes[n].nodeName)&&(r=this.parseElement(t.childNodes[n]))&&("undefined"==typeof e[l]&&(e[l]=0),e[l]++,this.addNode(a,l,e[l],r))}}return a}},XML.ObjTree.prototype.addNode=function(t,e,a,n){this.__force_array[e]?(1==a&&(t[e]=[]),t[e][t[e].length]=n):1==a?t[e]=n:2==a?t[e]=[t[e],n]:t[e][t[e].length]=n},XML.ObjTree.prototype.writeXML=function(t){t=this.hash_to_xml(null,t);return this.xmlDecl+t},XML.ObjTree.prototype.hash_to_xml=function(t,e){var a,n,o=[],d=[];for(a in e)e.hasOwnProperty(a)&&(n=e[a],a.charAt(0)!=this.attr_prefix?void 0===n||null==n?o[o.length]="<"+a+" />":"object"==typeof n&&n.constructor==Array?o[o.length]=this.array_to_xml(a,n):o[o.length]="object"==typeof n?this.hash_to_xml(a,n):this.scalar_to_xml(a,n):d[d.length]=" "+a.substring(1)+'="'+this.xml_escape(n)+'"');var l=d.join(""),r=o.join("");return r=void 0!==t&&null!=t?0<o.length?r.match(/\n/)?"<"+t+l+">\n"+r+"</"+t+">\n":"<"+t+l+">"+r+"</"+t+">\n":"<"+t+l+" />\n":r},XML.ObjTree.prototype.array_to_xml=function(t,e){for(var a=[],n=0;n<e.length;n++){var o=e[n];void 0===o||null==o?a[a.length]="<"+t+" />":"object"==typeof o&&o.constructor==Array?a[a.length]=this.array_to_xml(t,o):a[a.length]="object"==typeof o?this.hash_to_xml(t,o):this.scalar_to_xml(t,o)}return a.join("")},XML.ObjTree.prototype.scalar_to_xml=function(t,e){return"#text"==t?this.xml_escape(e):"<"+t+">"+this.xml_escape(e)+"</"+t+">\n"},XML.ObjTree.prototype.xml_escape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).label={},function(i){var s=xmldesigner.label,t=(s.data=[],"x-label"),e="labelTpl";function a(t){var e=xmldesigner.label.type,a=(t==s.data.length&&(s.data[t]={id:e+t,name:e+t,ind:t,type:e,x:10,y:10,defaultvalue:e+t,fontsize:10,fontname:"宋体",fontcolor:"#000000",text:e+t,fontbold:"false",height:"",width:"",angle:0,RePrtHeadFlag:"N"}),s.data[t]),n="",n=(a["-name"]?(a.name=a["-name"],a.defaultvalue=a["-defaultvalue"],a.x=ptToPx(a["-xcol"]),a.y=ptToPx(a["-yrow"]),a.fontname=a["-fontname"]||"宋体",a.fontsize=a["-fontsize"],a.fontcolor=a["-fontcolor"]||"#000000",a.height=isNaN(ptToPx(a["-height"]))?"":ptToPx(a["-height"]),a.width=isNaN(ptToPx(a["-width"]))?"":ptToPx(a["-width"]),"C39P36DmTt"==a.fontname&&(a.fontsize=pxToPt(a.fontsize)),a.angle=a["-angle"]||0,n=a["-fontbold"],a.RePrtHeadFlag=a["-RePrtHeadFlag"]||"N",deleteProps(a,["-width","-height","-name","-defaultvalue","-xcol","-yrow","-fontsize","-fontname","-fontcolor","-fontbold","-angle","-RePrtHeadFlag"])):n=a.fontbold,"false"!=n?(a.fontweight="bold",a.fontbold="true"):(a.fontweight="normal",a.fontbold="false"),a.id=e+t,a.type=e,a.ind=t,a.text=a.defaultvalue||"["+a.name+"]",i("#"+a.id));0<n.length?(n.attr("name",a.name).css("left",a.x).css("top",a.y),n.css("font-size",a.fontsize+"pt").css("font-family",a.fontname).css("font-weight",a.fontweight),n.css("color",a.fontcolor),n.css("width",a.width).css("height",a.height).css("transform","rotate(-"+a.angle+"deg)"),n.data("RePrtHeadFlag",a.RePrtHeadFlag),n.text(a.text)):i.tmpl(xmldesigner.label.tplName,a).appendTo("#dbLayout")}i.template(e,"<div id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' data-RePrtHeadFlag='${RePrtHeadFlag}' style='{{if width}}width:${width}px;{{/if}}{{if height}}height:${height}px;{{/if}}z-index:108;left:${x}px;top:${y}px;font-size:${fontsize}pt;font-weight:${fontweight};font-family:${fontname};color:${fontcolor};transform-origin:0 0;transform:rotate(-${angle}deg);' class='ctrldrag x-label ${selectedCls}'>${text}</div>"),xmldesigner.label.cls=t,xmldesigner.label.tplName=e,xmldesigner.label.type="label",xmldesigner.label.method={init:function(){s.data=[]},drawNew:function(){a(s.data.length)},drawByInd:a,showAttrsByInd:function(t){i("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold,#t-fontcolor").prop("disabled",!1);var e,a=s.data[t];for(e in a)i("#tr-"+e).show(),i("#t-"+e).val(a[e])},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){s.data[e].x=parseFloat(t.style.left),s.data[e].y=parseFloat(t.style.top),s.method.showAttrsByInd(e)},drawByAttrTable:function(t){s.data[t].x=parseFloat(i("#t-x").val()),s.data[t].y=parseFloat(i("#t-y").val()),i("#t-name").val()&&(s.data[t].name=i("#t-name").val());var e=parseFloat(i("#t-width").val()),a=parseFloat(i("#t-height").val());s.data[t].width=isNaN(e)?"":e,s.data[t].height=isNaN(a)?"":a,s.data[t].fontsize=i("#t-fontsize").val(),s.data[t].fontbold=i("#t-fontbold").val(),s.data[t].fontname=i("#t-fontname").val(),s.data[t].fontcolor=i("#t-fontcolor").val(),s.data[t].defaultvalue=i("#t-defaultvalue").val(),s.data[t].angle=i("#t-angle").val(),s.data[t].RePrtHeadFlag=i("#t-RePrtHeadFlag").val(),s.method.drawByInd(t)},genXmlJson:function(){for(var t=[],e=0;e<s.data.length;e++){var a,n,o,d=(o=s.data[e]).fontsize;"C39P36DmTt"==o.fontname&&(d=ptToPx(o.fontsize)),"undefined"!=typeof o.delFlag&&1==o.delFlag||(d={"-name":o.name,"-xcol":pxToPt(o.x),"-yrow":pxToPt(o.y),"-defaultvalue":o.defaultvalue||"","-printvalue":o.printvalue||"","-fontbold":o.fontbold,"-fontname":o.fontname,"-fontsize":d,"-RePrtHeadFlag":o.RePrtHeadFlag},a=isNaN(pxToPt(o.width))?"":pxToPt(o.width),n=isNaN(pxToPt(o.height))?"":pxToPt(o.height),0<a&&(d["-width"]=a),0<n&&(d["-height"]=n),0<o.angle&&(d["-angle"]=o.angle),"#000000"!=o.fontcolor&&(d["-fontcolor"]=o.fontcolor),t.push(d))}return t},delItem:function(t){s.data[t].delFlag=!0,i("#"+xmldesigner.label.type+t).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:s.data[e].x,y:s.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=s.data[t],d=s.type,l=i("#"+d+t).height(),r=i("#"+d+t).width();switch(e){case"x":o.x=a;break;case"y":o.y=a;break;case"b":o.y=a-l;break;case"r":o.x=a-r;break;case"ha":o.y=a-l/2;break;case"va":o.x=a-r/2}s.method.drawByInd(t)},move:function(t,e,a){var n=s.data[e];n&&("left"==t?n.x=n.x-a:"right"==t?n.x=n.x+a:"top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),s.method.drawByInd(e)}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).line={},function(l){var s=xmldesigner.line,t=(s.data=[],"x-line"),e="lineTpl";l.template(e,"<div id='st${id}' data-ind='${ind}' data-type='${type}' data-RePrtHeadFlag='${RePrtHeadFlag}' style='left:${stx}px;top:${sty}px;z-index:107;' class='ctrldrag x-line st-point'></div><div id='mid${id}' data-ind='${ind}' data-type='${type}' style='left:${midx}px;top:${midy}px;z-index:107;' class='ctrldrag x-line mid-point'></div><div id='end${id}' data-ind='${ind}' data-type='${type}' style='left:${endx}px;top:${endy}px;z-index:107;' class='ctrldrag x-line end-point'></div>"),xmldesigner.line.cls=t,xmldesigner.line.type="line",xmldesigner.line.tplName=e,xmldesigner.line.method={init:function(){s.data=[]},drawNew:function(){var t=xmldesigner.line.type,e=s.data.length;s.data[e]={id:t+e,ind:e,name:t+e,type:t,stx:10,sty:10,endx:100,endy:10,RePrtHeadFlag:"N",fontcolor:"#000000"},s.method.draw()},drawByInd:function(){},draw:function(){for(var t,e=xmldesigner.line.type,a=[],n=0;n<selectCompSet.length;n++)selectCompSet[n].attr("data-type")==e&&a.push(selectCompSet[n].attr("data-ind"));mycontext&&mycontext.clearRect(0,0,mycanvas.width,mycanvas.height);for(var o,d=0;d<s.data.length;d++)t=s.data[d],mycontext&&mycontext.beginPath(),"boolean"==typeof t.delFlag&&1==t.delFlag||((o=t).midx=(parseFloat(o.stx)+parseFloat(o.endx))/2,o.midy=(parseFloat(o.sty)+parseFloat(o.endy))/2,document.getElementById("end"+e+d)?(document.getElementById("st"+e+d).style.top=t.sty+"px",document.getElementById("st"+e+d).style.left=t.stx+"px",document.getElementById("end"+e+d).style.top=t.endy+"px",document.getElementById("end"+e+d).style.left=t.endx+"px",document.getElementById("mid"+e+d).style.top=t.midy+"px",document.getElementById("mid"+e+d).style.left=t.midx+"px",l("#st"+e+d).data("RePrtHeadFlag",t.RePrtHeadFlag||"N")):l.tmpl(xmldesigner.line.tplName,t).appendTo("#dbLayout"),-1<a.indexOf(""+d)?(mycontext&&(mycontext.strokeStyle="green"),document.getElementById("st"+e+d).style.visibility="visible",document.getElementById("midline"+d).style.visibility="visible",document.getElementById("end"+e+d).style.visibility="visible"):(mycontext&&(mycontext.strokeStyle="black"),document.getElementById("end"+e+d)&&(document.getElementById("st"+e+d).style.visibility="hidden",document.getElementById("midline"+d).style.visibility="hidden",document.getElementById("end"+e+d).style.visibility="hidden")),mycontext&&("#000000"!=t.fontcolor&&(mycontext.strokeStyle=t.fontcolor),mycontext.moveTo(t.stx,t.sty),mycontext.lineTo(t.endx,t.endy),mycontext.stroke(),mycontext.strokeStyle="#000000"))},showAttrsByInd:function(t){l("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold","#t-fontcolor").prop("disabled",!1);var e,a=s.data[t];for(e in a)"y"!=e&&(l("#tr-"+e).show(),l("#t-"+e).val(a[e]))},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){var n=a.clientX,a=a.clientY,n=n-dragParams.currentX,a=a-dragParams.currentY;(t=l(t)).hasClass("mid-point")?(s.data[e].stx+=n,s.data[e].sty+=a,s.data[e].endx+=n,s.data[e].endy+=a):t.hasClass("st-point")?(s.data[e].stx+=n,s.data[e].sty+=a):t.hasClass("end-point")&&(s.data[e].endx+=n,s.data[e].endy+=a),s.method.draw(),xmldesigner.line.method.showAttrsByInd(e)},drawByAttrTable:function(t){s.data[t].stx=parseFloat(l("#t-stx").val()),s.data[t].sty=parseFloat(l("#t-sty").val()),s.data[t].endx=parseFloat(l("#t-endx").val()),s.data[t].endy=parseFloat(l("#t-endy").val()),s.data[t].RePrtHeadFlag=l("#t-RePrtHeadFlag").val(),s.data[t].fontcolor=l("#t-fontcolor").val(),s.method.draw()},genXmlJson:function(){for(var t,e,a=[],n=0;n<s.data.length;n++)"boolean"==typeof(e=s.data[n]).delFlag&&1==e.delFlag||(t={"-BeginX":pxToPt(e.stx),"-BeginY":pxToPt(e.sty),"-EndX":pxToPt(e.endx),"-EndY":pxToPt(e.endy),"-RePrtHeadFlag":e.RePrtHeadFlag},"#000000"!=e.fontcolor&&(t["-fontcolor"]=e.fontcolor),a.push(t));return a},item2Json:function(t,e){var a=xmldesigner.line.type;return(a={id:a+e,ind:e,name:a+e,type:a,RePrtHeadFlag:t[e]["-RePrtHeadFlag"]||"N",stx:ptToPx(t[e]["-BeginX"]),sty:ptToPx(t[e]["-BeginY"]),endx:ptToPx(t[e]["-EndX"]),endy:ptToPx(t[e]["-EndY"])}).fontcolor=t[e]["-fontcolor"]||"#000000",a},delItem:function(t){var e=xmldesigner.line.type;s.data[t].delFlag=!0,l("#st"+e+t).remove(),l("#end"+e+t).remove(),l("#mid"+e+t).remove()},getItemOffset:function(t){return t=t.attr("data-ind"),{x:(t=s.data[t]).stx,y:t.sty,w:t.endx-t.stx,h:t.endy-t.sty}},alignItem:function(t,e,a,n){var o=s.data[t];switch(h=o.endy-o.sty,w=o.endx-o.stx,e){case"x":o.endx-=o.stx-a,o.stx=a;break;case"y":o.endy-=o.sty-a,o.sty=a;break;case"b":o.sty=a-h,o.endy=a;break;case"r":o.stx=a-w,o.endx=a;break;case"ha":o.sty=a-h/2,o.endy=a+h/2;break;case"va":o.stx=a-w/2,o.endx=a+w/2;break;case"h":o.endy=a+o.sty;break;case"w":o.endx=a+o.stx;break;case"s":o.endy=a+o.sty,o.endx=n+o.stx}},getLineByPoint:function(t,e){for(var a,n,o,d,l,r=0;r<s.data.length;r++){var i=s.data[r];if(a=t,n=e,o=i.stx,d=i.sty,l=i.endx,i=i.endy,Math.sqrt(Math.pow(a-o,2)+Math.pow(n-d,2))+Math.sqrt(Math.pow(l-a,2)+Math.pow(i-n,2))-Math.sqrt(Math.pow(l-o,2)+Math.pow(i-d,2))<.3)return r}return-1},move:function(t,e,a){(e=s.data[e])&&("left"==t?(e.stx=e.stx-a,e.endx=e.endx-a):"right"==t?(e.stx=e.stx+a,e.endx=e.endx+a):"top"==t?(e.sty=e.sty-a,e.endy=e.endy-a):"bottom"==t&&(e.sty=e.sty+a,e.endy=e.endy+a))}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).img={},function(i){var s=xmldesigner.img,o=(s.data=[],location.href.split("/web/")[0]+"/web/"),d="scripts/dhctt/xmldesigner/img/defaultimg.jpg";function t(t){i("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold").prop("disabled",!1);var e=xmldesigner.img.type,a=!1,n=(t==s.data.length&&(s.data[t]={id:e+t,name:e+t,ind:t,type:e,x:10,y:10,height:130,width:130,src:o+d,defaultvalue:o+d,RePrtHeadFlag:"N"},a=!0),s.data[t]),a=(a||(n.src=n.defaultvalue),n.id=e+t,n.type=e,n.ind=t,i("#"+n.id));0<a.length?(a.attr("name",n.name).css("left",n.x).css("top",n.y).attr("src",n.src).css("height",n.height).css("width",n.width),a.data("RePrtHeadFlag",n.RePrtHeadFlag||"N")):i.tmpl(xmldesigner.img.tplName,n).appendTo("#dbLayout")}i.template("imgTpl","<img id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' data-RePrtHeadFlag='${RePrtHeadFlag}' style='z-index:103;left:${x}px;top:${y}px;width:${width}px;height:${height}px;' src='${src}' class='ctrldrag x-img ${selectedCls}'/>"),xmldesigner.img.cls="x-img",xmldesigner.img.tplName="imgTpl",xmldesigner.img.type="img",xmldesigner.img.method={init:function(){s.data=[]},item2Json:function(t,e){var a=xmldesigner.img.type;return(t=t[e])["-defaultvalue"]||(t["-defaultvalue"]=""),t["-printvalue"]||(t["-printvalue"]=""),t["-xcol"]||(t["-xcol"]=1),t["-yrow"]||(t["-yrow"]=1),t["-name"]||(t["-name"]="undefinedNameImg"),{id:a+e,ind:e,name:a+e,type:a,src:src=t["-src"]||(1==(e=t["-defaultvalue"]).split("web\\").length?o+d:o+e.split("web\\")[1].split("\\").join("/")),name:t["-name"],height:t["-height"]?ptToPx(t["-height"]):130,width:t["-width"]?ptToPx(t["-width"]):130,x:ptToPx(t["-xcol"]),y:ptToPx(t["-yrow"]),defaultvalue:t["-defaultvalue"],RePrtHeadFlag:t["-RePrtHeadFlag"]}},drawNew:function(){t(s.data.length)},drawByInd:t,showAttrsByInd:function(t){var e,a=s.data[t];for(e in a)i("#tr-"+e).show(),i("#t-"+e).val(a[e])},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){s.data[e].x=parseFloat(t.style.left),s.data[e].y=parseFloat(t.style.top),xmldesigner.img.method.showAttrsByInd(e)},drawByAttrTable:function(t){s.data[t].x=parseFloat(i("#t-x").val()),s.data[t].y=parseFloat(i("#t-y").val()),s.data[t].height=i("#t-height").val(),s.data[t].width=i("#t-width").val(),i("#t-name").val()&&(s.data[t].name=i("#t-name").val()),s.data[t].defaultvalue=i("#t-defaultvalue").val(),s.data[t].src=i("#t-src").val(),s.data[t].RePrtHeadFlag=i("#t-RePrtHeadFlag").val(),s.method.drawByInd(t)},genXmlJson:function(){for(var t,e=[],a=0;a<s.data.length;a++)"boolean"==typeof(t=s.data[a]).delFlag&&1==t.delFlag||e.push({"-name":t.name,"-xcol":pxToPt(t.x),"-yrow":pxToPt(t.y),"-height":pxToPt(t.height),"-width":pxToPt(t.width),"-defaultvalue":t.defaultvalue||"","-printvalue":t.printvalue||"","-RePrtHeadFlag":t.RePrtHeadFlag||"N"});return e},delItem:function(t){s.data[t].delFlag=!0,i("#"+xmldesigner.img.type+t).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:s.data[e].x,y:s.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=s.data[t],d=s.type,l=i("#"+d+t).height(),r=i("#"+d+t).width();switch(e){case"x":o.x=a;break;case"y":o.y=a;break;case"b":o.y=a-l;break;case"r":o.x=a-r;break;case"ha":o.y=a-l/2;break;case"va":o.x=a-r/2}s.method.drawByInd(t)},move:function(t,e,a){var n=s.data[e];n&&("left"==t?n.x=n.x-a:"right"==t?n.x=n.x+a:"top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),s.method.drawByInd(e)}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).list={},function(r){var i=xmldesigner.list,t=(i.data=[],"listTpl");function e(t){var e=xmldesigner.list.type,e=(t==i.data.length&&(i.data[t]={id:e+t,name:e+t,ind:t,type:e,width:ptToPx(10*invoiceData.width),height:15,YStep:15,XStep:0,x:0,y:0,CurrentRow:1,PageRows:100,RePrtHeadFlag:"N"}),xmldesigner.list.type),a=i.data[t],e=r("#"+e+t);if(0<e.length){if(e.width(i.data[t].width).height(a.height).css("top",a.y),r("."+xmldesigner.listItem.cls).css("top",a.y),xmldesigner.listItem.data)for(var n=0;n<xmldesigner.listItem.data.length;n++)xmldesigner.listItem.data[n].y=a.y}else r.tmpl(xmldesigner.list.tplName,a).appendTo("#dbLayout")}r.template(t,"<div id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' style='z-index:105;left:${x}px;top:${y}px;width:${width}px;height:${height}px;' class='ctrldrag x-list ${selectedCls}'></div>"),xmldesigner.list.cls="x-list",xmldesigner.list.type="list",xmldesigner.list.tplName=t,xmldesigner.list.method={init:function(){i.data=[]},item2Json:function(t,e){var a=xmldesigner.list.type;return"undefined"!=t["-YStep"]&&"undefined"!=typeof t["-YStep"]||(t["-YStep"]=10),"undefined"!=t["-CurrentRow"]&&"undefined"!=typeof t["-CurrentRow"]||(t["-CurrentRow"]=1),"undefined"!=t["-PageRows"]&&"undefined"!=typeof t["-PageRows"]||(t["-PageRows"]=20),"undefined"!=t["-RePrtHeadFlag"]&&"undefined"!=typeof t["-RePrtHeadFlag"]||(t["-RePrtHeadFlag"]="N"),"undefined"!=t["-BackSlashWidth"]&&"undefined"!=typeof t["-BackSlashWidth"]||(t["-BackSlashWidth"]=0),{id:a+e,name:a+e,ind:e,type:a,width:ptToPx(10*invoiceData.width),x:"0",y:"0",height:ptToPx(t["-YStep"]),YStep:ptToPx(t["-YStep"]),XStep:0,CurrentRow:t["-CurrentRow"],PageRows:t["-PageRows"],RePrtHeadFlag:t["-RePrtHeadFlag"],BackSlashWidth:t["-BackSlashWidth"]}},drawNew:function(){0<r("#"+xmldesigner.list.type+"0").length?r.messager.alert("提示","已有列表, 请增加列项."):e(i.data.length)},drawByInd:e,showAttrsByInd:function(t){var e,a=i.data[t];for(e in a)"height"!=e&&"width"!=e&&"name"!=e&&"x"!=e&&(r("#tr-"+e).show(),r("#t-"+e).val(a[e]))},dragMove:function(t,e){t=t.clientY-e.currentY,r("."+xmldesigner.listItem.cls).css("top",parseFloat(e.top)+t+"px"),e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){i.data[e].x=parseFloat(t.style.left),i.data[e].y=parseFloat(t.style.top),xmldesigner.list.method.showAttrsByInd(e);var n=xmldesigner.listItem.data;if(xmldesigner.listItem.data)for(var o=0;o<n.length;o++)n[o].y=i.data[e].y},drawByAttrTable:function(t){i.data[t].y=parseFloat(r("#t-y").val()),i.data[t].PageRows=r("#t-PageRows").val(),i.data[t].CurrentRow=r("#t-CurrentRow").val(),i.data[t].YStep=r("#t-YStep").val(),i.data[t].height=r("#t-YStep").val(),r("#t-height").val(i.data[t].height),i.data[t].RePrtHeadFlag=r("#t-RePrtHeadFlag").val();var e=r("#t-BackSlashWidth").val();i.data[t].BackSlashWidth=""==e?0:e,i.method.drawByInd(t)},genXmlJson:function(){for(var t,e=[],a=0;a<i.data.length;a++)"undefined"!=typeof(t=i.data[a]).delFlag&&1==t.delFlag||e.push({"-PrintType":"List","-YStep":pxToPt(t.height)||10,"-XStep":0,"-CurrentRow":t.CurrentRow||1,"-PageRows":t.PageRows||10,"-RePrtHeadFlag":t.RePrtHeadFlag||"N","-BackSlashWidth":t.BackSlashWidth||0,Listdatapara:[]});return e},delItem:function(t){i.data[t].delFlag=!0,r("#"+xmldesigner.list.type+t).remove(),r("."+xmldesigner.listItem.cls).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:i.data[e].x,y:i.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=i.data[t],d=i.type,l=r("#"+d+t).height();switch(r("#"+d+t).width(),e){case"x":break;case"y":o.y=a;break;case"b":o.y=a-l;break;case"r":break;case"ha":o.y=a-l/2}i.method.drawByInd(t)},move:function(t,e,a){var n=i.data[e];n&&("top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),i.method.drawByInd(e)}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).listItem={},function(r){var i=xmldesigner.listItem,t=(i.data=[],"x-listItem"),e="listItemTpl";function a(t){var e=xmldesigner.listItem.type;if(!xmldesigner.list.data[0])return alert("请先画出列表, 再画列表项."),!1;t==i.data.length&&(a=150,0<i.data.length&&(a+=i.data[t-1].x),i.data[t]={id:e+t,name:e+t,ind:t,type:e,x:a,y:xmldesigner.list.data[xmldesigner.list.data.length-1].y,fontsize:10,fontname:"宋体",text:e+t,fontbold:"false",fontcolor:"#000000",coltype:"text",width:"",height:"",barcodetype:"",isshowtext:"",qrcodeversion:"",defaultvalue:""});var a=i.data[t],n="",n=(a["-name"]?(a.name=a["-name"],a.defaultvalue=a["-defaultvalue"],a.x=ptToPx(a["-xcol"]),a.y=ptToPx(a["-yrow"]),a.coltype=a["-coltype"]||"text",a.width=a["-width"]?ptToPx(a["-width"]):"",a.height=a["-height"]?ptToPx(a["-height"]):"",a.barcodetype=a["-barcodetype"]||"",a.isshowtext=a["-isshowtext"]||"",a.qrcodeversion=a["-qrcodeversion"]||"",a.fontsize=a["-fontsize"],a.fontname=a["-fontname"]||"宋体",n=a["-fontbold"],a.fontcolor=a["-fontcolor"]||"#000000",deleteProps(a,["-name","-defaultvalue","-xcol","-yrow","-fontsize","-fontname","-fontbold","-fontcolor","-coltype","-width","-height","-barcodetype","-isshowtext","-qrcodeversion"])):n=a.fontbold,"false"!=n?(a.fontweight="bold",a.fontbold="true"):(a.fontweight="normal",a.fontbold="false"),a.id=e+t,a.type=e,a.ind=t,a.text=a.defaultvalue||"|"+a.name,r("#"+a.id));0<n.length?(n.data("coltype",a.coltype).css("width",a.width).css("height",a.height),n.attr("name",a.name),n.css("left",a.x).css("top",a.y).css("font-size",a.fontsize+"pt").css("font-family",a.fontname).css("font-weight",a.fontweight),n.css("color",a.fontcolor),n.text(a.text)):r.tmpl(xmldesigner.listItem.tplName,a).appendTo("#dbLayout")}function n(t){for(var e in i.data[t])r("#t-"+e).prop("disabled",!1);i.data[t].coltype=r("#t-coltype").val(),("img"==i.data[t].coltype?r("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold"):"barcode"==i.data[t].coltype?r("#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold"):"qrcode"==i.data[t].coltype?r("#t-barcodetype,#t-isshowtext,#t-fontsize,#t-fontname,#t-fontbold"):r("#t-barcodetype,#t-isshowtext,#t-qrcodeversion")).prop("disabled",!0);var a=parseFloat(r("#t-width").val()),n=parseFloat(r("#t-height").val());i.data[t].width=isNaN(a)?"":a,i.data[t].height=isNaN(n)?"":n,""!=r("#t-barcodetype").val()&&(i.data[t].barcodetype=r("#t-barcodetype").val()),""!=r("#t-isshowtext").val()&&(i.data[t].isshowtext=r("#t-isshowtext").val()),""!=r("#t-qrcodeversion").val()&&(i.data[t].qrcodeversion=r("#t-qrcodeversion").val()),""!=r("#t-fontcolor").val()&&(i.data[t].fontcolor=r("#t-fontcolor").val()),i.data[t].x=parseFloat(r("#t-x").val()),i.data[t].y=parseFloat(r("#t-y").val()),r("#t-name").val()&&(i.data[t].name=r("#t-name").val()),i.data[t].fontsize=r("#t-fontsize").val(),i.data[t].fontbold=r("#t-fontbold").val(),i.data[t].fontname=r("#t-fontname").val(),i.data[t].defaultvalue=r("#t-defaultvalue").val(),i.method.drawByInd(t)}r.template(e,"<div id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' data-coltype='${coltype}' style='z-index:106;left:${x}px;top:${y}px;font-size:${fontsize}pt;font-weight:${fontweight};font-family:${fontname};color:${fontcolor};{{if width}}width:${width}px;{{/if}}{{if height}}height:${height}px;{{/if}}' class='ctrldrag x-listItem ${selectedCls}'>${text}</div>"),xmldesigner.listItem.cls=t,xmldesigner.listItem.type="listItem",xmldesigner.listItem.tplName=e,xmldesigner.listItem.method={init:function(){i.data=[]},drawNew:function(){a(i.data.length)},drawByInd:a,showAttrsByInd:function(t){var e,a=i.data[t];for(e in a)r("#tr-"+e).show(),r("#t-"+e).prop("disabled",!1),r("#t-"+e).val(a[e]);n(t)},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){i.data[e].x=parseFloat(t.style.left),i.data[e].y=parseFloat(t.style.top),i.method.showAttrsByInd(e)},drawByAttrTable:n,genXmlJson:function(){for(var t,e,a=[],n=0;n<i.data.length;n++)"undefined"!=typeof(e=i.data[n]).delFlag&&1==e.delFlag||(t={"-name":e.name,"-xcol":pxToPt(e.x),"-yrow":pxToPt(e.y),"-defaultvalue":e.defaultvalue||"","-printvalue":e.printvalue||"","-fontbold":e.fontbold,"-fontname":e.fontname,"-fontsize":e.fontsize,"-coltype":e.coltype||"text"},""!=e.width&&(t["-width"]=pxToPt(e.width)),""!=e.height&&(t["-height"]=pxToPt(e.height)),""!=e.barcodetype&&(t["-barcodetype"]=e.barcodetype),""!=e.isshowtext&&(t["-isshowtext"]=e.isshowtext),""!=e.qrcodeversion&&(t["-qrcodeversion"]=e.qrcodeversion),""!=e.fontcolor&&"undefined"!=typeof e.fontcolor||(e.fontcolor="#000000"),"#000000"!=e.fontcolor&&(t["-fontcolor"]=e.fontcolor),"text"==e.coltype?deleteProps(t,["coltype","-barcodetype","-isshowtext","-qrcodeversion"]):"img"==e.coltype?deleteProps(t,["-barcodetype","-isshowtext","-qrcodeversion","fontcolor"]):"barcode"==e.coltype?deleteProps(t,["-qrcodeversion"]):"qrcode"==e.coltype&&deleteProps(t,["-barcodetype","-isshowtext"]),a.push(t));return a},delItem:function(t){i.data[t].delFlag=!0,r("#"+xmldesigner.listItem.type+t).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:i.data[e].x,y:i.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=i.data[t],d=i.type,l=(r("#"+d+t).height(),r("#"+d+t).width());switch(e){case"x":o.x=a;break;case"y":case"b":break;case"r":o.x=a-l;break;case"ha":break;case"va":o.x=a-l/2}i.method.drawByInd(t)},move:function(t,e,a){var n=i.data[e];n&&("left"==t?n.x=n.x-a:"right"==t?n.x=n.x+a:"top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),i.method.drawByInd(e)}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).qrcode={},function(i){var s=xmldesigner.qrcode,t=(s.data=[],"x-qrcode"),e="qrcodeTpl";function a(t){var e=xmldesigner.qrcode.type,a=(t==s.data.length&&(s.data[t]={name:e+t,width:100,height:100,x:10,y:10,defaultvalue:e+t,fontcolor:"#000000",id:e+t,ind:t,type:e,qrcodeversion:"",RePrtHeadFlag:"N"}),s.data[t]),e=(a["-name"]&&(a.name=a["-name"],a.defaultvalue=a["-defaultvalue"],a.qrcodeversion=a["-qrcodeversion"],a.x=ptToPx(a["-xcol"]),a.y=ptToPx(a["-yrow"]),a.width=ptToPx(a["-width"]),a.height=ptToPx(a["-height"]),a.RePrtHeadFlag=a["-RePrtHeadFlag"]||"N",a.fontcolor=a["-fontcolor"]||"#000000",deleteProps(a,["-name","-defaultvalue","-xcol","-yrow","-fontsize","-fontname","-fontbold","-fontcolor","-width","-height","-qrcodeversion","-RePrtHeadFlag"])),a.id=e+t,a.type=e,a.ind=t,i("#"+a.id));0<e.length?(e.attr("name",a.name).css("left",a.x).css("top",a.y),e.css("width",a.width).css("height",a.height),e.css("backgroundColor",a.fontcolor),e.data("RePrtHeadFlag",a.RePrtHeadFlag)):i.tmpl(xmldesigner.qrcode.tplName,a).appendTo("#dbLayout")}i.template(e,"<img id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' data-qrcodeversion='${qrcodeversion}' data-RePrtHeadFlag='${RePrtHeadFlag}' style='z-index:104;left:${x}px;top:${y}px;width:${width}px;height:${height}px;background-color:${fontcolor};' src='../scripts/dhctt/xmldesigner/img/qr.png' class='ctrldrag x-qrcode ${selectedCls}'/>"),xmldesigner.qrcode.cls=t,xmldesigner.qrcode.tplName=e,xmldesigner.qrcode.type="qrcode",xmldesigner.qrcode.method={init:function(){s.data=[]},drawNew:function(){a(s.data.length)},drawByInd:a,showAttrsByInd:function(t){i("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold,#t-fontcolor").prop("disabled",!1);var e,a=s.data[t];for(e in a)i("#tr-"+e).show(),i("#t-"+e).val(a[e])},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){s.data[e].x=parseFloat(t.style.left),s.data[e].y=parseFloat(t.style.top),xmldesigner.qrcode.method.showAttrsByInd(e)},drawByAttrTable:function(t){s.data[t].x=parseFloat(i("#t-x").val()),s.data[t].y=parseFloat(i("#t-y").val()),i("#t-name").val()&&(s.data[t].name=i("#t-name").val()),s.data[t].defaultvalue=i("#t-defaultvalue").val(),s.data[t].width=i("#t-width").val(),s.data[t].height=i("#t-height").val(),s.data[t].qrcodeversion=i("#t-qrcodeversion").val(),s.data[t].RePrtHeadFlag=i("#t-RePrtHeadFlag").val(),s.data[t].fontcolor=i("#t-fontcolor").val(),s.method.drawByInd(t)},genXmlJson:function(){for(var t,e,a=[],n=0;n<s.data.length;n++)"undefined"!=typeof(e=s.data[n]).delFlag&&1==e.delFlag||(t={"-name":e.name,"-xcol":pxToPt(e.x),"-yrow":pxToPt(e.y),"-width":pxToPt(e.width),"-height":pxToPt(e.height),"-defaultvalue":e.defaultvalue||"","-printvalue":e.printvalue||"","-fontname":"宋体","-fontsize":"9","-fontbold":"false","-isqrcode":"true","-qrcodeversion":e.qrcodeversion||"","-RePrtHeadFlag":e.RePrtHeadFlag||"N"},"#000000"!=e.fontcolor&&(t["-fontcolor"]=e.fontcolor),a.push(t));return a},delItem:function(t){s.data[t].delFlag=!0,i("#"+xmldesigner.qrcode.type+t).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:s.data[e].x,y:s.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=s.data[t],d=s.type,l=i("#"+d+t).height(),r=i("#"+d+t).width();switch(e){case"x":o.x=a;break;case"y":o.y=a;break;case"b":o.y=a-l;break;case"r":o.x=a-r;break;case"ha":o.y=a-l/2;break;case"va":o.x=a-r/2}s.method.drawByInd(t)},move:function(t,e,a){var n=s.data[e];n&&("left"==t?n.x=n.x-a:"right"==t?n.x=n.x+a:"top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),s.method.drawByInd(e)}}}(jQuery),(xmldesigner="undefined"==typeof xmldesigner?{}:xmldesigner).barcode={},function(i){var s=xmldesigner.barcode,t=(s.data=[],"x-barcode"),e="barcodeTpl";function a(t){var e=xmldesigner.barcode.type,a=(t==s.data.length&&(s.data[t]={name:e+t,width:100,height:50,x:10,y:10,defaultvalue:e+t,fontcolor:"#000000",id:e+t,ind:t,type:e,barcodetype:"128A",angle:0,isshowtext:"",RePrtHeadFlag:"N"}),s.data[t]),e=(a["-name"]&&(a.name=a["-name"],a.defaultvalue=a["-defaultvalue"],a.x=ptToPx(a["-xcol"]),a.y=ptToPx(a["-yrow"]),a.width=ptToPx(a["-width"]),a.height=ptToPx(a["-height"]),a.barcodetype=a["-barcodetype"],a.angle=a["-angle"]||0,a.isshowtext=a["-isshowtext"]||"",a.RePrtHeadFlag=a["-RePrtHeadFlag"]||"N",a.fontcolor=a["-fontcolor"]||"#000000",deleteProps(a,["-name","-defaultvalue","-xcol","-yrow","-fontsize","-fontname","-fontbold","-fontcolor","-width","-height","-barcodetype","-angle","-isshowtext","-RePrtHeadFlag"])),a.id=e+t,a.type=e,a.ind=t,i("#"+a.id));0<e.length?(e.attr("name",a.name).css("left",a.x).css("top",a.y),e.css("width",a.width).css("height",a.height).css("transform","rotate(-"+a.angle+"deg)"),e.css("backgroundColor",a.fontcolor),e.attr("src",src="../scripts/dhctt/xmldesigner/img/barcode"+a.isshowtext+".png"),e.data("RePrtHeadFlag",a.RePrtHeadFlag)):i.tmpl(xmldesigner.barcode.tplName,a).appendTo("#dbLayout")}i.template(e,"<img id='${id}' name='${name}' data-ind='${ind}' data-type='${type}' data-isshowtext='${isshowtext}' data-barcodetype='${barcodetype}' data-RePrtHeadFlag='${RePrtHeadFlag}' style='z-index:104;left:${x}px;top:${y}px;width:${width}px;height:${height}px;transform-origin:0 0;transform:rotate(-${angle}deg);background-color:${fontcolor};' src='../scripts/dhctt/xmldesigner/img/barcode${isshowtext}.png' class='ctrldrag x-barcode ${selectedCls}'/>"),xmldesigner.barcode.cls=t,xmldesigner.barcode.tplName=e,xmldesigner.barcode.type="barcode",xmldesigner.barcode.method={init:function(){s.data=[]},drawNew:function(){a(s.data.length)},drawByInd:a,showAttrsByInd:function(t){i("#t-barcodetype,#t-isshowtext,#t-qrcodeversion,#t-fontsize,#t-fontname,#t-fontbold,#t-fontcolor").prop("disabled",!1);var e,a=s.data[t];for(e in a)i("#tr-"+e).show(),i("#t-"+e).val(a[e])},dragMove:function(t,e){var a=t.clientX,t=t.clientY,a=a-e.currentX,t=t-e.currentY;e.target.style.left=parseFloat(e.left)+a+"px",e.target.style.top=parseFloat(e.top)+t+"px"},dragEnd:function(t,e,a){s.data[e].x=parseFloat(t.style.left),s.data[e].y=parseFloat(t.style.top),xmldesigner.barcode.method.showAttrsByInd(e)},drawByAttrTable:function(t){s.data[t].x=parseFloat(i("#t-x").val()),s.data[t].y=parseFloat(i("#t-y").val()),i("#t-name").val()&&(s.data[t].name=i("#t-name").val()),s.data[t].defaultvalue=i("#t-defaultvalue").val(),s.data[t].width=i("#t-width").val(),s.data[t].height=i("#t-height").val(),s.data[t].barcodetype=i("#t-barcodetype").val(),s.data[t].angle=i("#t-angle").val(),s.data[t].isshowtext=i("#t-isshowtext").val(),s.data[t].RePrtHeadFlag=i("#t-RePrtHeadFlag").val(),s.data[t].fontcolor=i("#t-fontcolor").val(),s.method.drawByInd(t)},genXmlJson:function(){for(var t,e,a=[],n=0;n<s.data.length;n++)"undefined"!=typeof(e=s.data[n]).delFlag&&1==e.delFlag||(t={"-name":e.name,"-xcol":pxToPt(e.x),"-yrow":pxToPt(e.y),"-width":pxToPt(e.width),"-height":pxToPt(e.height),"-defaultvalue":e.defaultvalue||"","-printvalue":e.printvalue||"","-fontname":"","-fontsize":"9","-fontbold":"false","-barcodetype":e.barcodetype,"-RePrtHeadFlag":e.RePrtHeadFlag||"N"},0<e.angle&&(t["-angle"]=e.angle),"N"==e.isshowtext&&(t["-isshowtext"]=e.isshowtext),"#000000"!=e.fontcolor&&(t["-fontcolor"]=e.fontcolor),a.push(t));return a},delItem:function(t){s.data[t].delFlag=!0,i("#"+xmldesigner.barcode.type+t).remove()},getItemOffset:function(t){var e=t.attr("data-ind");return{x:s.data[e].x,y:s.data[e].y,w:t.width(),h:t.height()}},alignItem:function(t,e,a,n){var o=s.data[t],d=s.type,l=i("#"+d+t).height(),r=i("#"+d+t).width();switch(e){case"x":o.x=a;break;case"y":o.y=a;break;case"b":o.y=a-l;break;case"r":o.x=a-r;break;case"ha":o.y=a-l/2;break;case"va":o.x=a-r/2}s.method.drawByInd(t)},move:function(t,e,a){var n=s.data[e];n&&("left"==t?n.x=n.x-a:"right"==t?n.x=n.x+a:"top"==t?n.y=n.y-a:"bottom"==t&&(n.y=n.y+a)),s.method.drawByInd(e)}}}(jQuery);