<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="../js/LODOPFuncs.js"></script>
    <style>
        button {
            width: 120px;
            height: 30px;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <p>
        <button id="btnPrint">打印测试</button>
    </p>
    <p>
        <button id="selectPrinter">选择打印机</button>
    </p>
    <p>
        <button id="printSetup">打印维护</button>
    </p>
    <p>
        <button id="printDesign">打印设计</button>
    </p>
    <p>
        <button id="designSpecimenLabel">标签设计</button>
    </p>
    <p>
        <button id="setupSpecimenLabel">标签维护</button>
    </p>
    <p>
        <button id="printSpecimenLabel">标签打印</button>
    </p>
    <p>
        <button id="printSpecimenLabel2">标签打印(自定义纸张)</button>
    </p>
    <p>
        <button id="previewMore">多页预览</button>
    </p>
    <script>
        document.getElementById("btnPrint").onclick = PrintDemo;
        document.getElementById("selectPrinter").onclick = selectPrinter;
        document.getElementById("printSetup").onclick = printSetup;
        document.getElementById("printDesign").onclick = printDesign;
        document.getElementById("designSpecimenLabel").onclick = designSpecimenLabel;
        document.getElementById("setupSpecimenLabel").onclick = setupSpecimenLabel;
        document.getElementById("printSpecimenLabel").onclick = printSpecimenLabel;
        document.getElementById("printSpecimenLabel2").onclick = printSpecimenLabel2;
        document.getElementById("previewMore").onclick = createTable;
        var LODOP;

        function createPage() {
            LODOP = getLodop();
            LODOP.PRINT_INIT("打印麻醉记录单");
            LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
            LODOP.ADD_PRINT_RECT(10, 55, 360, 220, 0, 1)
            LODOP.SET_PRINT_STYLE("FontSize", 11);
            LODOP.ADD_PRINT_TEXT(20, 180, 100, 25, "郭德纲");
            LODOP.SET_PRINT_STYLEA(2, "FontName", "隶书");
            LODOP.SET_PRINT_STYLEA(2, "FontSize", 15);
            LODOP.ADD_PRINT_TEXT(53, 187, 75, 20, "科学家");
            LODOP.ADD_PRINT_TEXT(100, 131, 272, 20, "地址：中国北京社会科学院附近东大街西胡同");
            LODOP.ADD_PRINT_TEXT(138, 132, 166, 20, "电话：010-88811888");
        }

        function PrintDemo() {
            createPage();
            LODOP.PREVIEW();
        }

        function selectPrinter() {
            createPage();
            LODOP.PRINTA();
        }

        function printSetup() {
            createPage();
            LODOP.PRINT_SETUP();
        }

        function printDesign() {
            // createPage();
            LODOP = getLodop();
            LODOP.PRINT_INIT("打印麻醉记录单");
            LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
            LODOP.PRINT_DESIGN();
        }

        function createSpecimenLabel() {
            LODOP = getLodop();
            LODOP.PRINT_INIT("打印麻醉记录单");
            LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
            LODOP.ADD_PRINT_RECT(20, 20, 580, 360, 0, 1);
            LODOP.ADD_PRINT_TEXT(47, 235, 120, 30, "标本袋");
            LODOP.SET_PRINT_STYLEA(0, "FontName", "黑体");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 16);
            LODOP.SET_PRINT_STYLEA(0, "Alignment", 2);
            LODOP.ADD_PRINT_TEXT(110, 81, 90, 24, "患者姓名：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(110, 178, 90, 24, "张三");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(110, 314, 90, 24, "性    别：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(110, 414, 90, 24, "男");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(146, 81, 90, 24, "住 院 号：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(146, 178, 90, 24, "000018");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(146, 314, 90, 24, "年    龄：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(146, 414, 90, 24, "30岁");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(181, 81, 90, 24, "送检标本：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(181, 178, 90, 24, "阑尾");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(181, 314, 90, 24, "标 本 号：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(181, 414, 90, 24, "SP0000181");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(211, 81, 90, 24, "病    区：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(211, 178, 90, 24, "外科病区");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(211, 314, 90, 24, "床    号：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(211, 414, 90, 24, "20床");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(254, 81, 120, 24, "组织离体时间：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(254, 212, 40, 24, "17");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(254, 259, 40, 24, "时");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(254, 306, 40, 24, "45");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(254, 358, 40, 24, "分");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(286, 81, 120, 24, "组织固定时间：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(286, 212, 40, 24, "18");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(286, 259, 40, 24, "时");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(286, 306, 40, 24, "10");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(286, 358, 40, 24, "分");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(321, 81, 90, 24, "日    期：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_TEXT(321, 182, 160, 24, "2018年6月20日");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 12);
            LODOP.ADD_PRINT_BARCODE(255, 411, 160, 60, "Code39", "SP0000181");

            LODOP.ADD_PRINT_TEXT(321, 182, 160, "100%", "这是测试数据1这是测试数据2这是测试数据3这是测试数据4这是测试数据5");
        }

        function designSpecimenLabel() {
            createSpecimenLabel();
            LODOP.PRINT_DESIGN();
        }

        function setupSpecimenLabel() {
            createSpecimenLabel();
            LODOP.PRINT_SETUP();
        }

        function printSpecimenLabel() {
            createSpecimenLabel();
            LODOP.PREVIEW();
        }

        function printSpecimenLabel2() {
            createSpecimenLabel();
            LODOP.SET_PRINT_PAGESIZE(1, 1650, 1050, "");
            LODOP.PREVIEW();
        }

        function previewMore() {
            createTable();
            // LODOP.PREVIEW();
        }

        function createTable() {

            var htmlArr = [];
            LODOP = getLodop();
            LODOP.PRINT_INIT("打印麻醉记录单");
            LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
            for (var j = 0; j < 25; j++) {
                htmlArr.length = 0;
                htmlArr.push("<table border=1 cellSpacing=0 cellPadding=1><thead>");
                htmlArr.push(
                    "<tr><th>序号</th><th>列2</th><th>列3</th><th>列4</th><th>列5</th><th>列6</th><th>列7</th><th>列8</th><th>列9</th><th>列10</th></tr>"
                );
                htmlArr.push("</thead><tbody>")
                for (var i = 0; i < 400; i++) {
                    htmlArr.push("<tr><td>" + (400 * j + i + 1) +
                        "</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td></tr>"
                    );
                }
                htmlArr.push("</tbody></table>");
                LODOP.ADD_PRINT_TABLE(10, 10, "100%", "100%", htmlArr.join(""));
                LODOP.PRINT();
            }


        }

        function createTable2() {

            var htmlArr = [];
            LODOP = getLodop();
            LODOP.PRINT_INIT("打印麻醉记录单");
            LODOP.SET_PRINT_PAGESIZE(1, 0, 0, "A4");
            htmlArr.length = 0;
            htmlArr.push("<table border=1 cellSpacing=0 cellPadding=1><thead>");
            htmlArr.push(
                "<tr><th>序号</th><th>列2</th><th>列3</th><th>列4</th><th>列5</th><th>列6</th><th>列7</th><th>列8</th><th>列9</th><th>列10</th></tr>"
            );
            htmlArr.push("</thead><tbody>")
            for (var i = 0; i < 10000; i++) {
                htmlArr.push("<tr><td>" + (i + 1) +
                    "</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td><td>测试数据</td></tr>"
                );
            }
            htmlArr.push("</tbody></table>");
            LODOP.ADD_PRINT_TABLE(10, 10, "100%", "100%", htmlArr.join(""));
            LODOP.PRINT();
        }
    </script>
</body>

</html>