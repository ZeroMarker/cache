<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
 if ##class(websys.Conversions).IsValidClassName("websys.Filter") d ##class(websys.Filter).InjectionFilter()
 i ##Class(websys.SessionEvents).SessionExpired() q 1
 quit 1
</csp:method>
<!DOCTYPE html>
<html>
<head>
	<TITLE><EXTHEALTH:TRANSLATE id=title>##(%session.Get("TITLE"))##</EXTHEALTH:TRANSLATE></TITLE>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="edge" />
	<EXTHEALTH:HEAD></EXTHEALTH:HEAD>
	<HISUI/>
	<server>
	Set EpisodeID="",PatientID="",mradm=""
	Set PatientNo = $g(%request.Data("RegNo",1))
	Set EpisodeID = $g(%request.Data("EpisodeID",1))
	set mradm = $g(%request.Data("mradm",1))
	if (PatientNo'=""){
		Set PatientID=$O(^PAPERi("PAPMI_PatNo",PatientNo,""))
	}
	if (EpisodeID'="") {
		Set PatientID = $p(^PAADM(EpisodeID),"^")
		Set mradm=$P(^PAADM(EpisodeID),"^",61)
	}
	If EpisodeID="",PatientID'=""{
		Set EpisodeID=$O(^PAPERdr(PatientID,"ADM","I",""),-1)
		If EpisodeID="" Set EpisodeID=$O(^PAPERdr(PatientID,"ADM","O",""),-1)
		If EpisodeID="" Set EpisodeID=$O(^PAPERdr(PatientID,"ADM","E",""),-1)
	}
	
	</server>
	<style>
/*#0063A7*/
body {
  overflow: hidden;
  font-family: "Microsoft YaHei";
  font-size: 16px;
  line-height: 1.7;
  color: #333;
  background-color: #017BCE;
}
.centerPanel {
  overflow: hidden;
  background-color: #ffffff;
  position: absolute;
  width:100%;
  height:50px;
}
</style>
</head>
<body>
	<FORM name="fEPRMENU">
		<INPUT TYPE="hidden" name="PatientID" id="PatientID" value="#(PatientID)#">
		<INPUT TYPE="hidden" name="EpisodeID" id="EpisodeID" value="#(EpisodeID)#">
		<INPUT TYPE="hidden" name="mradm" id="mradm" value="#(mradm)#">
		<INPUT TYPE="hidden" name="Decease" value="">
		<INPUT TYPE="hidden" name="MultipleIDs" value="">
		<!-- WAITINGLIST -->
		<INPUT TYPE="hidden" name="WaitingListID" value="">
		<INPUT TYPE="hidden" name="WLWaitListStatusDR" value="">
		<!-- ORDERITEM -->
		<INPUT TYPE="hidden" name="OEOrdItemID" value="">
		<INPUT TYPE="hidden" name="OEORIItemStatus" value="">
		<INPUT TYPE="hidden" name="ARCIMDesc" value="">
		<INPUT TYPE="hidden" name="ItemApptStatus" value="">
		<!-- CODING -->
		<INPUT TYPE="hidden" name="PAAdmCodingID" value="">
		<!-- BILLING -->
		<INPUT TYPE="hidden" name="BillRowIds" value="">
		<INPUT TYPE="hidden" name="BillTypes" value="">
		<!-- BOOKING -->
		<INPUT TYPE="hidden" name="FollowUpAppt" value="">
		<INPUT TYPE="hidden" name="apptID" value="">
		<INPUT TYPE="hidden" name="OperRoomID" value="">
		<INPUT TYPE="hidden" name="AnaesthesiaID" value=""> <!--OR_AnaesthesiaÓÃÓÚÔÚÒ½Öö±í¼ÓÉÏÂé×í±íÖ¸Õë//-->
		<!-- ÏÖÔÚÐèÒªÔÙ¼ÓÒ»¸öÊÖÊõ±íOR_Anaest_Operation£¨Âé×í±íµÄ×Ó±í£©µÄID£¬Ò²ÔÚÒ½Öö±íÖÐ´æ,ÐèÒªÍ¨¹ý¶¥²¿²Ëµ¥´«ÊÖÊõ±íID //-->
		<INPUT TYPE="hidden" name="AnaestOperationID" value=""> 
		<!-- MEDRECORD -->
		<INPUT TYPE="hidden" name="ReqIDs" value="">
		<INPUT TYPE="hidden" name="ReqVolIDs" value="">
		<!-- EPISODE -->
		<INPUT TYPE="hidden" name="MultiEpisodeID" value="">
		<INPUT TYPE="hidden" name="WardID" value="">
		<!-- MATERNITY -->
		<INPUT TYPE="hidden" name="canGiveBirth" value="">
		<!-- NEXT OF KIN - cjb 22/02/2006 56793 -->
		<INPUT TYPE="hidden" name="NokID" value="">
		<!-- Attendance - 61395 Tedt 01/07 -->
		<INPUT TYPE="hidden" name="attendID" value="">
		<INPUT TYPE="hidden" name="SpecificID" value="">
		<INPUT TYPE="hidden" name="SinglePatientFlag" value="">
		<!-- Ò©ÀíÊµÑéÏîÄ¿Ö¸Õë -->
		<INPUT TYPE="hidden" name="PPRowId" value="">
		<!--»á¼ÆºËËã³ÉÆ·-ÕÊÌ×-->
		<INPUT TYPE="hidden" name="AcctBookID" id="AcctBookID" value="">
		<INPUT TYPE="hidden" name="AcctBookName" id="AcctBookName" value="">
		<!-- ÒµÎñÉÏÕýÔÚ×öÄ³ÊÂ,²Ëµ¥²»ÄÜÇÐ»»   DoingSthNameÎªÌáÊ¾ÐÅÏ¢,Îª¿Õ±íÊ¾¿ÉÒÔÇÐ»»-->
		<input Type="hidden" id="DoingSth" name="DoingSth" value="">
		<!-- Ò½¼¼ÉêÇëµ¥ºÅ PACSApplyNo -->
		<INPUT TYPE="hidden" name="PACSApplyNo" id="PACSApplyNo" value="">
		<server>
			Set Url = $g(%request.Data("TDIRECTPAGE",1))
			if (Url'=""){
				if Url'["?" Set Url = Url_"?a=a"
				Set key = "" For {
					Set key = $O(%request.Data(key))
					Quit:key=""
					Continue:key="TDIRECTPAGE"
					Continue:key="CacheNoRedirect"
					Continue:key="CachePassword"
					Continue:key="CacheUserName"
					Continue:key="LayoutManager"
					Continue:key="PASSWORD"
					Continue:key="CSPRQN" //·Q"[1m_$c([m3,0[1m)_[m"
					Continue:"^DEPARTMENT^Hospital^SSUSERGROUPDESC^"[("^"_key_"^")
					Continue:"^TPSID^ViewCode^"[("^"_key_"^")
					Set Url = Url_"&"_key_"="_$G(%request.Data(key,1))
				}
			}else{
				Set Url = "websys.home.csp"
			}
		</server>
	</FORM>
	<div id="centerPanel" class="centerPanel" >
		<iframe name="TRAK_main" id="TRAK_main" src="#(Url)#" width="100%" height="100%" scrolling="auto" marginwidth=0 marginheight=0 frameborder="no" framespacing=0>
		</iframe>
	</div>
	<div style="height:0px"  id="southPanel">
		<iframe name="TRAK_hidden" src="" width="100%" height="0" scrolling="auto" marginwidth=0 marginheight=0 frameborder="no" framespacing=0>
		</iframe>
	</div>
	<!--<script type="text/javascript" src="../scripts_lib/jQuery/jquery-1.8.0.min.js"></script>-->
	<script type="text/javascript" >
		$(init);
		function resizeCenter(){
			var docHeight = $(window).height();
			$("#centerPanel").height(docHeight); //.css("top",menuHeight)
		}
		function init(){
			resizeCenter();
			$(window).resize(function(){
				resizeCenter();
			});
		}
	</script>
</body>
</html>
