
<!-- Copyright (c) 2010 DHC Software Co.,Ltd. ALL RIGHTS RESERVED. -->
<!-- W650 
2011-11-29
web.DHCeprWorklistItemDefinitionList.cls
--eprWorklistItemDefinitionList
logonexpired.csp
dhc.logon.csp
background-repeat: no-repeat;
-->
<html XMLNS=TRAK>
<head>
<STYLE>
<!--
BODY {
	background-image: URL(../images/logon_bg7.0.png);
	background-position: center;
	background-attachment: fixed;
	background-repeat: no-repeat;
	SCROLLBAR-FACE-COLOR: #f5f5f5;
	FONT-SIZE: 14px;
	MARGIN: 0px;
	SCROLLBAR-HIGHLIGHT-COLOR: #fff;
	SCROLLBAR-SHADOW-COLOR: #aaa;
	COLOR: black;
	SCROLLBAR-3DLIGHT-COLOR: #aaa;
	SCROLLBAR-ARROW-COLOR: #007cff;
	SCROLLBAR-TRACK-COLOR: #e5e5e5;
	font-family: "Microsoft Yahei", "Tahoma", "Helvetica", "Arial", sans-serif;
	SCROLLBAR-DARKSHADOW-COLOR: #e5e5e5;
	BACKGROUND-COLOR: #fafafa ;
	overflow-y: auto;
	overflow-x: auto;
}
#main_box {
	width: 262px;
	margin: 0 auto;
	text-align:left;
}
.logininput {
	border: 1px solid #DDDDDD;
	background:#f3f3f3;
	color: #666666;
	display: block;
	ime-mode:disabled;
	font-size: 14px;
	height: 43px;
	padding: 12px 10px;
	padding-left: 38px;
	position: relative;
	transition: all 0.3s ease 0s;
	width: 260px;
}
.logininputf{
	border: 1px solid #0167ff;
	color: #666666;
	display: block;
	font-size: 14px;
	height: 43px;
	padding: 12px 10px;
	padding-left: 38px;
	position: relative;
	transition: all 0.3s ease 0s;
	width: 260px;
}
.logininput-dep {
	border:1px solid #DDDDDD;
	display: block;
	font-size: 14px;
	width:260px;
	height:43px;
	padding: 12px 10px;
	padding-left:38px;
	position: relative;
	transition: all 0.3s ease 0s;
	text-align: left;
    cursor: pointer;
    background:#f3f3f3;
    background-image: url(../images/logon_input_dep_bg.png);
}
.loginlabel-depb {
	background-position: 0 -35px;
}
.loginlabel-username {
	background-position: 0 -68px;
}
.loginlabel-usernameb{
	background-position: 0 -108px;
}
.loginlabel-password {
	background-position: 0 -147px;
}
.loginlabel-passwordb {
	background-position: 0 -187px;
}

.loginlabel {
	BACKGROUND-IMAGE: url(../images/input_icons.png); 
	Z-INDEX: 20; 
	POSITION: absolute; 
	PADDING:0px 0px 0px 24px; 
	width: 20px;
	DISPLAY: block; 
	BACKGROUND-REPEAT: no-repeat; 
	HEIGHT: 24px; 
	OVERFLOW: hidden; 
	TOP: 8px; 
	LEFT: 6px
}
.messagetip {
	width:197px;
	height:64px;
	background-image: url(../images/logon_tip_bg.png);
	border: 1px none #fff;
	border-radius: 8px;
	-moz-border-radius: 8px;
	font-size: 14px;
	margin-bottom:12px;
	color: #cc0000;
	text-align: center;	
	padding:1;
	z-index:1000,
	line-height:28px;	
}
.loginCon {
	padding: 0px 21px 40px;
	overflow: hidden;
}
.pass-form-item {
	margin: 15px 0px 0px;
	position: relative;
	z-index: 18;
	height: 65px;
}
.loginContent {
	border-radius: 5px;
	float: right;
	background: #ffffff; /*#f2f2f2;*/
	width: 310px;
	/* position: relative; */
	z-index: 5;
	-webkit-box-shadow: #ccc 0px 0px 5px;
	-moz-box-shadow: #ccc 0px 0px 5px;
	box-shadow: #ccc 0px 0px 5px;
	margin: 130px 270px 30px 0;
	display: none;
}
.loginTitle{
	/*background: url(../images/loginTitle.jpg) no-repeat;*/
	height: 63px;
	text-indent: 22px;
	font-size: 18px;
	color: #8a8a8a;
	line-height: 63px;
}
.tosignupr {
	float: right;
	margin: 10px 5px 0 0;
}
.tosignupl {
	float: left;
	margin: 10px 5px 0 0;
}
.tosignmgr{
	margin : 30px 5px 0 0; 
}

#Logon{
  width: 260px;
  display: inline-block;
  padding: 8px 0px 8px 0px;
  margin-bottom: 0;
  font-size: 16px;
  font-weight: bold;
  line-height: 1.428571429;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  cursor: pointer;
  background-image: none;
  border-bottom: 4px solid transparent;
  border-radius: 5px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
       -o-user-select: none;
          user-select: none;
  color: #ffffff;
  background-color: #329aeb;
  border-bottom-color: #1d7ad9;
  text-decoration:blink;
}
-->
</STYLE>
 <script type="text/javascript" src="/csp/broker/cspbroker.js"></script>
 <script type="text/javascript" src="/csp/broker/cspxmlhttp.js"></script>
 <SCRIPT SRC="../scripts/websys.js"></SCRIPT>
 <SCRIPT SRC="../scripts/framework/ext.websys.js"></SCRIPT>
 <script language=cache runat=server>
	s myCode($i(myCode))="<script type='text/javascript'>"
	s myCode($i(myCode))="var session=new Array();"
	s myCode($i(myCode))="session['LOGON.TIMEOUT']='"_$g(%session.Data("LOGON.TIMEOUT"))_"';"
	s myCode($i(myCode))="session['LOGON.SITECODE']='"_$g(%session.Data("LOGON.SITECODE"))_"';"
	s myCode($i(myCode))="session['LOGON.REGION']='"_$g(%session.Data("LOGON.REGION"))_"';"
	s myCode($i(myCode))="session['LOGON.USERID']='"_$g(%session.Data("LOGON.USERID"))_"';"
	s myCode($i(myCode))="session['LOGON.USERCODE']='"_$g(%session.Data("LOGON.USERCODE"))_"';"
	s myCode($i(myCode))="session['LOGON.USERNAME']='"_$g(%session.Data("LOGON.USERNAME"))_"';"
	s myCode($i(myCode))="session['LOGON.GROUPID']='"_$g(%session.Data("LOGON.GROUPID"))_"';"
	s myCode($i(myCode))="session['LOGON.GROUPDESC']='"_$g(%session.Data("LOGON.GROUPDESC"))_"';"
	s myCode($i(myCode))="session['LOGON.LANGID']='"_$g(%session.Data("LOGON.LANGID"))_"';"
	s myCode($i(myCode))="session['LOGON.CTLOCID']='"_$g(%session.Data("LOGON.CTLOCID"))_"';"
	s myCode($i(myCode))="session['XMONTHSSHORT']='"_$g(%session.Data("XMONTHSSHORT"))_"';"
	s myCode($i(myCode))="session['CONTEXT']='"_$g(%request.Data("CONTEXT",1))_"';"			;;;%session.Data("CONTEXT",1)
	s myCode($i(myCode))="session['LOGON.WARDID']='"_$g(%session.Data("LOGON.WARDID"))_"';"
	s myCode($i(myCode))="session['LOGON.HOSPID']='"_$g(%session.Data("LOGON.HOSPID"))_"';"
	
	s myStatusTip = "用户名称:  "_ $g(%session.Data("LOGON.USERNAME"))_"  组:  "_$g(%session.Data("LOGON.GROUPDESC"))
	s myStatusTip = myStatusTip_"  科室: "_$g(%session.Data("LOGON.CTLOCDESC"))
	
	s myCode($i(myCode))="window.status='"_myStatusTip_"';"
	s event=##class(%CSP.Page).Encrypt($lb("websys.Configuration.CSPServerConnect"))
	
	s myCode($i(myCode))="function tkMakeServerCall(tkclass,tkmethod) {"
	s myCode($i(myCode))="	if ((tkclass=='')||(tkmethod=='')) return '';"
	s myCode($i(myCode))="	var args=new Array('"_event_"',tkclass,tkmethod);"
	s myCode($i(myCode))="	for (var i=2; i<tkMakeServerCall.arguments.length; i++) {"
	s myCode($i(myCode))="	args[i+1]=tkMakeServerCall.arguments[i];"
	s myCode($i(myCode))="	}"
	s myCode($i(myCode))="	var retval=cspHttpServerMethod.apply(this,args);"
	s myCode($i(myCode))="	return retval;"
	s myCode($i(myCode))="}"
	s myCode($i(myCode))="<"_"/script>"
	f myIdx=1:1:myCode {
		w myCode(myIdx),!
	}

 	//function tkMakeServerCall(tkclass,tkmethod) {  if ((tkclass=='')||(tkmethod=='')) return '';var args=new Array('#(##class(%CSP.Page).Encrypt($lb("websys.Configuration.CSPServerConnect")))#',tkclass,tkmethod);  for (var i=2; i<tkMakeServerCall.arguments.length; i++) {  args[i+1]=tkMakeServerCall.arguments[i];  }  var retval=cspHttpServerMethod.apply(this,args);  return retval; }
 </script>
<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
 //登录后才同步时间,相差超一分钟
 Set ClientDate = $g(%request.Data("ClientDate",1))
 Set ClientTime = $g(%request.Data("ClientTime",1))
 Set ServerDate = +$h
 Set ServerTime = $p($h,",",2)
 Set ModifyTimeFlag = 0
 If (ClientDate'="")&&(ClientTime'="") && ($g(%session.Data("LOGON.USERCODE"))'=""){
	Set ClientDate = $zdh(ClientDate,3)
	Set ClientTime = $zth(ClientTime)
	If (ClientDate'=ServerDate) || (60<(ClientTime-ServerTime)) ||(-60>(ClientTime-ServerTime)) {
		Set ModifyTimeFlag=1
	}
 }
 ;s preSessionId=##Class(ext.websys.SessionLogon).LogonBefore()
 s preSessionId=0
 if (preSessionId=0) {
	 //判断是否CAS单点登录
	 s caslogin = $g(%request.Data("caslogin",1))
	 if ('caslogin){
	 	s returnval=##Class(websys.SessionLogon).Logon()
	 }else{
		s returnval = ##Class(websys.SessionLogon).CASLogon()
	 }
	 ; ab 18.04.07 63052 - override timeout to 60 secs to free license
	 ;w "<br>"_$g(lic)_"<br>",!
	 s %session.AppTimeout=60*5
	 s sc=%session.Login("_system","SYS",1)
	 s:$System.Status.IsError(sc) ^TempLogon($h)=$system.Status.GetErrorText(sc)
	 s ^Temp("ClientName")=$J_" "_$ZUTIL(67,12,$j)_" "_$zu(67,15,$j)
	 q returnval
 }else{
	 q 1
 }
</csp:method>
<csp:method name=OnPostHTTP arguments="">
	k STATUS,username,password,department,ValidUser,welcometitle,copyright,traktooltip1
	;w !,%session.NewSession_"  新的",!
</csp:method>
<title><EXTHEALTH:TITLE></EXTHEALTH:TITLE></title>
<link rel="stylesheet" href="../skin/default/css/styles.css" type="text/css">
<SCRIPT language='javascript'>
function singleSession(){
	var preSessionId = "#(preSessionId)#";
	if(0!=preSessionId){
		//协和一台电脑只能登录一个用户
		if(confirm("#($g(username))# 已经登录了系统,你确定重新登录?")==true){
			#server(websys.SessionLogon.ForceLogoutPreSession())#
			window.location.href="dhc.logon.csp";
		}else{
			window.close();
		}
	}
}
singleSession();


function ChangePassword(obj) {
	var doc="websys.default.csp?WEBSYS.TCOMPONENT=SSUser.EditPassword&ID="+session['LOGON.USERID']; 
	window.open(doc,'new','scrollbars=no,toolbar=no,width=500,height=400');
}
function ChangeDefultDept(obj)
{
	var doc="websys.default.csp?WEBSYS.TCOMPONENT=SSUser.UpdateDefaultDept&ID="+session['LOGON.USERID']+"&UserName="+document.getElementById("USERNAME").value; 
	window.open(doc,'new','scrollbars=no,toolbar=no,width=600,height=500');
}
function ChangeADPassword(){
	window.open("http://itsupport.pumch.local/2show.aspx",'new','');
}
function resetSize()  {
  var posX=screen.availWidth;
  var posY=screen.availHeight;
  //var winWidth=600;
  //var winHeight=500;	//420;
  //posX=posX-winWidth; if(posX<0) posX=0; else posX=posX/2;
  //posY=posY-winHeight; if (posY<0) posY=0; else posY=posY/2;
  //window.resizeTo(winWidth,winHeight);
  //window.moveTo(posX,posY);
  websys_move(0,0,posX,posY);
  //window.resizeTo(posX,posY);
  //window.moveTo(0,0);
}
function unlockonunload() {
	websys_onunload();
	if (window.event) {
		if ((!islogon) && (window.event.clientY < 0)) {
		   	window.location.href="websys.closesession.csp";
		}
	}
	return true;
}
window.onunload=unlockonunload;
var islogon = 0;
</SCRIPT>
<EXTHEALTH:EXT321></EXTHEALTH:EXT321>
<script type='text/javascript' src='../scripts/framework/dhcc.icare.lu.js'></script>
<!--<script type='text/javascript' src='../scripts/framework/ext.icare.Lookup.js'></script>-->
<script type='text/javascript' src='../scripts/websys.encrypt.js'></script>
</head>
<body text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" oncontextmenu="return false;"  background="../images/logon_bg7.0.jpg">
<!--background="../images/logon_bg7.0.jpg"-->
<CSP:IF condition="$g(lic)=1">
<!--   add by wuqk --begin--                 -->
<SCRIPT language="Cache" RUNAT="SERVER">
 //add by wuqk 2011-10-20
 set LICENSE="iMedical License to "
 set IsDirty=1
 set TWKFL=""
 set TWKFLI=""
 /*
 set:$d(msg.IsDirty) IsDirty=2
 if TERROR="" {
	 set TWKFL=$g(%request.Data("TWKFL",1))
	 set TWKFLI=$g(%request.Data("TWKFLI",1))
 }
 else{
	 set TWKFL=$g(msg.Data("TWKFL",1))
	 set TWKFLI=$g(msg.Data("TWKFLI",1))
 }*/
 //end by wuqk
 
</SCRIPT>

<!--**获取本地IP地址,只适用于IE  2013.12.02-->
<SCRIPT language=JScript event=OnObjectReady(objObject,objAsyncContext) for=foo>
   if(objObject.IPEnabled != null && objObject.IPEnabled != "undefined" && objObject.IPEnabled == true)
   {
    if(objObject.MACAddress != null && objObject.MACAddress != "undefined")
    MACAddr = objObject.MACAddress;
    if(objObject.IPEnabled && objObject.IPAddress(0) != null && objObject.IPAddress(0) != "undefined")
    IPAddr = objObject.IPAddress(0);
    if(objObject.DNSHostName != null && objObject.DNSHostName != "undefined")
    sDNSName = objObject.DNSHostName;
    }
</SCRIPT>
<SCRIPT language=JScript event="OnCompleted(hResult,pErrorObject, pAsyncContext)" for=foo>
 	document.forms[0].IPAddress.value=unescape(IPAddr);
 	document.forms[0].DNSHostName.value=unescape(sDNSName);
 	document.forms[0].MACAddr.value=unescape(MACAddr);
</SCRIPT>
<OBJECT id=locator classid=CLSID:76A64158-CB41-11D1-8B02-00600806D9B6 VIEWASTEXT></OBJECT>
<OBJECT id=foo classid=CLSID:75718C9A-F029-11d1-A1AC-00C04FB6C223></OBJECT>
<SCRIPT language=JScript>
   var service = locator.ConnectServer();
   var MACAddr ;
   var IPAddr ;
   var DomainAddr;
   var sDNSName;
   service.Security_.ImpersonationLevel=3;
   service.InstancesOfAsync(foo, 'Win32_NetworkAdapterConfiguration');
</SCRIPT>


<DIV class="loginContent" id="dSSUserLogon" onkeydown="websys_help('websys.help.csp?XCOMPONENT=1473&XCONTEXT=-100000000000000&XTWKFL=',event);">
	<div class="loginTitle"><div style="float: left;">欢迎登录<font color="#333333"><b>HIS</b></font>系统</div>
	#($s($g(ValidUser,0):"<!--<div id=""UserSettings"" onclick=""userSettingsClick();"" style=""float:right;margin-right:20px;cursor:hand;"">设置</div>-->",1:""))#
	</div>
	<FORM ACTION="websys.csp" method=post name="fSSUserLogon" id="fSSUserLogon">
	<INPUT TYPE="HIDDEN" NAME="TFORM" VALUE="SSUserLogon">
	<INPUT TYPE="HIDDEN" NAME="TPAGID" VALUE='#($i(^websys.Counters("tpagid")))#'>
	<INPUT TYPE="HIDDEN" NAME="TEVENT" VALUE="">
	<INPUT TYPE="HIDDEN" NAME="TOVERRIDE" VALUE="">
	<INPUT TYPE="HIDDEN" NAME="TDIRTY" VALUE='#($g(IsDirty))#'>
	<INPUT TYPE="HIDDEN" NAME="TWKFL" VALUE='#($g(TWKFL))#'>
	<INPUT TYPE="HIDDEN" NAME="TWKFLI" VALUE='#($g(TWKFLI))#'>
	<INPUT TYPE="HIDDEN" NAME="TWKFLL" VALUE='#(%request.Get("TWKFLL"))#'>
	<INPUT TYPE="HIDDEN" NAME="TWKFLJ" VALUE='#(%request.Get("TWKFLJ"))#'>
	<INPUT TYPE="HIDDEN" NAME="TREPORT" VALUE='#(%request.Get("TREPORT"))#'>
	<INPUT TYPE="HIDDEN" NAME="TRELOADID" VALUE='#($g(TRELOADNEW))#'>
	<INPUT TYPE="HIDDEN" NAME="TFRAME" VALUE="">
	<INPUT TYPE="HIDDEN" NAME="TCONTEXT" VALUE='#($g(%request.Data("TCONTEXT",1)))#'>

	<!--<INPUT TYPE="HIDDEN" ID="SelectedDefaultDepBordker" VALUE='#(##class(%CSP.Page).Encrypt($lb("web.SSUserOtherLogonLoc.SelectedDefaultDepBordker")))#' />-->
	<INPUT TYPE="HIDDEN" id="IPAddress" NAME="IPAddress" VALUE=""/>
	<INPUT TYPE="HIDDEN" id="DNSHostName" NAME="DNSHostName" VALUE=""/>
	<INPUT TYPE="HIDDEN" id="MACAddr" NAME="MACAddr" VALUE=""/>
	<INPUT TYPE="HIDDEN" id="ClientDate" NAME="ClientDate" VALUE=""/>
	<INPUT TYPE="HIDDEN" id="ClientTime" NAME="ClientTime" VALUE=""/>
	<input id="RELOGON" name="RELOGON" type="hidden" value='#($g(%request.Data("RELOGON",1)))#'>
	<input id="LocationListFlag" name="LocationListFlag" type="hidden" value='#(##Class(web.SSUserOtherLogonLoc).CheckUserOtherLocation(%request.Get("USERNAME")))#'>
	<input id="SSUSERGROUPDESC" name="SSUSERGROUPDESC" type="hidden" value='#($g(%request.Data("SSUSERGROUPDESC",1)))#'>
	<input id="changeinlogonhosp" name="changeinlogonhosp" type="hidden" value='#($g(%request.Data("changeinlogonhosp",1)))#'>
	<input id="Hospital" name="Hospital" type="hidden" value="#($g(%request.Data("Hospital",1)))#">
	<input id="EmployeeNo" name="EmployeeNo" type="hidden" value='#($g(%request.Data("EmployeeNo",1)))#'>
	<input id="ADErrMessage" name="ADErrMessage" type="hidden" value="#($g(%request.Data("ADErrMessage",1)))#">
	<input name="LocationListFlagXH" id="LocationListFlagXH" type="hidden" value="#(##Class(web.SSUserOtherLogonLoc).CheckUserOtherLocation(%request.Get("EmployeeNo")))#"/>
	<input name="isADEmployee" id="isADEmployee" type="hidden" value="1"/>
	<input name="GetCurrentSeverDateTime" id="GetCurrentSeverDateTime" type="hidden" value="#(##Class(%CSP.Page).Encrypt($lb("web.UDHCCLDischarge.GetCurrentSeverDateTime")))#"/>
	<!--CA单点登录用-->
	<input name="caslogin" id="caslogin" type="hidden" value='#($g(%request.Data("caslogin",1)))#'>
	<input name="ticket" id="ticket" type="hidden" value='#($g(%request.Data("ticket",1)))#'>
	<input name="directpage" id="directpage" type="hidden" value='#($g(%request.Data("directpage",1)))#'>
	<input name="DEPARTMENTAlias" id="DEPARTMENTAlias" type="hidden" value='#($g(%request.Data("DEPARTMENTAlias",1)))#'>
	<div id="messageTipDiv" style="position:absolute;top:0px;left:0px;display:none;z-index:100;" class='messagetip'></div>
	<div class="loginCon">
		<div class="pass-form-item">
	    	<label class="loginlabel loginlabel-username#($s(%request.Get("USERNAME")'="":"b",1:""))#" for="USERNAME" id="cUSERNAME"></label>	
			<input autocomplete="off" class="logininput" name="USERNAME" id="USERNAME" value='#(%request.Get("USERNAME"))#' placeholder="用户名" style="color: rgb(169, 169, 169);">
		</div>
	    <div class="pass-form-item">
	    	<label class="loginlabel loginlabel-password#($s(%request.Get("PASSWORD")'="":"b",1:""))#" for="PASSWORD" id="cPASSWORD"></label>
	        <input type="password" class="logininput" name="PASSWORD" id="PASSWORD" value='#(%request.Get("PASSWORD"))#' placeholder="密码" style="color: rgb(169, 169, 169);">
	    </div>
	    <div class="pass-form-item">
	    	<label class="loginlabel #($s(%request.Get("DEPARTMENT")'="":"loginlabel-depb",1:""))#" for="DEPARTMENT" id="cDEPARTMENT"></label>
	        <input class="logininput" name="DEPARTMENT" id="DEPARTMENT" onchange="DEPARTMENT_changehandler('#(##class(%CSP.Page).Encrypt($lb("web.SSUserOtherLogonLoc.LookUpSelectedUserByUHDBroker")))#');" title="请选择登录科室" value='#(%request.Get("DEPARTMENT"))#'>
	    </div>
    
	    <p>
	    	<a href="#" id="Logon" name="Logon" tabIndex="4" href="javascript:void(0);" >登&nbsp;&nbsp;&nbsp;&nbsp;录
	    		<!--<img SRC="../images/logon_btn.bmp" BORDER="0">-->
	    	</a>
	    </p>
	    <!--logon_btn_a.png-->
	    <div class="tosignupl">
			<A id="CHANGEPASSWORD" style="color:#66cc00;font-size: 12px" name="CHANGEPASSWORD" HREF="#" tabIndex="6" >修改密码</A>
		</div>
	    <div class="tosignupr">
			<A id="ChangDefaultDept" style="color:#66cc00;font-size: 12px" name="ChangDefaultDept" HREF="#" tabIndex=7>修改默认科室</A>
		</div>
		<div class="tosignmgr">
			<font color="red">#(STATUS)#</font>
		</div>
	</div>
	<!--</DIV>-->
	</FORM>
	<SCRIPT SRC="../scripts/dhc.SSUserLogon.js"></SCRIPT>
	<SCRIPT language="Cache" RUNAT="SERVER">
	w "<SCRIPT>",!
	w "var t=new Array();",!
	d ##Class(websys.Component).GetComponentMessages(.t,"SSUserLogon")
	s myArrayIdx=$o(t(""))
	while (myArrayIdx'=""){
		s mydesc=##class(%CSP.Page).EscapeHTML( $g(t(myArrayIdx)))
		i (myArrayIdx'=""){
			//s myCode($i(myCode))="t['"_myArrayIdx_"']='"_mydesc_"';"
			s txt="t['"_myArrayIdx_"']='"_mydesc_"';"
			w txt,!
		}
		s myArrayIdx=$o(t(myArrayIdx))
	}
	w "</"_"SCRIPT>",!
	</SCRIPT>
</DIV>
<TABLE style="position:absolute;top:93%; left:0px; font-size: 12px; color:#000000;color:#808080" width="100%" >
	<TR>
		<TD align="center">
			#(##Class(ext.websys.Configuration).VersionString())#
		</td>
		<!--<TD ><font color=red>#($g(STATUS))#</font></TD>//-->
	</TR>
	<tr>
		<td align="center">版权所有 &copy; 2015 东华软件股份公司。保留所有权利。</TD>
		<!--<td><div id="IPLocalAddr"><font color=red>#(%request.GetCgiEnv("LOCAL_ADDR"))#<font></div></td>-->
	</tr>
</TABLE>


<SCRIPT Language="JavaScript">
if (#(forcePasswordChange)#) ChangePassword();
var frm=document.forms['fSSUserLogon'];
frm.action="dhc.logon.csp";
var objUser=document.getElementById('USERNAME'); //frm.elements['USERNAME'];
var objPswd=document.getElementById('PASSWORD'); //frm.elements['PASSWORD'];
var objDept=document.getElementById('DEPARTMENT'); //frm.elements['DEPARTMENT'];
var objRound=document.getElementById('ROUND'); //frm.elements['ROUND'];
var objListFlag=document.getElementById('LocationListFlag'); //frm.elements['LocationListFlag'];
var objListFlagXH=document.getElementById('LocationListFlagXH');
var btnLogon=document.getElementById('Logon');
var objDefaultDept=document.getElementById("ChangDefaultDept");
var objCHANGEADPASSWORD=document.getElementById("CHANGEADPASSWORD");
var EmployeeNoObj=document.getElementById('EmployeeNo');
if (EmployeeNoObj) {
	//document.write("<object id='ADAuth' classid='CLSID:F5AACBB5-035C-4515-BB23-59A40D2393B6' codebase = '../addins/client/ADAuthPro.CAB#version=1,0,0,6'>")
	//document.write("</object>")
}
if ('#(readonly)#'=='READONLY') {
	if (objUser) {
		objUser.readOnly=true;
		objUser.className='disabledField';
	}
	if (objPswd) {
		objPswd.readOnly=true;
		objPswd.className='disabledField';
	}
}
var listflag=0;
if (EmployeeNoObj){if(objListFlagXH) listflag=objListFlagXH.value;}else{if(objListFlag) listflag=objListFlag.value;}
if(objListFlag && objListFlag.value!=1){
	if (objDept) {
		objDept.readOnly=true;
		objDept.className='logininput';
	}
} else {
	if(objDept){
		objDept.className='logininput-dep';
	}
}
if (#(locIsDisabled)#) {
	if (objDept) {
		objDept.readOnly=true;
		objDept.className='logininput';
	}
} else {
	if (objDept) {
		objDept.readOnly=false;
		objDept.disabled=false;
		objDept.className='logininput-dep';
	}
}
if (!#(ValidUser)#) {
	if (objDept) {
		objDept.disabled=true;
		objDept.className='logininput';
	}
	var obj=document.getElementById('CHANGEPASSWORD');
	if (obj) {
		//obj.disabled=true;
		//obj.className='disabledField';
		obj.style.visibility='hidden';
		obj.onclick='';
	}
	if (objPswd) objPswd.value='';
	//修改登陆科室
	if(objDefaultDept)
	{
	   //objDefaultDept.disabled=true;
	   //objDefaultDept.className="disabled";
	   objDefaultDept.style.visibility='hidden';
	   objDefaultDept.onclick='';
	}
		//修改登陆科室
	if(objCHANGEADPASSWORD)
	{
	   //objCHANGEADPASSWORD.disabled=true;	  
	   //objCHANGEADPASSWORD.className="disabled";
	   objCHANGEADPASSWORD.style.visibility='hidden';
	   objCHANGEADPASSWORD.onclick='';
	}
}

if (!#(logonround)#) {
	if (objRound) {
		objRound.readOnly=true;
		objRound.className='disabledField';
		var roundobj=document.getElementById('ld1473iROUND');
		if (roundobj) { roundobj.style.visibility='hidden' }
	}
}

///如果CAS单点登录,则隐藏用户和密码数据框.只留下科室选择
if ("1"=='#(caslogin)#'){
	var userLabelObj = document.getElementById('cUSERNAME');
	var pswdLabelObj = document.getElementById('cPASSWORD');
	var changePswdObj = document.getElementById('CHANGEPASSWORD')
	var changeDefaultDeptObj = document.getElementById('ChangDefaultDept')
	objUser.style.visibility='hidden';
	objPswd.style.visibility='hidden';
	userLabelObj.style.visibility="hidden";
	pswdLabelObj.style.visibility="hidden";
	changePswdObj.style.visibility="hidden";
	changeDefaultDeptObj.style.visibility="hidden";
}
function showMsg(inputName, msg){
	var el = Ext.get("messageTipDiv");
	if(el){
		var userEl = Ext.fly(inputName);
		var xy = userEl.getAnchorXY();
		var w = userEl.getWidth();
		el.dom.innerText = msg;
		el.setLeftTop((xy[0]+w-30),(xy[1]-40));
		el.setDisplayed(true);
		//el.animate({opacity:{to:0,from:1}},5,null,'easeOut','run');
		//setTimeout(function(){document.getElementById("messageTipDiv").style.display='none';},3000);
	}
}
function userSettingsClick(){
	window.open("dhc.usersettings.csp",'new','toolbar=no,scrollbars=yes,width=1000,height=600,resize=yes');
}
if("#(STATUS)#"!=""){
	//showMsg("USERNAME","#(STATUS)#");
}

</SCRIPT>
</CSP:IF> <!-- license check -->
<script language=javascript>
resetSize();
	(function(){
		if (#(ModifyTimeFlag)#) {
			var serverDate = "#($zd(+$h,3))#";
			var serverTime = "#($zt($p($h,",",2)))#";
			var dateArr = serverDate.split("-");
			var timeArr = serverTime.split(":");
			var SetSysTime = "";
			try{
				SetSysTime = new ActiveXObject("PrjSetTime.CLSSETTIME")
				if(SetSysTime){
					SetSysTime.VYear = dateArr[0];
					SetSysTime.VMonth =dateArr[1]; 
					SetSysTime.VDay = dateArr[2];
					SetSysTime.VHour = timeArr[0]-8;
					SetSysTime.VMinute = timeArr[1];
					//SetSysTime.VSecond =timarr[5];
					SetSysTime.SetTime();
				}
			}catch(e){}
		}
	})();
</script>
</body>
</html>

