<!-- CSP TRAK:HEAD Rules -->
<!-- Copyright (c) 2010 DHC Software Co.,Ltd. ALL RIGHTS RESERVED. -->

<!-- HEAD TAG --------------------------------------------- -->

<csr:rule name="DHCMA.HEAD" match="DHCMA:HEAD">
<csr:description>
The <b>DHCMA:HEAD</b> tag defines defines standard header info and initialisation for each page. For example javascript utilties, style sheet, theme and initialisation code
</csr:description>

<csr:action>
	<SCRIPT LANGUAGE=CACHE RUNAT=SERVER>
		set SystemCode=$g(%request.Data("SystemCode",1))   //HISÏµÍ³´úÂë
		set ModuleCode=$g(%request.Data("ModuleCode",1))   //Ä£¿é´úÂë
		Set flg=##class(DHCMA.Util.BTS.SYSTEMSrv).GetLoginParams(SystemCode,ModuleCode)
	</SCRIPT>
	 <script language="javascript" type="text/javascript">
	 	$(function () {
			BrowserVer = BrowserVer();
			if (BrowserVer == "isIE11" || BrowserVer == "isLessIE11"){
				var script=document.createElement('script');
				script.type = 'text/javascript';
				script.src = '../scripts/DHCMA/Util/bluebird.min.js';
				document.getElementsByTagName('head')[0].appendChild(script);
			}
		});
	 	function BrowserVer() {
	    	// È¡µÃä¯ÀÀÆ÷µÄuserAgent×Ö·û´®
	    	var userAgent = navigator.userAgent;
	    	// ÅÐ¶ÏÊÇ·ñÎªÐ¡ÓÚIE11µÄä¯ÀÀÆ÷
		   	var isOpera = userAgent.indexOf("Opera") > -1; //ÅÐ¶ÏÊÇ·ñOperaä¯ÀÀÆ÷
		    var isEdge = userAgent.indexOf("Edge") > -1; //ÅÐ¶ÏÊÇ·ñIEµÄEdgeä¯ÀÀÆ÷
		    var isFF = userAgent.indexOf("Firefox") > -1; //ÅÐ¶ÏÊÇ·ñFirefoxä¯ÀÀÆ÷
		    var isSafari = userAgent.indexOf("Safari") > -1
		            && userAgent.indexOf("Chrome") == -1; //ÅÐ¶ÏÊÇ·ñSafariä¯ÀÀÆ÷
		    var isChrome = userAgent.indexOf("Chrome") > -1
		            && userAgent.indexOf("Safari") > -1; //ÅÐ¶ÏChromeä¯ÀÀÆ÷
		   	var isLessIE11 = userAgent.indexOf('compatible') > -1 && userAgent.indexOf('MSIE') > -1; // ÅÐ¶ÏÊÇ·ñÎªÐ¡ÓÚIE11µÄä¯ÀÀÆ÷
			var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1; //ÅÐ¶ÏÊÇ·ñIEä¯ÀÀÆ÷
			
			if (isIE11) {
		  	 	return "isIE11";		        
		    }
		    if (isLessIE11) {
		        return "isLessIE11";
		    }
		    if (isChrome) {
		        return "isChrome";
		    }
		    if (isOpera) {
		        return "isOpera";
		    }
		    if (isEdge) {
		        return "isEdge";
		    }
		    if (isFF) {
		        return "isFF";
		    }
		    if (isSafari) {
		        return "isSafari";
		    }
	    }
	</script>
</csr:action>
</csr:rule>

