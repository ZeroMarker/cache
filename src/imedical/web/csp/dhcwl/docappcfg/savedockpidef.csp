<csp:content charset="gb2312">
<csp:content charset="UTF-8">
<script language="cache" runat="server"> 
	s action = $Get(%request.Data("action",1))
	s docKpiId = $Get(%request.Data("ID",1))
	s docKPIDefCode = $Get(%request.Data("MDocKPIDefCode",1))
	s docKPIDefDesc = $Get(%request.Data("MDocKPIDefDesc",1))
	s docKPIDefType = $Get(%request.Data("MDocKPIDefType",1))
	s docKPIUpdateDate = $Get(%request.Data("MDocKPIUpdateDate",1))
	s docKPIDefClass = $Get(%request.Data("MDocKPIDefClass",1)) 
	s docKPIDefCategory = $Get(%request.Data("MDocKPIDefCategory",1)) 
	s pv("ID")=docKpiId,pv("MDocKPIDefCode")=docKPIDefCode,pv("MDocKPIDefDesc")=docKPIDefDesc ,pv("MDocKPIDefType")=docKPIDefType
	s pv("MDocKPIUpdateDate")=docKPIUpdateDate,pv("MDocKPIDefClass")=docKPIDefClass,pv("MDocKPIDefCategory")=docKPIDefCategory
	i (action = "add") d
	.i ($g(docKpiId)="")||(+docKpiId=0) d
	..s result = ##class(DHCWL.DocQueryData.SaveData).DocKpiInsert(.pv)
	..;i result = "ok" d
	..w "{success:true,tip:'"_result_"'}"
	.e  d
	..s result = ##class(DHCWL.DocQueryData.SaveData).DocKpiUpdate(docKpiId,.pv)
	..;i result = "ok" d
	..w "{success:true,tip:'"_result_"'}"
	i action = "delete" d
	.s result = ##class(DHCWL.DocQueryData.SaveData).DocKpiDelete(docKpiId)
	.w "{success:true,tip:'"_result_"'}"
</script>