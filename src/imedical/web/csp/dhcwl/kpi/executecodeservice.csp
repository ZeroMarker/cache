<csp:content charset="gb2312">
<csp:content charset="UTF-8">
	<script language="cache" runat="server">
	set type = "TAS"
	set requestType = $g(%request.Data("type",1))
	if (""'=requestType) set type=requestType
	set subType = $g(%request.Data("subType",1))
	set start = $g(%request.Data("start",1))
	set pageSize = $g(%request.Data("limit",1))
	set action=$g(%request.Data("action",1))
	;s start=1,pageSize=9999999
	s end=start+pageSize
	s:start>1 start=start+1

	i "SECKPIEXCList"=action {
		s jsonPros="ExeCodeWrite,ExeCodeCall,ExeCodeVersion,ExcCodeCUDate,ExeCodeCreator,ExcCodeApplicable,ExcCodeDescription"
		s sqlFields=##class(DHCWL.util.GetSetService).MapFildFromClassProByStr("DHCWL.MKPI.ExecuteCode",jsonPros)
		s tableName=##class(DHCWL.util.GetSetService).GetTableName("DHCWL.MKPI.ExecuteCode")
		;s sql="select "_sqlFields_" from "_tableName_" where ExeCode_Type='TAS'"
		s sql="select "_sqlFields_" from "_tableName_" where ExeCode_Type='"_type_"' and ExcCode_SubType='"_subType_"'"
		;w sql
		s json=##class(DHCWL.util.GetSetService).GetJsonBySQL(sql,start,end,jsonPros)
		w json.GetHead()
		d{
			s obj=json.Next()
			w obj
		}while(obj'="")
		i json.GetCount()=0 w "]}"
	}
	
</script>

