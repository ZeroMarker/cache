<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
	i ##Class(websys.SessionEvents).SessionExpired() q 1
	q 1
</csp:method>
<csp:content charset="UTF-8">
<script language="cache" runat="server">

	s Action=$Get(%request.Data("actiontype",1))
	s Start=$Get(%request.Data("start",1))
	s Limit=$Get(%request.Data("limit",1))
	s Sort=$Get(%request.Data("sort",1))
	s Dir=$Get(%request.Data("dir",1))

	s listData=$Get(%request.Data("ListDetail",1))
	s ListDetail=$Get(%request.Data("ListData",1))
	s RowId=$Get(%request.Data("rowid",1))
	s Parref=$Get(%request.Data("parref",1))
	s Param=$Get(%request.Data("QueryParam",1))
	s LVParam=$Get(%request.Data("Param",1))
	s LvListDetail=$Get(%request.Data("LvListDetail",1))
	s LvRowId=$Get(%request.Data("lvrowid",1))
	i Action = "query" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).query(Start,Limit,Param)
	.i result ="" d
	..w "{results:0,rows:[]}"
	.e  d
	..w result

	//保存低值品限额
	i Action = "save" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).Save(listData)
	.i result >0 d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"

	

	//查询低值品限额明细
	i Action = "selectChild" d
	.s result = ##class(web.DHCSTM.MarkRuleAdd).SelectAll(Parref)
	.i result ="" d
	..w "{results:0,rows:[]}"
	.e  d
	..w result
    //删除一条低值限额
    i Action = "Delete" d
    .s ^TMPHOUS("lgq")=LvRowId
	.s result = ##class(web.DHCSTM.DHCLVConfig).Delete(LvRowId)
	.i result = 0 d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	
	i Action = "find" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).find(Start,Limit,LVParam)
	.i result ="" d
	..w "{results:0,rows:[]}"
	.e  d
	..w result
		//保存低值品限额
	i Action = "savelocqty" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).SaveLocQty(ListDetail)
	.i result ="" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	//保存低值品限额
	i Action = "updateLvConfig" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).updateLvConfig(LvListDetail)
	.i result ="" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	
	
	
	i Action = "saveEjlocqty" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).SaveEjLocQty(ListDetail)
	.i result ="" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	
	i Action = "updateEjLvConfig" d
	.s result = ##class(web.DHCSTM.DHCLVConfig).updateEjLvConfig(LvListDetail)
	.i result ="" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	 i Action = "DeleteEj" d
    .s ^TMPHOUS("lgq")=LvRowId
	.s result = ##class(web.DHCSTM.DHCLVConfig).DeleteEj(LvRowId)
	.i result = 0 d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	i Action = "queryEj" d
	.s ^TMPHOUSC("dfsadf")=Param
	.s result = ##class(web.DHCSTM.DHCLVConfig).queryEj(Start,Limit,Param)
	.i result ="" d
	..w "{results:0,rows:[]}"
	.e  d
	..w result
</script>