<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
	i ##Class(websys.SessionEvents).SessionExpired() q 1
	q 1
</csp:method>
<csp:content charset="UTF-8">
<script language="cache" runat="server">
	s Action=$Get(%request.Data("actiontype",1))
	s ListDetail=$Get(%request.Data("ListDetail",1))
	s RowId=$Get(%request.Data("rowid",1))
    s Loc=$Get(%request.Data("Loc",1))
    s Start=$Get(%request.Data("start",1))
    s Limit=$Get(%request.Data("limit",1))
	//查询分组信息
	i Action = "Query" d
	.s result = ##class(web.DHCSTM.LocClaGrp).Query(Loc)
	.i result = "" d
	..w "{results:0,rows:[]}"
	.e  d
	..w result

	//保存分组信息
	i Action = "Save" d
	.s result = ##class(web.DHCSTM.LocClaGrp).Save(ListDetail)
	.i result = "" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"

	//删除分组信息
	i Action = "Delete" d
	.s result = ##class(web.DHCSTM.LocClaGrp).Delete(RowId)
	.i result = 0 d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
    //查询分组信息
	i Action = "QueryChoose" d
	.d ##class(web.DHCSTM.LocClaGrp).QueryChoose(RowId,Start,Limit)
	
	//查询未分组信息
	i Action = "NotChoose" d
	.s Input=$Get(%request.Data("FilterDesc",1))
	.d ##class(web.DHCSTM.LocClaGrp).QueryNotChoose(Loc,Start,Limit,Input)
	//插入分组明细信息
	i Action = "addGrpInci" d
	.s Inci=$Get(%request.Data("Inci",1))
	.s result = ##class(web.DHCSTM.LocClaGrp).AddGrpInci(RowId,Inci)
	.i result = "" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	//删除分组明细信息
	i Action = "deleteGrpInci" d
	.s GrpiId=$Get(%request.Data("GrpiId",1))
	.s result = ##class(web.DHCSTM.LocClaGrp).DeleteGrpInci(GrpiId)
	.i result = 0 d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
</script>