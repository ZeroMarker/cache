webpackJsonp([291],{"0lLS":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),o=a("NYxO"),l=a("XlQt"),i=a("z8xk"),n={components:{hgbutton:l.default,Hgpanel:i.default},computed:r()({},Object(o.b)(["Height","styleCode"])),data:function(){return{treeStyle:{height:""},dataform:{role:"",nurseName:""},rolestore:[],nursedata:[],wardtree:[],isShowHeader:!0,defaultProps:{children:"cd",label:"lb"},selectrow:"",selectWards:[]}},created:function(){this.LoadRoleStore(),this.treeStyle.height=this.Height-83+"px",this.LoadWardTree()},methods:{LoadRoleStore:function(){var e=this;e.$ajax.request(e.axiosConfig("web.INMSetComm","FindRoleList","RecQuery","parr$")).then(function(t){e.rolestore=t.data.rows})},RoleChangeEvent:function(){var e=this,t=e.dataform.role,a=e.dataform.nurseName;e.$ajax.request(e.axiosConfig("web.INMSetComm","FindAssRoleNurse","RecQuery","id$"+t,"parr$"+a)).then(function(t){e.nursedata=t.data.rows,e.selectrow="",e.$refs.wardtree.setCheckedKeys(new Array)})},LoadWardTree:function(){var e=this;e.$ajax.request(e.axiosConfig("web.INMDataLimit","GetMiniWard","Method")).then(function(t){e.wardtree=[{lb:"全部",id:"",cd:t.data}]})},NurseListClick:function(e,t,a){var s=this,r=s.dataform.role;s.selectrow=e.UserId,s.$ajax.request(s.axiosConfig("web.INMDataLimit","FindNurseWards","RecQuery","role$"+r,"nurse$"+e.UserId)).then(function(e){if(s.selectWards=new Array,e.data.rows.length>0){for(var t=0;t<e.data.rows.length;t++)s.selectWards.push(e.data.rows[t].key);s.$refs.wardtree.setCheckedKeys(s.selectWards)}else s.$refs.wardtree.setCheckedKeys(s.selectWards);s.$nextTick(function(){var e=document.getElementsByClassName("el-tree-node is-expanded is-focusable is-checked")[0];e&&(document.getElementsByClassName("el-tree")[0].scrollTop=e.offsetTop)})})},SaveLimitData:function(){var e=this;if(e.selectrow){var t=e.dataform.role,a=e.selectrow,s=e.selectWards.toString();e.$ajax.request(e.axiosConfig("web.INMDataLimit","SaveNurseLimit","Method","role$"+t,"nurse$"+a,"wards$"+s)).then(function(t){1==t.data?e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}else e.$message({type:"warning",message:"请选择一条记录！",showClose:!0,customClass:"warning_class"})},SelectChange:function(e,t,a){this.selectWards=this.$refs.wardtree.getCheckedKeys()}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-permission-panel"},[a("div",{staticClass:"top-tool-inputDiv"},[a("el-form",{ref:"dataform",attrs:{inline:!0,"label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("menu.DataPermission.5nrnc5gyrps0")}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",clearable:"",size:"mini",placeholder:""},on:{change:e.RoleChangeEvent},model:{value:e.dataform.role,callback:function(t){e.$set(e.dataform,"role",t)},expression:"dataform.role"}},e._l(e.rolestore,function(e){return a("el-option",{key:e.rw,attrs:{label:e.RoleDesc,value:e.rw}})}),1)],1),e._v(" "),a("el-form-item",[a("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveLimitData,time:500},expression:"{func:SaveLimitData,time:500,}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode,icon:"nm-icon-w-save"}},[e._v(e._s(e.$t("menu.DataPermission.5nrnc5gyuik0")))])],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{padding:"10px"},attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"top-tool-table-dialog-top dialog-div-top-radius"},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:e.$t("menu.DataPermission.5nrnc5h0ew00"),"suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search",size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.RoleChangeEvent(t)}},model:{value:e.dataform.nurseName,callback:function(t){e.$set(e.dataform,"nurseName",t)},expression:"dataform.nurseName"}})],1),e._v(" "),a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius"},[a("el-table",{ref:"nurselist",staticClass:"dialog-table-bottom-radius",staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"show-header":e.isShowHeader,"header-cell-style":e.headerCellFontWeight,"tooltip-effect":"dark",data:e.nursedata,border:e.styleCode,height:e.Height-133},on:{"row-click":e.NurseListClick}},[a("el-table-column",{attrs:{label:e.$t("menu.DataPermission.5nrnc5h1fbw0"),prop:"NurseName"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.DataPermission.5nrnc5h2i640"),prop:"NurseId"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.DataPermission.5nrnc5h3hj40"),width:"200",prop:"NurseWard"}}),e._v(" "),e._e()],1)],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius"},[a("el-tree",{ref:"wardtree",staticClass:"dialog-table-bottom-radius",staticStyle:{overflow:"auto",border:"none"},style:e.treeStyle,attrs:{data:e.wardtree,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps},on:{"check-change":e.SelectChange}})],1)])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(n,d,!1,function(e){a("NKzh")},null,null);t.default=c.exports},NKzh:function(e,t){}});