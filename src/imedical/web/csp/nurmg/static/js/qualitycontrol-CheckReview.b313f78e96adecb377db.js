webpackJsonp([144,181],{"/z3Q":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),o=a("yKG+"),n=a("XlQt"),l=a("W5Fe"),i=a("NYxO"),c={name:"CheckReview",components:{NurQualCheckScore:o.default,Hgbutton:n.default,hgpagination:l.default},computed:r()({},Object(i.b)(["Height","styleCode"])),data:function(){return{elementlist:{},ToolForm:{Ward:"",Type:"",Qual:"",StDate:new Date((new Date).setDate(1)),EndDate:(new Date).getMonthLastDate()},WardStore:[],TypeStore:[],QualStore:[],SelectTab:"1",ReviewTable:[],ReviewTableAll:[],ReviewCurrentPage:1,ReviewPageSize:20,ReviewTotalCount:0,RecoredTable:[],RecoredTableAll:[],RecoredCurrentPage:1,RecoredPageSize:20,RecoredTotalCount:0,Params:{},CheckDialogVisible:!1,CheckRecLoading:!1}},methods:{LoadRoleWard:function(){var e=this;this.WardStore=[];var t=this.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.loginID);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardStore=t.data.rows:e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})})},LoadQualType:function(){var e=this;this.TypeStore=[];var t=this.axiosConfig("web.INMQualControlComm","FindQualTypeList","RecQuery","type$");this.$ajax.request(t).then(function(t){t.data instanceof Object?e.TypeStore=t.data.rows:e.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})})},LoadQualItem:function(){var e=this;this.QualStore=[];var t="";this.ToolForm.StDate instanceof Date&&(t=this.ToolForm.StDate.Format("YYYY")),this.ToolForm.EndDate instanceof Date&&(t=t+","+this.ToolForm.EndDate.Format("YYYY")),this.$ajax.request(this.axiosConfig("web.INMQualControlComm","FindQualForType","RecQuery","year$"+t)).then(function(t){t.data instanceof Object?e.QualStore=t.data.rows:e.$message({type:"error",message:"获取质控项目失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取质控项目失败",showClose:!0,customClass:"error_class"})})},ToolFormSearch:function(){var e=this.ToolForm.Ward,t=this.ToolForm.Type,a=this.ToolForm.Qual,s="";this.ToolForm.StDate instanceof Date&&(s=this.ToolForm.StDate.Format("YYYY-MM-dd"));var r="";this.ToolForm.EndDate instanceof Date&&(r=this.ToolForm.EndDate.Format("YYYY-MM-dd"));var o=e+"^"+t+"^"+a+"^"+s+"^"+r;switch(this.SelectTab){case"1":this.LoadCheckReview(o);break;case"2":this.LoadReviewRecore(o)}},LoadCheckReview:function(e){var t=this,a=(this.ReviewCurrentPage-1)*this.ReviewPageSize,s=this.ReviewPageSize;this.ReviewTable=[],this.ReviewTableAll=[];var r=this.axiosConfig("web.INMQualControlComm","FindReviewList","RecQuery","parr$"+e,"nurseid$"+sessionStorage.loginID);this.$ajax.request(r).then(function(e){e.data instanceof Object?(t.ReviewTable=e.data.rows.slice(a,a+s),t.ReviewTableAll=e.data.rows,t.ReviewTotalCount=parseInt(e.data.results)):t.$message({type:"error",message:"获取复查数据列表失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取复查数据列表失败",showClose:!0,customClass:"error_class"})})},LoadReviewRecore:function(e){var t=this,a=(this.RecoredCurrentPage-1)*this.RecoredPageSize,s=this.RecoredPageSize;this.RecoredTable=[],this.RecoredTableAll=[];var r=this.axiosConfig("web.INMQualControlComm","FindReviewRecList","RecQuery","parr$"+e,"nurseid$"+sessionStorage.loginID);this.$ajax.request(r).then(function(e){e.data instanceof Object?(t.RecoredTable=e.data.rows.slice(a,a+s),t.RecoredTableAll=e.data.rows,t.RecoredTotalCount=parseInt(e.data.results)):t.$message({type:"error",message:"获取复查数据列表失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取复查数据列表失败",showClose:!0,customClass:"error_class"})})},CloseCheckDialog:function(){this.CheckDialogVisible=!1},RowClick:function(e){},RowDblClick:function(e){this.Params={TaskId:e.TaskId,TaskItem:e.QuesItem,TaskItemDesc:e.QuesItemDesc,TaskWard:e.QuesWard,TaskWardDesc:e.QuesWardDesc,TaskType:e.QuesType,ResultId:e.ResultId,TaskStatus:"S",TaskStatusDesc:"提交",TaskChecker:e.TaskChecker,TaskSubmitter:e.ResultSubmitter,TaskSubmitterName:e.ResultSubmitterName,TaskCheckDate:e.ResultCheckDate,TaskScore:e.ResultScore,TaskRemark:e.ResultRemark,Review:!0},this.CheckDialogVisible=!0},HandleSizeChange:function(e){switch(this.SelectTab){case"1":this.ReviewPageSize=e;break;case"2":this.RecoredPageSize=e}this.ToolFormSearch()},HandleCurrentChange:function(e){switch(this.SelectTab){case"1":this.ReviewCurrentPage=e.currentPage;break;case"2":this.RecoredCurrentPage=e.currentPage}this.ToolFormSearch()}},created:function(){this.LoadRoleWard(),this.LoadQualType(),this.LoadQualItem(),this.ToolFormSearch();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"check-review-panel"},[a("div",{staticClass:"top-tool-inputDiv"},[a("el-form",{attrs:{model:e.ToolForm,inline:!0,"label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("menu.CheckReview.5nrnbqjrhxk0")}},[a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",size:"mini"},model:{value:e.ToolForm.Ward,callback:function(t){e.$set(e.ToolForm,"Ward",t)},expression:"ToolForm.Ward"}},e._l(e.WardStore,function(e){return a("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.CheckReview.5nrnbqjsjds0")}},[a("el-select",{staticStyle:{width:"100px"},attrs:{clearable:"",placeholder:e.$t("menu.CheckReview.5nrnbqjtlaw0"),size:"mini"},model:{value:e.ToolForm.Type,callback:function(t){e.$set(e.ToolForm,"Type",t)},expression:"ToolForm.Type"}},e._l(e.TypeStore,function(e){return a("el-option",{key:e.rw,attrs:{label:e.SubDesc,value:e.rw}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.CheckReview.5nrnbqjvk900")}},[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",filterable:"",placeholder:e.$t("menu.CheckReview.5nrnbqjtlaw0"),size:"mini"},model:{value:e.ToolForm.Qual,callback:function(t){e.$set(e.ToolForm,"Qual",t)},expression:"ToolForm.Qual"}},e._l(e.QualStore,function(e){return a("el-option",{key:e.Qual,attrs:{label:e.QualDesc,value:e.Qual}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.CheckReview.5nrnbqjzmmc0")}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{clearable:"",type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},on:{change:e.LoadQualItem},model:{value:e.ToolForm.StDate,callback:function(t){e.$set(e.ToolForm,"StDate",t)},expression:"ToolForm.StDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.CheckReview.5nrnbqk24xg0")}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{clearable:"",type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},on:{change:e.LoadQualItem},model:{value:e.ToolForm.EndDate,callback:function(t){e.$set(e.ToolForm,"EndDate",t)},expression:"ToolForm.EndDate"}})],1),e._v(" "),a("el-form-item",[a("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.ToolFormSearch}},[e._v(e._s(e.$t("menu.CheckReview.5nrnbqk29lw0")))]),e._v(" "),this.elementlist.download||0==this.$store.state.login.LoginId?a("hgbutton",{directives:[{name:"show",rawName:"v-show",value:"1"==e.SelectTab,expression:"SelectTab=='1'"}],attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-export"},on:{click:function(t){e.exportData("ReviewTable",e.ReviewTableAll,e.$t("menu.CheckReview.5ncy6k6b8gs0"))}}},[e._v(e._s(e.$t("menu.CheckReview.5nrnbqk2at80")))]):e._e(),e._v(" "),this.elementlist.download||0==this.$store.state.login.LoginId?a("hgbutton",{directives:[{name:"show",rawName:"v-show",value:"2"==e.SelectTab,expression:"SelectTab=='2'"}],attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-export"},on:{click:function(t){e.exportData("RecoredTable",e.RecoredTableAll,e.$t("menu.CheckReview.5ncy6k6d1c40"))}}},[e._v(e._s(e.$t("menu.CheckReview.5nrnbqk2at80")))]):e._e()],1)],1)],1),e._v(" "),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.ToolFormSearch},model:{value:e.SelectTab,callback:function(t){e.SelectTab=t},expression:"SelectTab"}},[a("el-tab-pane",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6b8gs0"),name:"1"}},[a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius"},[a("el-table",{ref:"ReviewTable",staticClass:"dialog-div-top-radius",attrs:{data:e.ReviewTable,"highlight-current-row":"","header-cell-style":e.headerCellFontWeight,border:e.styleCode,height:e.styleCode?e.Height-155:e.Height-152},on:{"row-click":e.RowClick,"row-dblclick":e.RowDblClick}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesDate",label:e.$t("menu.CheckReview.5nrnbqjzmmc0"),"show-overflow-tooltip":"",formatter:e.PTableDateHisShow}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesWardDesc",label:e.$t("menu.CheckReview.5nrnbqjrhxk0"),"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"TaskSourceDesc",label:e.$t("menu.CheckReview.5nrnbqkai8k0"),"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesTypeDesc",label:e.$t("menu.CheckReview.5nrnbqkc6ss0"),"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesItemDesc",label:e.$t("menu.CheckReview.5nrnbqkdvn80"),"show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesReviewCounter",label:e.$t("menu.CheckReview.5ncy6k6enw40"),"show-overflow-tooltip":""}})],1),e._v(" "),a("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.ReviewTotalCount,pageNumber:e.ReviewCurrentPage,pageSize:e.ReviewPageSize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6d1c40"),name:"2"}},[a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius",style:{"border-top":e.styleCode?"":"1px solid #e2e2e2"}},[a("el-table",{ref:"RecoredTable",staticClass:"dialog-div-top-radius multi-level-table-head multi-level-table-body",attrs:{data:e.RecoredTable,"highlight-current-row":"",border:e.styleCode,"header-cell-style":e.headerCellFontWeight,height:e.styleCode?e.Height-155:e.Height-153}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesDate",label:e.$t("menu.CheckReview.5nrnbqjzmmc0"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesWardDesc",label:e.$t("menu.CheckReview.5nrnbqjrhxk0"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TaskSourceDesc",label:e.$t("menu.CheckReview.5nrnbqkai8k0"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesTypeDesc",label:e.$t("menu.CheckReview.5nrnbqkc6ss0"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QuesItemDesc",label:e.$t("menu.CheckReview.5nrnbqkdvn80"),"show-overflow-tooltip":"",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6gfhw0"),"header-align":"center"}},[a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5nrnbqkr3is0"),"class-name":"task-column-ques","header-align":"left"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.QuesDesc.split("」"),function(t,s){return a("div",{key:s},[a("el-tooltip",{attrs:{content:t,effect:"dark",placement:"top"}},[a("span",[e._v(e._s(t))])])],1)})}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5nrnbqksprk0"),"class-name":"task-column-ques",align:"left",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.QuesReviewResult.split("」"),function(t,s){return a("div",{key:s},[a("span",[e._v(e._s("Y"==t?e.$t("menu.CheckReview.5ncy6k6iy340"):e.$t("menu.CheckReview.5ncy6k6jk680")))])])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6kkd80"),"class-name":"task-column-ques",align:"left",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.QuesReviewCheckerName.split("」"),function(t,s){return a("div",{key:s},[a("span",[e._v(e._s(t))])])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6klkg0"),"class-name":"task-column-ques",align:"left",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.QuesReviewCheckDate.split("」"),function(t,s){return a("div",{key:s},[a("span",[e._v(e._s(t))])])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("menu.CheckReview.5ncy6k6kmbc0"),"class-name":"task-column-ques",align:"left",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.QuesReviewCheckTime.split("」"),function(t,s){return a("div",{key:s},[a("span",[e._v(e._s(t))])])})}}])})],1)],1),e._v(" "),a("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.RecoredTotalCount,pageNumber:e.RecoredCurrentPage,pageSize:e.RecoredPageSize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1)])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.CheckDialogVisible,title:e.$t("menu.CheckReview.5nrnbqktwa00"),"close-on-click-modal":!1,modal:"",width:"1300px"},on:{"update:visible":function(t){e.CheckDialogVisible=t}}},[a("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?a("i",{staticClass:"nm-icon-w-paper"}):e._e(),e._v(" "),a("span",[e._v(e._s(e.$t("menu.CheckReview.5nrnbqktwa00")))])]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.CheckRecLoading,expression:"CheckRecLoading"}],attrs:{"element-loading-text":e.$t("menu.CheckReview.5nrnbqkvj0w0")}},[e.CheckDialogVisible?a("NurQualCheckScore",{attrs:{params:e.Params},on:{LoadCheckList:e.ToolFormSearch,CloseDialog:e.CloseCheckDialog}}):e._e()],1)])],1)},staticRenderFns:[]};var h=a("VU/8")(c,u,!1,function(e){a("h7a2")},null,null);t.default=h.exports},h7a2:function(e,t){},nMRI:function(e,t){},"yKG+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Gu7T"),r=a.n(s),o=a("Dd8w"),n=a.n(o),l=a("NYxO"),i=a("s5sJ"),c={components:{hgbutton:a("XlQt").default},name:"NurQualCheckScore",computed:n()({},Object(l.b)(["Height","styleCode"])),props:["params"],directives:{dragMove:{inserted:function(e,t,a){if(navigator.userAgent.indexOf("Trident")>-1&&navigator.userAgent.indexOf("rv:11.0")>-1||navigator.userAgent.indexOf("MSIE")>-1){var s=document.createElement("span"),r=document.createElement("label");s.appendChild(r),s.style.position="relative",s.style.verticalAlign="bottom",r.style.position="absolute",r.style.width="17px",r.style.height="17px",r.style.background="url(\"data:image/svg+xml,%3Csvg viewBox='0 0 1024 1024' xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cpath d='M765.558 510.004a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM765.558 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM422.15700000000004 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM422.15700000000004 510.004a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM765.558 202.54a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM66.77700000000002 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0z' fill='%23BFBFBF'/%3E%3C/svg%3E\") no-repeat center",r.style.bottom="0",r.style.right="0",r.style.backgroundSize="12px 12px",s.onmousedown=function(t){e.dragMovePreY=t.pageY,e.dragMovePreH=e.offsetHeight,document.onmousemove=function(t){var a=e.dragMovePreH+(t.pageY-e.dragMovePreY);a<39&&(a=39),e.style.height=a+"px"},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,e.dragMovePreY=null}},e.appendChild(s)}}}},data:function(){return{TdStyle:{border:"1px solid #EBEEF5",fontSize:"16px",fontFamily:"Microsoft YaHei",padding:"4px",height:"30px"},Title:"",TableData:[],total:[],scoreType:"",scoreTypeSub:"",Deepth:1,InsertCount:0,contextMenuData:{menuName:"taskmenulist",axis:{x:null,y:null},menulists:[],checkedValueList:[]},selectrow:{},selectcolumn:0,CheckInfo:{User:"",Ward:"",Date:new Date,Score:"",Status:"",Remark:"",CheckAccordScore:"",CheckAccordScoreSum:""},Editable:!1,rules:{Date:[{required:!0,message:"检查日期不能为空",trigger:"change",type:"date"}]},InsertHead:[],InsertHeadPat:[],InsertHeadNur:[],InsertHeadInput:[],WardPatientStore:[],WardNurseStore:[],CheckScoreFlag:"N",PrintWhiteFlag:!1,DefaultScore:[],IsOverHlb:!1}},methods:{GetSummary:function(e){e.columns,e.data;var t=[];return t.push.apply(t,r()(new Array(this.Deepth).fill(""))),t[0]="合计",2==this.scoreTypeSub&&"Y"==this.CheckScoreFlag&&t.push(this.CheckInfo.CheckAccordScoreSum),t.push.apply(t,r()(this.total)),1==this.params.Review&&t.push(""),2==this.scoreTypeSub&&"Y"==this.CheckScoreFlag&&t.push(this.CheckInfo.CheckAccordScore),2==this.scoreTypeSub&&t.push(this.CheckInfo.Score),t.push(""),t},QualSpan:function(e){var t=e.row,a=(e.column,e.rowIndex,e.columnIndex+1);if(2==this.scoreTypeSub){var s=1+this.InsertCount+("Y"==this.CheckScoreFlag?2:0),r=this.Deepth+s+1,o=r+this.Deepth-1;a>=r&&a<=o&&(a=a-(a-r)-s-(a-r)-1)}var n=t.SubSort.split(".").length-1;if(a<n){var l=a+1;if(t.Roots.some(function(e){return e.split(".").length-1==l})){var i=t.SubSort.split(".").slice(0,a+1).join(".");return[this.TableData.find(function(e){return e.SubSort==i}).RowSpan,1]}return[0,0]}return a==n?[1,this.Deepth-n+1]:a>this.Deepth?[1,1]:[0,0]},CalculateScore:function(e){for(var t=0,a=0,s=0,r=0;r<e.length;r++){var o=e[r];if("-"!=o){var n=o.split("@");t+=n[0]?isNaN(parseInt(n[0]))?0:parseInt(n[0]):0,a+=n[1]?isNaN(parseInt(n[1]))?0:parseInt(n[1]):0,s+=n[2]?isNaN(parseInt(n[2]))?0:parseInt(n[2]):0}}var l="100%";return t+a+s!=0&&(l=(t/(t+a+s)*100).toFixed(2)+"%"),l},CalculateFatherScore:function(e){var t=0,a=0,s=0;if(!e)return"";e=e.substring(0,e.lastIndexOf(".")),this.TableData.forEach(function(r){if(0==r.HasChild&&r.SubSort.substring(0,e.length)==e)for(var o=0;o<r.ItemScore.length;o++){var n=r.ItemScore[o];if("-"!=n){var l=n.split("@");t+=l[0]?isNaN(parseInt(l[0]))?0:parseInt(l[0]):0,a+=l[1]?isNaN(parseInt(l[1]))?0:parseInt(l[1]):0,s+=l[2]?isNaN(parseInt(l[2]))?0:parseInt(l[2]):0}}});var r="100%";return t+a+s!=0&&(r=(t/(t+a+s)*100).toFixed(2)+"%"),r},GetFatherRowSpan:function(e){return e=e.substring(0,e.lastIndexOf(".")),this.TableData.find(function(t){return t.SubSort==e}).RowSpan},GetReverseRoots:function(e){return[].concat(r()(e)).reverse()},GetFatherDesc:function(e){return e=e.substring(0,e.lastIndexOf(".")),this.TableData.find(function(t){return t.SubSort==e}).SubItem},GetSchduleData:function(){var e=this,t=this;t.$ajax.request(t.axiosConfig("web.INMQualControlComm","GetQualCheck","Method","task$"+t.params.TaskId,"qualpar$"+t.params.TaskItem,"ward$"+t.params.TaskWard)).then(function(a){if(a.data instanceof Object){t.scoreType=a.data.ScoreType,t.scoreTypeSub=a.data.ScoreTypeSub,t.CheckScoreFlag=a.data.CheckScoreFlag,t.InsertCount=isNaN(parseInt(a.data.InsertCount))?1:parseInt(a.data.InsertCount),2==a.data.ScoreType?t.total=new Array(t.InsertCount+1).fill(0):2==a.data.ScoreTypeSub?t.total=new Array(t.InsertCount).fill(""):t.total=new Array(t.InsertCount).fill("100%"),t.Deepth=isNaN(parseInt(a.data.Deepth))?1:parseInt(a.data.Deepth),t.InsertHead=a.data.QualInsert?a.data.QualInsert:[],t.InsertHeadPat=a.data.QualInsertPat?a.data.QualInsertPat:[],t.InsertHeadNur=a.data.QualInsertNur?a.data.QualInsertNur:[],t.InsertHeadInput=a.data.QualInsertInput?a.data.QualInsertInput:[],a.data.QualSubItems=a.data.QualSubItems?a.data.QualSubItems:[],e.DefaultScore=new Array(a.data.QualSubItems.length).fill(""),a.data.QualSubItems.forEach(function(s,r){if(0==s.HasChild){if(s.ItemScore?(s.ItemScore=s.ItemScore.split(","),e.DefaultScore[r]=s.ItemScore[0]):2!=a.data.ScoreType&&2==a.data.ScoreTypeSub?(s.ItemScore=new Array(t.InsertCount).fill("@@"),e.DefaultScore[r]="@@"):(s.ItemScore=new Array(t.InsertCount).fill(""),e.DefaultScore[r]=""),2!=a.data.ScoreType&&2==a.data.ScoreTypeSub){s.ScoreToShow=new Array(t.InsertCount);var o=s.CheckMenu.split(",");s.ItemScore.forEach(function(e,t){if(e)if("-"==e)s.ScoreToShow[t]="不适用";else{var a="";e.split("@").forEach(function(e,t){e&&(a=a?a+","+o[t].split("@")[0]+":"+e:o[t].split("@")[0]+":"+e)}),s.ScoreToShow[t]=a}else s.ScoreToShow[t]=""})}else if(2==a.data.ScoreType&&6==a.data.ScoreTypeSub){s.ScoreToShow=new Array(t.InsertCount);var n=s.CheckMenu.split(",");s.ItemScore.forEach(function(e,t){if(e){var a="";e.split("@").forEach(function(e,t){e&&(a=a?a+","+n[parseInt(e)].split("@")[0]:n[parseInt(e)].split("@")[0])}),s.ScoreToShow[t]=a}else s.ScoreToShow[t]=""})}if(2==a.data.ScoreType&&0==s.HasChild){var l=Number(s.SubScore);t.total[0]=t.total[0]+(isNaN(l)?0:l)}}}),t.TableData=a.data.QualSubItems;for(var s=0;s<t.InsertCount;s++)t.selectcolumn=s,t.CalculateTotal();e.$nextTick(function(){e.$refs["qual-check-table"].doLayout()})}else t.$message({type:"error",message:"获取检查单失败!",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取检查单失败!",showClose:!0,customClass:"error_class"})})},CellClickEvent:function(e,t,a,s,r){if(this.Editable){var o=[];t.CheckMenu&&t.CheckMenu.split(",").forEach(function(e,n){var l=e.split("@"),i=l[0],c=l[1],u=l[2]?l[2]:"",h=!(!s||"不适用"==i),d=!(!r||"不适用"==i),m=n+"",p="";h&&t.ItemScore[a]&&"-"!=t.ItemScore[a]&&(p=t.ItemScore[a].split("@")[n]),o.push({fnHandler:h?"":"MarkScore",icoName:u,btnName:i,fnHandlerArg:c,showInput:h,inputValue:p,showCheckBox:d,checkedValue:m})}),this.selectrow=t,this.selectcolumn=a,r&&(t.ItemScore[a]?this.contextMenuData.checkedValueList=t.ItemScore[a].split("@"):this.contextMenuData.checkedValueList.splice(0,this.contextMenuData.checkedValueList.length)),this.contextMenuData.menulists=o,this.contextMenuData.axis={x:e.clientX,y:e.clientY}}},ChangeScore:function(e,t){if(this.Editable){this.selectrow=e,this.selectcolumn=t;var a=Number(e.ItemScore[t]);if(isNaN(a))e.ItemScore.splice(t,1,0);else if(a>Number(e.SubScore)){var s=Number(e.SubScore);e.ItemScore.splice(t,1,2==this.scoreType&&3==this.scoreTypeSub?s:-s)}else 2==this.scoreType&&3==this.scoreTypeSub&&a<0?e.ItemScore.splice(t,1,0):2==this.scoreType&&4==this.scoreTypeSub&&(Math.abs(a)>Number(e.SubScore)?e.ItemScore.splice(t,1,-Number(e.SubScore)):e.ItemScore.splice(t,1,-Math.abs(a)));this.CalculateTotal()}},ChangeScore2:function(e){if(this.Editable){var t=Number(e.SubAccordScore);isNaN(t)?e.SubAccordScore="":Math.abs(t)>Number(e.SubScore)?e.SubAccordScore=-Number(e.SubScore):e.SubAccordScore=-Math.abs(t),this.CalculateTotal()}},MarkScore:function(e){this.selectrow.ItemScore.splice(this.selectcolumn,1,e),"-"==e&&2!=this.scoreType&&2==this.scoreTypeSub&&this.selectrow.ScoreToShow.splice(this.selectcolumn,1,"不适用"),this.CalculateTotal()},HandleCountChange:function(e,t){"-"==this.selectrow.ItemScore[this.selectcolumn]&&this.selectrow.ItemScore[this.selectcolumn];var a=this.selectrow.ItemScore[this.selectcolumn].split("@");a[t]=e,this.selectrow.ItemScore[this.selectcolumn]=a.join("@");var s=this.selectrow.CheckMenu.split(","),r="";a.forEach(function(e,t){e&&(r=r?r+","+s[t].split("@")[0]+":"+e:s[t].split("@")[0]+":"+e)}),this.selectrow.ScoreToShow.splice(this.selectcolumn,1,r),this.CalculateTotal()},HandleCheckChange:function(e,t,a){this.selectrow.ItemScore[this.selectcolumn]=e.join("@");var s=this.selectrow.CheckMenu.split(","),r="";e.forEach(function(e){r=r?r+","+s[parseInt(e)].split("@")[0]:s[parseInt(e)].split("@")[0]}),this.selectrow.ScoreToShow.splice(this.selectcolumn,1,r),this.CalculateTotal()},CalculateTotal:function(){var e=this,t=0,a=0,s=0,r=0,o=0,n=0,l=0,i=0,c=0,u=0,h=0;if(this.TableData.forEach(function(d){if(0==d.HasChild)if(2!=e.scoreType&&1==e.scoreTypeSub)"√"==d.ItemScore[e.selectcolumn]?s+=1:"×"==d.ItemScore[e.selectcolumn]&&(a+=1);else if(2!=e.scoreType&&2==e.scoreTypeSub){for(var m=0;m<d.ItemScore.length;m++)if("-"!=d.ItemScore[m]){var p=d.ItemScore[m].split("@"),S=p[0]?isNaN(parseInt(p[0]))?0:parseInt(p[0]):0,b=p[1]?isNaN(parseInt(p[1]))?0:parseInt(p[1]):0,v=p[2]?isNaN(parseInt(p[2]))?0:parseInt(p[2]):0;m==e.selectcolumn&&(r+=S,o+=b,n+=v),l+=S,i+=b,c+=v}var C=Number(d.SubAccordScore),f=Number(d.SubScore);u+=isNaN(C)?0:C,h+=isNaN(f)?0:f}else if(2!=e.scoreType||3!=e.scoreTypeSub&&4!=e.scoreTypeSub&&5!=e.scoreTypeSub){if(2==e.scoreType&&6==e.scoreTypeSub){var k=d.ItemScore[e.selectcolumn].split("@"),y=d.CheckMenu.split(","),w=0;k.forEach(function(e){if(e=parseInt(e),!(isNaN(e)||e>=y.length)){var t=y[e].split("@")[1];t=Number(t),isNaN(t)||(w-=t)}}),Math.abs(w)>Number(d.SubScore)&&(w=-Number(d.SubScore)),t+=w}}else{var g=Number(d.ItemScore[e.selectcolumn]);t+=isNaN(g)?0:g}}),2!=this.scoreType&&1==this.scoreTypeSub){var d="100%";s+a!=0&&(d=(s/(s+a)*100).toFixed(2)+"%"),this.total.splice(this.selectcolumn,1,d)}else if(2!=this.scoreType&&2==this.scoreTypeSub){var m="总例数:"+(r+o+n)+",完全符合:"+r,p=this.selectcolumn;this.total.splice(p,1,m)}else 2!=this.scoreType||3!=this.scoreTypeSub&&5!=this.scoreTypeSub?2!=this.scoreType||4!=this.scoreTypeSub&&6!=this.scoreTypeSub||this.total.splice(this.selectcolumn+1,1,this.total[0]+t):this.total.splice(this.selectcolumn+1,1,t);if(2!=this.scoreType)if(2==this.scoreTypeSub){var S="100%";l+i+c!=0&&(S=(l/(l+i+c)*100).toFixed(2)+"%"),this.CheckInfo.Score=S,this.CheckInfo.CheckAccordScore=u,this.CheckInfo.CheckAccordScoreSum=h}else{var b=0;this.total.forEach(function(e,t){var a=Number(e.replace("%",""));b+=isNaN(a)?0:a}),this.CheckInfo.Score=this.total.length>0?(b/this.total.length).toFixed(2)+"%":"0%"}else if(2==this.scoreType){var v=0;this.total.forEach(function(e,t){if(0!=t){var a=Number(e);v+=isNaN(a)?0:a}}),this.CheckInfo.Score=this.total.length>1?(v/(this.total.length-1)).toFixed(2):0}},Save:function(e){var t=this;this.$refs.CheckInfo.validate(function(a){if(a){var s=t.params.TaskId+"^"+t.params.TaskItem+"^"+t.params.TaskWard+"^"+t.params.TaskType+"^"+t.CheckInfo.Date.Format("YYYY-MM-dd");s=(s=s+"^"+t.CheckInfo.Score+"^"+e+"^"+t.CheckInfo.Remark+"^"+t.params.ResultId)+"^"+t.CheckInfo.CheckAccordScore+"^"+t.CheckInfo.CheckAccordScoreSum+"^"+t.CheckScoreFlag;var r=[];t.InsertHead.indexOf(1)>-1?r.push(t.InsertHeadPat.join("^")):r.push(""),t.InsertHead.indexOf(2)>-1?r.push(t.InsertHeadNur.join("^")):r.push(""),t.InsertHead.indexOf(3)>-1?r.push(t.InsertHeadInput.join("^")):r.push(""),r=r.join("ˇ");var o="";t.TableData.forEach(function(e){var t="";e.ItemScore instanceof Array?e.ItemScore.forEach(function(e,a){t=0==a?e:t+","+e}):t=e.ItemScore,o=o?o+"ˇ"+e.QualSubId+"^"+t+"^"+e.ResultSubId+"^"+e.Remark+"^"+e.SubAccordScore:e.QualSubId+"^"+t+"^"+e.ResultSubId+"^"+e.Remark+"^"+e.SubAccordScore});var n=t.axiosConfig("web.INMQualControlComm","SaveQualCheck","Method","parr$"+s,"insert$"+r,"table$"+o,"nurseid$"+sessionStorage.getItem("loginID"));t.$ajax.request(n).then(function(e){!isNaN(Number(e.data))&&Number(e.data)>0?(t.$emit("CloseDialog"),t.$emit("LoadCheckList"),t.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"})):t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}})},Print:function(){var e=document.getElementById("schduleprint").innerHTML,t="<style>.NurQualCheckScoreCell{width:100%;height:100%;}.NurQualCheckScoreCell span{left:50%;transform:translateX(-50%);}</style>";t+="<style>.printNone{display:none;}table,tr,th,td{border:1px solid black!important;}</style>";var a="<html><head>"+(t+="<style>.printCheckInfo{display:block;}</style>")+"</head><body>"+e+"</body></html>",s=Object(i.a)();s.PRINT_INIT(""),s.SET_PRINT_PAGESIZE(2,"210mm","297mm","A4"),s.ADD_PRINT_HTM("0.1cm","0.1cm","RightMargin:0.1cm","BottomMargin:0.1cm",a),s.SET_SHOW_MODE("LANDSCAPE_DEFROTATED",1),s.PREVIEW(),this.PrintWhiteFlag=!1},PrintWhite:function(){var e=this;this.PrintWhiteFlag=!0,this.$nextTick(function(){e.Print()})},ReviewChange:function(e){"Y"==e.Review?e.ReviewDesc="复查通过":"N"==e.Review&&(e.ReviewDesc="复查未通过")},SaveReview:function(){var e=this,t="";this.TableData.forEach(function(e){"Y"==e.NeedReview&&(t=t?t+"^"+e.ResultSubId+","+e.Review:e.ResultSubId+","+e.Review)});var a=this.axiosConfig("web.INMQualControlComm","SaveReview","Method","parr$"+t,"nurseid$"+sessionStorage.loginID);this.$ajax.request(a).then(function(t){1==t.data?(e.$emit("CloseDialog"),e.$emit("LoadCheckList"),e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"})):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})},LoadWardPatient:function(){var e=this;this.WardPatientStore=[];var t=this.axiosConfig("web.INMHISComm","FindWardPatList","RecQuery","ward$"+this.params.TaskWard);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardPatientStore=t.data.rows:e.$message({type:"error",message:"获取病区患者失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取病区患者失败",showClose:!0,customClass:"error_class"})})},LoadWardNurse:function(){var e=this;this.WardNurseStore=[];var t=this.axiosConfig("web.INMHRComm","FindWardNurseList","RecQuery","ward$"+this.params.TaskWard);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardNurseStore=t.data.rows:e.$message({type:"error",message:"获取病区人员失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取病区人员失败",showClose:!0,customClass:"error_class"})})},AddColumn:function(){var e=this;this.TableData.forEach(function(t,a){0==t.HasChild&&(2!=e.scoreType&&2==e.scoreTypeSub?t.ItemScore.push("@@"):2!=e.scoreType||3!=e.scoreTypeSub&&5!=e.scoreTypeSub?t.ItemScore.push(e.DefaultScore[a]):t.ItemScore.push(t.SubScore),(2!=e.scoreType&&2==e.scoreTypeSub||2==e.scoreType&&6==e.scoreTypeSub)&&t.ScoreToShow.push(""))}),this.InsertHead.indexOf(1)>-1&&this.InsertHeadPat.push(""),this.InsertHead.indexOf(2)>-1&&this.InsertHeadNur.push(""),this.InsertHead.indexOf(3)>-1&&this.InsertHeadInput.push(""),this.total.push(""),this.InsertCount+=1,this.selectcolumn=this.InsertCount-1,this.CalculateTotal(),this.$nextTick(function(){e.$refs["qual-check-table"].doLayout()})},DelColumn:function(e){var t=this;this.InsertCount-=1,this.TableData.forEach(function(a){0==a.HasChild&&(a.ItemScore.splice(e,1),(2!=t.scoreType&&2==t.scoreTypeSub||2==t.scoreType&&6==t.scoreTypeSub)&&a.ScoreToShow.splice(e,1))}),this.InsertHead.indexOf(1)>-1&&this.InsertHeadPat.splice(e,1),this.InsertHead.indexOf(2)>-1&&this.InsertHeadNur.splice(e,1),this.InsertHead.indexOf(3)>-1&&this.InsertHeadInput.splice(e,1),this.total.splice(e,1),this.$nextTick(function(){t.$refs["qual-check-table"].doLayout()})},GetPatName:function(e){var t=this.WardPatientStore.find(function(t){return t.PAPatMasId==e});return t?t.PatientName:""},GetNurName:function(e){var t=this.WardNurseStore.find(function(t){return t.Per==e});return t?t.PerName:""},Back:function(){var e=this,t=this.axiosConfig("web.INMQualControlComm","BackQualCheck","Method","id$"+this.params.ResultId);this.$ajax.request(t).then(function(t){e.DialogLoading=!1,1==t.data?(e.$emit("CloseDialog"),e.$emit("LoadCheckList"),e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"})):t.data.length<100?e.$message({type:"warning",message:t.data,showClose:!0,customClass:"warning_class"}):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}},created:function(){this.IsOverHlb=sessionStorage.getItem("loginRoleCodes").split(",").some(function(e){return"0"==e||"1"==e||"2"==e||"3"==e||"4"==e}),this.GetSchduleData(),this.LoadWardPatient(),this.LoadWardNurse(),this.Title=this.params.TaskItemDesc,"T"==this.params.TaskStatus?(this.CheckInfo.Date=new Date,this.params.TaskChecker&&this.params.TaskChecker.split(",").indexOf(sessionStorage.loginPerID)>-1||0==sessionStorage.loginID||""==this.params.TaskChecker?this.Editable=!0:this.Editable=!1,0==sessionStorage.loginID?this.CheckInfo.User="管理员":this.CheckInfo.User=sessionStorage.loginName):(sessionStorage.loginID!=this.params.TaskSubmitter&&0!=sessionStorage.loginID||"S"==this.params.TaskStatus?this.Editable=!1:this.Editable=!0,this.CheckInfo.User=this.params.TaskSubmitterName,this.CheckInfo.Date=new Date(this.params.TaskCheckDate)),this.CheckInfo.Ward=this.params.TaskWardDesc,this.CheckInfo.Score=this.params.TaskScore,this.CheckInfo.Status=this.params.TaskStatusDesc,this.CheckInfo.Remark=this.params.TaskRemark}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checkscore-print-panel",staticStyle:{overflow:"auto",color:"#000"},style:{height:e.Height+10+"px"},attrs:{id:"schduleprint"}},[a("div",{staticStyle:{"font-size":"14px","text-align":"center",margin:"10px 0"}},[e._v(e._s(e.Title))]),e._v(" "),a("div",{staticClass:"top-tool-table-dialog-top dialog-div-top-radius"},[a("el-form",{ref:"CheckInfo",staticClass:"printNone",attrs:{model:e.CheckInfo,inline:!0,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbs9nf3c0"),prop:"User"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.User,callback:function(t){e.$set(e.CheckInfo,"User",t)},expression:"CheckInfo.User"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq7qoc0"),prop:"Ward"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Ward,callback:function(t){e.$set(e.CheckInfo,"Ward",t)},expression:"CheckInfo.Ward"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq8wng0"),prop:"Date"}},[a("el-date-picker",{staticStyle:{width:"130px"},attrs:{disabled:!e.Editable,type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.CheckInfo.Date,callback:function(t){e.$set(e.CheckInfo,"Date",t)},expression:"CheckInfo.Date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq9vm40"),prop:"Score"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Score,callback:function(t){e.$set(e.CheckInfo,"Score",t)},expression:"CheckInfo.Score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsqauyo0"),prop:"Status"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Status,callback:function(t){e.$set(e.CheckInfo,"Status",t)},expression:"CheckInfo.Status"}})],1),e._v(" "),a("el-form-item",[a("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-print"},on:{click:e.Print}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqaw9g0")))]),e._v(" "),a("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-print"},on:{click:e.PrintWhite}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqawmo0")))])],1)],1)],1),e._v(" "),a("div",{staticClass:"printCheckInfo",staticStyle:{"font-size":"16px"},domProps:{innerHTML:e._s(e.$t("menu.NurQualCheckScore.5nrnbsqbor80")+e.CheckInfo.User+e.$t("menu.NurQualCheckScore.5nrnbsqc9ao0")+e.CheckInfo.Ward+e.$t("menu.NurQualCheckScore.5nrnbsqcr1w0")+(e.CheckInfo.Date instanceof Date?e.CheckInfo.Date.Format("YYYY-MM-dd"):"")+e.$t("menu.NurQualCheckScore.5nrnbsqd7sk0")+e.CheckInfo.Score+e.$t("menu.NurQualCheckScore.5ncy6l1t4nk0")+e.CheckInfo.Status)}}),e._v(" "),a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius",staticStyle:{overflow:"auto"}},[a("el-table",{ref:"qual-check-table",staticClass:"qual-check-score-table printNone",staticStyle:{width:"100%"},attrs:{data:e.TableData.filter(function(e){return 0==e.HasChild}),"span-method":e.QualSpan,height:e.Height-64-26-46-40-10-4,"show-summary":"","summary-method":e.GetSummary,"header-cell-style":e.headerCellFontWeight,border:e.styleCode}},[e._l(e.Deepth,function(t,s){return a("el-table-column",{key:s,attrs:{label:0==s?e.$t("menu.NurQualCheckScore.5nrnbsqfqa40"):"","column-key":"QualItem",fixed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e.TableData.find(function(e){return e.SubSort==a.row.SubSort.split(".").slice(0,t+1).join(".")}).SubItem))]}}],null,!0)})}),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("el-table-column",{attrs:{prop:"SubScore",label:e.$t("menu.NurQualCheckScore.5nrnbsqhzt80"),width:"80px",fixed:""}}):e._e(),e._v(" "),e._l(e.InsertCount,function(t,s){return a("el-table-column",{key:"score"+s,attrs:{"class-name":"qual-check-score-input-col",width:e.InsertHead.length>0?180:80},scopedSlots:e._u([{key:"header",fn:function(){return[e.InsertHead.indexOf(1)>-1?a("div",[a("el-select",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqiveo0"),clearable:"",size:"mini"},model:{value:e.InsertHeadPat[s],callback:function(t){e.$set(e.InsertHeadPat,s,t)},expression:"InsertHeadPat[index]"}},e._l(e.WardPatientStore,function(e){return a("el-option",{key:e.PAPatMasId,attrs:{label:e.PatientName,value:e.PAPatMasId}})}),1)],1):e._e(),e._v(" "),e.InsertHead.indexOf(2)>-1?a("div",[a("el-select",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqjpbc0"),clearable:"",size:"mini"},model:{value:e.InsertHeadNur[s],callback:function(t){e.$set(e.InsertHeadNur,s,t)},expression:"InsertHeadNur[index]"}},e._l(e.WardNurseStore,function(e){return a("el-option",{key:e.Per,attrs:{label:e.PerName,value:e.Per}})}),1)],1):e._e(),e._v(" "),e.InsertHead.indexOf(3)>-1?a("div",[a("el-input",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqkn100"),clearable:"",size:"mini"},model:{value:e.InsertHeadInput[s],callback:function(t){e.$set(e.InsertHeadInput,s,t)},expression:"InsertHeadInput[index]"}})],1):e._e(),e._v(" "),0==e.InsertHead.length?a("div",[e._v(e._s(4==e.scoreTypeSub?e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"):e.$t("menu.NurQualCheckScore.5nrnbsqlubs0")+t))]):e._e(),e._v(" "),a("el-button",0==s?{staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-circle-plus",size:"mini"},on:{click:e.AddColumn}}:{staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-remove",size:"mini"},on:{click:function(t){return e.DelColumn(s)}}})]},proxy:!0},{key:"default",fn:function(s){return[2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?a("input",{directives:[{name:"model",rawName:"v-model",value:s.row.ItemScore[t-1],expression:"scope.row['ItemScore'][insert-1]"}],staticStyle:{"text-align":"left"},attrs:{readonly:!e.Editable},domProps:{value:s.row.ItemScore[t-1]},on:{blur:function(a){return e.ChangeScore(s.row,t-1)},input:function(a){a.target.composing||e.$set(s.row.ItemScore,t-1,a.target.value)}}}):2==e.scoreType&&5==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,s.row,t-1,!1,!1)}}},[a("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(s.row.ItemScore[t-1]))])]):2==e.scoreType&&6==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,s.row,t-1,!1,!0)}}},[a("span",[e._v(e._s(s.row.ScoreToShow[t-1]))])]):2!=e.scoreType&&1==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,s.row,t-1,!1,!1)}}},[a("span",{staticStyle:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"}},[e._v(e._s(s.row.ItemScore[t-1]))])]):2!=e.scoreType&&2==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,s.row,t-1,!0,!1)}}},[a("span",[e._v(e._s(s.row.ScoreToShow[t-1]))])]):e._e()]}}],null,!0)})}),e._v(" "),1==e.params.Review?a("el-table-column",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsqp3gw0"),width:"180px",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:!t.row.NeedReview||"N"==t.row.NeedReview,size:"mini"},on:{change:function(a){return e.ReviewChange(t.row)}},model:{value:t.row.Review,callback:function(a){e.$set(t.row,"Review",a)},expression:"scope.row['Review']"}},e._l(t.row.ReviewMenu,function(e,t){return a("el-option",{key:"option"+t,attrs:{value:e.value,label:e.label}})}),1)]}}],null,!1,3216757719)}):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("el-table-column",{attrs:{"class-name":"qual-check-score-input-col",label:e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"),width:"70px",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.row.SubAccordScore,expression:"scope.row['SubAccordScore']"}],staticStyle:{"text-align":"left",padding:"0 10px"},attrs:{readonly:!e.Editable},domProps:{value:t.row.SubAccordScore},on:{blur:function(a){return e.ChangeScore2(t.row)},input:function(a){a.target.composing||e.$set(t.row,"SubAccordScore",a.target.value)}}})]}}],null,!1,678372833)}):e._e(),e._v(" "),2==e.scoreTypeSub?e._l(e.Deepth,function(t,s){return a("el-table-column",{key:"Accord"+s,attrs:{label:0==s?e.$t("menu.NurQualCheckScore.5nrnbsqqn740"):"","column-key":"AccordPercent"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e.Deepth-t+1==a.row.SubSort.split(".").length-1?e.CalculateScore(a.row.ItemScore):e.Deepth-t+1>a.row.SubSort.split(".").length-1?"":e.CalculateFatherScore(a.row.SubSort.split(".").slice(0,e.Deepth-t+1+1+1).join("."))))]}}],null,!0)})}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"Remark","class-name":"qual-check-score-input-col",label:e.$t("menu.NurQualCheckScore.5nrnbsqsewg0"),"min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.row.Remark,expression:"scope.row['Remark']"}],attrs:{readonly:!e.Editable},domProps:{value:t.row.Remark},on:{input:function(a){a.target.composing||e.$set(t.row,"Remark",a.target.value)}}})]}}])})],2),e._v(" "),a("table",{staticClass:"printCheckInfo",staticStyle:{width:"100%","border-collapse":"collapse",border:"1px solid #EBEEF5"},attrs:{cellspacing:"0",cellpadding:"0"}},[a("thead",[a("tr",{staticStyle:{"background-color":"#F5F7FA",color:"#101010"}},[a("th",{staticStyle:{"min-width":"300px"},style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqfqa40")))]),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("th",{staticStyle:{"min-width":"60px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqhzt80")))]):e._e(),e._v(" "),e._l(e.InsertCount,function(t,s){return a("th",{key:t,style:e.TdStyle},[e.InsertHead.indexOf(1)>-1?a("div",[a("el-select",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqiveo0"),clearable:"",size:"mini"},model:{value:e.InsertHeadPat[s],callback:function(t){e.$set(e.InsertHeadPat,s,t)},expression:"InsertHeadPat[index]"}},e._l(e.WardPatientStore,function(e){return a("el-option",{key:e.PAPatMasId,attrs:{label:e.PatientName,value:e.PAPatMasId}})}),1),e._v(" "),a("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.GetPatName(e.InsertHeadPat[s])))])],1):e._e(),e._v(" "),e.InsertHead.indexOf(2)>-1?a("div",[a("el-select",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqjpbc0"),clearable:"",size:"mini"},model:{value:e.InsertHeadNur[s],callback:function(t){e.$set(e.InsertHeadNur,s,t)},expression:"InsertHeadNur[index]"}},e._l(e.WardNurseStore,function(e){return a("el-option",{key:e.Per,attrs:{label:e.PerName,value:e.Per}})}),1),e._v(" "),a("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.GetNurName(e.InsertHeadNur[s])))])],1):e._e(),e._v(" "),e.InsertHead.indexOf(3)>-1?a("div",[a("el-input",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqkn100"),clearable:"",size:"mini"},model:{value:e.InsertHeadInput[s],callback:function(t){e.$set(e.InsertHeadInput,s,t)},expression:"InsertHeadInput[index]"}}),e._v(" "),a("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.InsertHeadInput[s]))])],1):e._e(),e._v(" "),0==e.InsertHead.length?a("span",[e._v(e._s(4==e.scoreTypeSub?e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"):e.$t("menu.NurQualCheckScore.5nrnbsqlubs0")+t))]):e._e(),e._v(" "),a("el-button",0==s?{staticClass:"printNone",staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-circle-plus",size:"mini"},on:{click:e.AddColumn}}:{staticClass:"printNone",staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-remove",size:"mini"},on:{click:function(t){return e.DelColumn(s)}}})],1)}),e._v(" "),1==e.params.Review?a("th",{style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqp3gw0")))]):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("th",{style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsql8hc0")))]):e._e(),e._v(" "),2==e.scoreTypeSub?a("th",{staticStyle:{"min-width":"100px"},style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqqn740")))]):e._e(),e._v(" "),a("th",{staticStyle:{"min-width":"120px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqsewg0")))])],2)]),e._v(" "),a("tbody",[e._l(e.TableData,function(t,s){return[0==t.HasChild?a("tr",{key:"item"+s},[e._l(t.Roots,function(t,s){return[a("td",{key:s,style:e.TdStyle,attrs:{rowspan:e.GetFatherRowSpan(t)}},e._l(e.GetFatherDesc(t).split("「"),function(t,s){return a("li",{key:s,staticStyle:{"list-style-type":"none"}},[e._v("\n                                    "+e._s(t)+"\n                                ")])}),0)]}),e._v(" "),a("td",{style:e.TdStyle,attrs:{colspan:e.Deepth-t.SubSort.split(".").length+2}},e._l(t.SubItem.split("「"),function(t,s){return a("li",{key:s,staticStyle:{"list-style-type":"none"}},[e._v("\n                                "+e._s(t)+"\n                            ")])}),0),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(t.SubScore))]):e._e(),e._v(" "),e._l(e.InsertCount,function(s){return a("td",{key:"score"+s,staticStyle:{position:"relative",overflow:"hidden"},style:[e.TdStyle,{width:2==e.scoreTypeSub?"200px":"120px"}],attrs:{align:"center"}},[2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?a("div",{staticClass:"printCheckInfo",staticStyle:{"text-align":"center",border:"none"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[s-1]))]):e._e(),e._v(" "),2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?a("input",{directives:[{name:"model",rawName:"v-model",value:t.ItemScore[s-1],expression:"item['ItemScore'][InsertIndex-1]"}],staticClass:"printNone",staticStyle:{width:"100%",height:"100%","text-align":"center",border:"none"},attrs:{readonly:!e.Editable},domProps:{value:t.ItemScore[s-1]},on:{blur:function(a){return e.ChangeScore(t,s-1)},input:function(a){a.target.composing||e.$set(t.ItemScore,s-1,a.target.value)}}}):2==e.scoreType&&5==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,t,s-1,!1,!1)}}},[a("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[s-1]))])]):2==e.scoreType&&6==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,t,s-1,!1,!0)}}},[a("span",[e._v(e._s(e.PrintWhiteFlag?"":t.ScoreToShow[s-1]))])]):2!=e.scoreType&&1==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,t,s-1,!1,!1)}}},[a("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[s-1]))])]):2!=e.scoreType&&2==e.scoreTypeSub?a("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(a){return e.CellClickEvent(a,t,s-1,!0,!1)}}},[a("span",[e._v(e._s(e.PrintWhiteFlag?"":t.ScoreToShow[s-1]))])]):e._e()])}),e._v(" "),1==e.params.Review?a("td",{staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[a("el-select",{staticClass:"printNone",attrs:{disabled:!t.NeedReview||"N"==t.NeedReview,size:"mini"},on:{change:function(a){return e.ReviewChange(t)}},model:{value:t.Review,callback:function(a){e.$set(t,"Review",a)},expression:"item.Review"}},e._l(t.ReviewMenu,function(e,t){return a("el-option",{key:"option"+t,attrs:{value:e.value,label:e.label}})}),1),e._v(" "),a("div",{staticClass:"printCheckInfo",staticStyle:{"text-align":"center"}},[e._v(e._s(t.ReviewDesc))])],1):e._e(),e._v(" "),2==e.scoreTypeSub?["Y"==e.CheckScoreFlag?a("td",{staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[a("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.PrintWhiteFlag?"":t.SubAccordScore))]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.SubAccordScore,expression:"item['SubAccordScore']"}],staticClass:"printNone",staticStyle:{width:"100%",height:"100%","text-align":"center",border:"none"},attrs:{readonly:!e.Editable},domProps:{value:t.SubAccordScore},on:{blur:function(a){return e.ChangeScore2(t)},input:function(a){a.target.composing||e.$set(t,"SubAccordScore",a.target.value)}}})]):e._e(),e._v(" "),a("td",{staticStyle:{width:"70px"},style:e.TdStyle,attrs:{colspan:e.Deepth-t.SubSort.split(".").length+2}},[e._v(e._s(e.PrintWhiteFlag?"":e.CalculateScore(t.ItemScore)))]),e._v(" "),e._l(e.GetReverseRoots(t.Roots),function(t,s){return[a("td",{key:s+"-",staticStyle:{width:"70px"},style:e.TdStyle,attrs:{rowspan:e.GetFatherRowSpan(t)}},[e._v("\n                                    "+e._s(e.PrintWhiteFlag?"":e.CalculateFatherScore(t))+"\n                                ")])]})]:e._e(),e._v(" "),a("td",{directives:[{name:"dragMove",rawName:"v-dragMove"}],staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[a("p",{staticClass:"printCheckInfo",staticStyle:{width:"120px","word-break":"break-all","word-wrap":"break-word"}},[e._v(e._s(e.PrintWhiteFlag?"":t.Remark))]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Remark,expression:"item['Remark']"}],staticClass:"printNone",staticStyle:{border:"none",width:"99%",height:"100%",resize:"vertical"},attrs:{readonly:!e.Editable},domProps:{value:t.Remark},on:{input:function(a){a.target.composing||e.$set(t,"Remark",a.target.value)}}})])],2):e._e()]}),e._v(" "),a("tr",{staticStyle:{"background-color":"#F5F7FA"}},[a("td",{style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s("合计"))]),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.CheckAccordScoreSum))]):e._e(),e._v(" "),e._l(e.total,function(t,s){return a("td",{key:s,style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":t))])}),e._v(" "),1==e.params.Review?a("td",{style:e.TdStyle}):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?a("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.CheckAccordScore))]):e._e(),e._v(" "),2==e.scoreTypeSub?a("td",{style:e.TdStyle,attrs:{colspan:e.Deepth,align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.Score))]):e._e(),e._v(" "),a("td",{style:e.TdStyle})],2)],2)])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"printCheckInfo",staticStyle:{border:"1px solid black","border-top":"0","min-height":"100px"}},[e._v(e._s(e.CheckInfo.Remark))]),e._v(" "),a("el-input",{staticClass:"printNone",attrs:{disabled:!e.Editable,type:"textarea",size:"small",maxlength:1e3,"show-word-limit":"",rows:2},model:{value:e.CheckInfo.Remark,callback:function(t){e.$set(e.CheckInfo,"Remark",t)},expression:"CheckInfo.Remark"}})],1),e._v(" "),a("div",{staticClass:"printNone bottom-button"},[e.params.Review?e._e():a("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Save,time:500,status:"N"},expression:"{func:Save,time:500,status:'N'}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode,disabled:!e.Editable}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr06gg0")))]),e._v(" "),e.params.Review?e._e():a("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Save,time:500,status:"S"},expression:"{func:Save,time:500,status:'S'}"}],staticStyle:{width:"120px"},attrs:{type:"default",styleCode:e.styleCode,disabled:!e.Editable}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07700")))]),e._v(" "),e.params.Review?e._e():a("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Back,time:500},expression:"{func:Back,time:500}"}],attrs:{type:"default",styleCode:e.styleCode,disabled:!e.IsOverHlb||"S"!=e.params.TaskStatus}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07jg0")))]),e._v(" "),1==e.params.Review?a("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveReview,time:500},expression:"{func:SaveReview,time:500}"}],attrs:{type:"default",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr06gg0")))]):e._e(),e._v(" "),a("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.$emit("CloseDialog")}}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07zg0")))])],1),e._v(" "),a("vue-context-menu",{ref:"cellContextMenu",attrs:{contextMenuData:e.contextMenuData},on:{MarkScore:e.MarkScore,change:e.HandleCountChange,checkChange:e.HandleCheckChange}})],1)},staticRenderFns:[]};var h=a("VU/8")(c,u,!1,function(e){a("nMRI")},null,null);t.default=h.exports}});