webpackJsonp([287],{oVX2:function(e,t){},uh17:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("mvHQ"),i=s.n(o),a=s("woOf"),n=s.n(a),r=s("Dd8w"),m=s.n(r),l=s("NYxO"),d={name:"FormDesignModal",components:{hgbutton:s("XlQt").default},data:function(){return{commonApi:{config:{method:"post",url:this.apiUrl,headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest",Authorization:this.getCookie("cspUsername")},data:"",withCredentials:!0,crossDomain:!0},nameKey:"PropertyName",labelKey:"PropertyDesc"},fieldListApi:{},optionListApi:{},oneOptionApi:{},form:{},api:{list:{ClassName:"web.INMLCDPComm",MethodName:"FindDataBySql",MethodType:"JsonQuery"},fields:{ClassName:"web.INMLCDPComm",MethodName:"FindDataBySqlMultiple",MethodType:"JsonMethod"},mulList:{ClassName:"web.INMLCDPComm",MethodName:"FindDataBySqlMultiple",MethodType:"JsonMethod"},get:{ClassName:"web.INMLCDPComm",MethodName:"GetForm",MethodType:"Method"},save:{ClassName:"web.INMLCDPComm",MethodName:"SaveForm",MethodType:"LongMethod"}},apiUrl:""}},created:function(){this.getApiUrl(),this.loadFormJson(),this.assemblePropsParam(),this.assembleDictParam()},mounted:function(){},computed:m()({},Object(l.b)(["LoginId","styleCode"])),props:{classId:{type:[String,Number]}},methods:{assemblePropsParam:function(){var e={Parref:this.classId},t=n()({},this.api.mulList,{className:"CT.DHCINM.LCDP.MgProperty",conditions:[{prop:"Parref",operator:"=",model:"Parref"}],array:e,nurseId:this.LoginId,start:0,end:1e4});this.fieldListApi.config=this.axiosConfigForObject(t),this.fieldListApi.config.url=this.apiUrl,this.fieldListApi.config.data=this.$qs.stringify(t),this.fieldListApi.nameKey="PropertyName",this.fieldListApi.labelKey="PropertyDesc"},assembleDictParam:function(){var e=n()({},this.api.list,{className:"CT.DHCINM.LCDP.MgAPI",nurseId:this.LoginId,start:0,end:1e4});this.optionListApi={param:e,nameKey:"RowId",labelKey:"APIMethodDesc"};this.oneOptionApi={param:{ClassName:"web.INMLCDPComm",MethodName:"GetAPI",MethodType:"JsonMethod"}}},assembleOneDictApi:function(){this.fieldListApi=this.deepClone(this.commonApi);var e=n()({},{ClassName:"web.INMLCDPComm",MethodName:"GetAPI",MethodType:"JsonMethod"},{id:"1"});this.fieldListApi.config.url=this.apiUrl,this.fieldListApi.config.data=this.$qs.stringify(e)},getApiUrl:function(){var e="";e="/"+window.location.pathname.split("/")[1]+"/web/csp/dhc.nursemg.four.getdata.csp",this.apiUrl=e},loadFormJson:function(){var e=this,t=n()({},this.api.get,{classDR:this.classId});this.asyncRequest(t).then(function(t){var s=t.data,o=s.FormJson||"{}";o=o.replace(/☼/g,'"'),e.form.FormJson=JSON.parse(o),e.form.RowId=s.RowId||"",e.$nextTick(function(){e.$refs.vFormDesigner.setFormJson(e.form.FormJson)});!function t(){e.$refs.vFormDesigner?e.$refs.vFormDesigner.setFormJson(e.form.FormJson):setTimeout(t,100)}()})},saveFormJson:function(){var e=this,t=this.form.RowId,s=i()(this.$refs.vFormDesigner.getFormJson()).replace(/\"/g,"☼"),o=this.classId,a=n()({},this.api.save,{rowId:t,formJson:s,classDR:o});this.asyncRequest(a).then(function(t){t.data>0?(e.nurMessage.success("保存表单配置数据成功"),e.$emit("close")):e.nurMessage.error("保存表单配置数据错误")})}}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-form-designer",{ref:"vFormDesigner",staticClass:"form-design-modal",attrs:{"field-list-api":e.fieldListApi,"option-list-api":e.optionListApi,"one-option-api":e.oneOptionApi,"api-url":e.apiUrl},scopedSlots:e._u([{key:"customToolButtons",fn:function(){return[s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-save":"nm-icon-lite-save"},on:{click:e.saveFormJson}},[e._v("保存设计")])]},proxy:!0}])})},staticRenderFns:[]};var c=s("VU/8")(d,p,!1,function(e){s("oVX2")},null,null);t.default=c.exports}});