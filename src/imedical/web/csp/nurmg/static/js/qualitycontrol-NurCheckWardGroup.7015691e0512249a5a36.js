webpackJsonp([294],{"2VC3":function(e,t){},sg1A:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Dd8w"),r=o.n(s),a=o("NYxO"),n=o("XlQt"),l={components:{hgpanel:o("z8xk").default,Hgbutton:n.default},name:"NurCheckWardGroup",computed:r()({},Object(a.b)(["Height","styleCode"])),data:function(){return{WardTool:{CheckType:""},QualTypeStore:[],ElRowStyle:{height:"20px"},CheckWardStore:[],GroupWardStore:[],GroupTypes:[],LeftSelection:[],RightSelection:[],DialogVisible:!1,EditForm:{name:""},EditRules:{name:[{required:!0,message:"组名不为空",trigger:"blur"}]},AreaData:[],CheckFinds:{area:"",input:""},GroupFinds:{area:"",input:"",grouptype:""},LastSelection:[]}},methods:{LoadCheckPlanType:function(){var e=this,t=this,o=t.axiosConfig("web.INMQualControlComm","FindQualTypeList","RecQuery","type$N");t.$ajax.request(o).then(function(o){o.data instanceof Object?(t.QualTypeStore=o.data.rows,t.QualTypeStore instanceof Array&&t.QualTypeStore.length>0&&(t.WardTool.CheckType=t.QualTypeStore[0].rw),e.CheckTypeChange()):t.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})})},GetAreaData:function(){var e=this,t=e.axiosConfig("web.INMDBComm","FindWardAreaList","RecQuery","parr$Y");e.$ajax.request(t).then(function(t){t.data instanceof Object?e.AreaData=t.data.rows:e.$message({type:"error",message:"获取系统片区列表失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取系统片区列表失败",showClose:!0,customClass:"error_class"})})},CheckTypeChange:function(){this.LoadCheckWard(),this.LoadGroupTypes()},LoadCheckWard:function(){var e=this,t=e.CheckFinds.area,o=e.CheckFinds.input,s=e.WardTool.CheckType;s?(e.CheckWardStore=new Array,e.$ajax.request(e.axiosConfig("web.INMQualControlComm","FindCheckWardForTypeList","RecQuery","type$"+s,"area$"+t,"input$"+o,"flag$1")).then(function(t){t.data instanceof Object?e.CheckWardStore=t.data.rows:e.$message({type:"error",message:"获取检查病区列表失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取检查病区列表失败",showClose:!0,customClass:"error_class"})})):e.$message({type:"warning",message:"类型未取到,请刷新页面",showClose:!0,customClass:"warning_class"})},LoadGroupTypes:function(){var e=this,t=e.WardTool.CheckType;t?(e.GroupTypes=[],e.GroupWardStore=[],e.GroupFinds.grouptype="",e.$ajax.request(e.axiosConfig("web.INMQualControlComm","FindWardGroupList","RecQuery","type$"+t,"parr$")).then(function(t){t.data instanceof Object?(e.GroupTypes=t.data.rows,e.GroupTypes instanceof Array&&0!=e.GroupTypes.length&&(e.GroupFinds.grouptype=e.GroupTypes[0].rw,e.LoadGroupWard())):e.$message({type:"error",message:"获取检查病区分组失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取检查病区分组失败",showClose:!0,customClass:"error_class"})})):e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},LoadGroupWard:function(e){var t=this,o=t.GroupFinds.area,s=t.GroupFinds.input,r=t.GroupFinds.grouptype,a=t.WardTool.CheckType;a?(t.GroupWardStore=[],t.$ajax.request(t.axiosConfig("web.INMQualControlComm","FindCheckWardForTypeList","RecQuery","type$"+a,"area$"+o,"input$"+s,"group$"+r,"flag$2")).then(function(o){o.data instanceof Object?(t.GroupWardStore=o.data.rows,e&&t.$nextTick(function(){t.LastSelection.forEach(function(e){var o=t.GroupWardStore.find(function(t){return e.RowID==t.RowID});o&&t.$refs.GroupWardStore.toggleRowSelection(o,!0)})})):t.$message({type:"error",message:"获取分组病区失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取分组病区失败",showClose:!0,customClass:"error_class"})})):t.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},IsSelectAble:function(e,t){var o=0;return 1==e.ableSelect&&(o=1),o},LeftSelectionChange:function(e){this.LeftSelection=e},GroupSelectionChange:function(e){this.RightSelection=e},CheckRowClick:function(e){1==e.ableSelect&&this.$refs.CheckWardStore.toggleRowSelection(e)},GroupRowClick:function(e){this.$refs.GroupWardStore.toggleRowSelection(e)},AddGroup:function(){var e=this;this.DialogVisible=!0,this.$nextTick(function(){e.EditForm.name="",e.$refs.EditForm.clearValidate()})},SaveGroup:function(){var e=this;e.$refs.EditForm.validate(function(t){if(t){var o=e.EditForm.name;if(/[`~!@#$%^&*()_+<>?:"{},.\/;'[\]]/im.test(o)||/[·！#￥（——）：；“”‘、，|《。》？、【】[\]]/im.test(o))return e.$message({type:"warning",message:"组名不能包含特殊字符.",showClose:!0,customClass:"warning_class"}),!1;o=(o=o.replace(/(^\s*)|(\s*$)/g,"")).toUpperCase(),e.GroupTypes.push({rw:o,desc:o}),e.GroupFinds.grouptype=o,e.GroupWardStore=[],e.DialogVisible=!1}})},DeleteGroup:function(){var e=this,t=e.WardTool.CheckType;if(t){var o=e.GroupFinds.grouptype;o?e.$confirm("此操作将删除该组所有关联病区, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",closeOnClickModal:!1,type:"warning"}).then(function(){e.$ajax.request(e.axiosConfig("web.INMQualControlComm","RemoveCheckGroup","Method","type$"+t,"group$"+o)).then(function(t){1==t.data?(e.$message({type:"success",message:"删除成功",showClose:!0,customClass:"success_class"}),e.CheckTypeChange()):e.$message({type:"error",message:"删除失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"删除失败",showClose:!0,customClass:"error_class"})})}).catch(function(t){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):e.$message({type:"warning",message:"请选择要删除的组",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},MoveLeft:function(){var e=this,t=e.WardTool.CheckType;if(t){var o=e.GroupFinds.grouptype;if(o){var s=e.RightSelection.map(function(e){return e.RowID}).join("^");s?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","RemoveCheckGroup","Method","type$"+t,"group$"+o,"checkid$"+s)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),e.CheckTypeChange()):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择分组病区",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择要删除的组",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择类型",showClose:!0,customClass:"warning_class"})},MoveRight:function(){var e=this,t=e.WardTool.CheckType,o=e.GroupFinds.grouptype;if(t)if(o){var s=e.LeftSelection.map(function(e){return e.RowID}).join("^");s?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","AddGroupWard","Method","type$"+t,"group$"+o,"checkid$"+s)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),e.CheckTypeChange()):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择检查病区",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择分组",showClose:!0,customClass:"warning_class"});else e.$message({type:"warning",message:"请选择类型",showClose:!0,customClass:"warning_class"})},MoveRec:function(e){var t=this;if(t.RightSelection&&0!=t.RightSelection.length){t.RightSelection.sort(function(e,t){return e.WardGroupSort-t.WardGroupSort}),"D"==e&&t.RightSelection.reverse();for(var o="",s=0;s<t.RightSelection.length;s++){var r=t.RightSelection[s];if(1==r.WardGroupSort&&"U"==e)return void t.$message({type:"warning",message:"当前记录已在最上方，不可上移",showClose:!0,customClass:"warning_class"});if(t.GroupWardStore.indexOf(r)==t.GroupWardStore.length-1&&"D"==e)return void t.$message({type:"warning",message:"当前记录已在最下方，不可下移",showClose:!0,customClass:"warning_class"});o=""==o?r.RowID:o+","+r.RowID}t.LastSelection=t.RightSelection,t.$ajax.request(t.axiosConfig("web.INMQualControlComm","MoveGroupWard","Method","type$"+e,"parr$"+o)).then(function(e){1==e.data?t.LoadGroupWard(!0):t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}else t.$message({type:"warning",message:"请选择要移动的行",showClose:!0,customClass:"warning_class"})}},created:function(){this.LoadCheckPlanType(),this.GetAreaData()}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"checkward-group-panel"},[o("div",{staticClass:"top-tool-inputDiv"},[o("el-form",{attrs:{model:e.WardTool,inline:!0}},[o("el-form-item",{attrs:{label:e.$t("menu.NurCheckWardGroup.5nrnbreuyg80")}},[o("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"",size:"mini"},on:{change:e.CheckTypeChange},model:{value:e.WardTool.CheckType,callback:function(t){e.$set(e.WardTool,"CheckType",t)},expression:"WardTool.CheckType"}},e._l(e.QualTypeStore,function(e){return o("el-option",{key:e.rw,attrs:{value:e.rw,label:e.SubDesc}})}),1)],1)],1)],1),e._v(" "),o("div",[o("el-row",{staticStyle:{padding:"10px 12px 10px 10px"}},[o("el-col",{attrs:{span:9}},[o("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurCheckWardGroup.5nrnbrewx400"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[o("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[o("el-form",{attrs:{model:e.CheckFinds,inline:!0}},[o("el-form-item",[o("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",clearable:"",placeholder:e.$t("menu.NurCheckWardGroup.5nrnbreylj80"),size:"mini"},on:{change:e.LoadCheckWard},model:{value:e.CheckFinds.area,callback:function(t){e.$set(e.CheckFinds,"area",t)},expression:"CheckFinds.area"}},e._l(e.AreaData,function(e){return o("el-option",{key:e.rw,attrs:{value:e.rw,label:e.AreaDesc}})}),1)],1),e._v(" "),o("el-form-item",[o("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini","suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search",placeholder:e.$t("menu.NurCheckWardGroup.5nrnbrf0d9w0")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadCheckWard(t)}},model:{value:e.CheckFinds.input,callback:function(t){e.$set(e.CheckFinds,"input",t)},expression:"CheckFinds.input"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"top-tool-table"},[o("el-table",{ref:"CheckWardStore",staticStyle:{width:"100%","border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.CheckWardStore,height:e.styleCode?e.Height-169:e.Height-167,"header-cell-style":e.headerCellFontWeight,"row-style":e.ElRowStyle,"highlight-current-row":!0,border:e.styleCode},on:{"selection-change":e.LeftSelectionChange,"row-click":e.CheckRowClick}},[o("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{type:"selection",width:"40",align:"center",selectable:e.IsSelectAble}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.NurCheckWardGroup.5nrnbrf23io0"),prop:"WardDesc","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.NurCheckWardGroup.5ncy6klzcuc0"),prop:"WardGroup",width:"100","show-overflow-tooltip":""}})],1)],1)])],1),e._v(" "),o("el-col",{attrs:{span:2}},[o("div",{staticClass:"bottom-button",staticStyle:{width:"100%",margin:"0 auto"},style:{height:e.Height-67+"px"}},[o("div",{staticStyle:{"text-align":"center","padding-bottom":"20px"},style:{"padding-top":(e.Height-107)/2+"px"}},[o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.LeftSelection||0==e.LeftSelection.length},on:{click:function(t){return e.MoveRight()}}},[o("i",{class:e.styleCode?"el-icon-arrow-right":"nm-icon-lite-right-arrow"})])],1),e._v(" "),o("div",[o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.RightSelection||0==e.RightSelection.length},on:{click:function(t){return e.MoveLeft()}}},[o("i",{class:e.styleCode?"el-icon-arrow-left":"nm-icon-lite-left-arrow"})])],1)])]),e._v(" "),o("el-col",{attrs:{span:13}},[o("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurCheckWardGroup.5ncy6klzf9s0"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[o("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[o("el-form",{attrs:{model:e.GroupFinds,inline:!0}},[o("el-form-item",[o("el-select",{staticStyle:{width:"90px"},attrs:{filterable:"",clearable:"",placeholder:e.$t("menu.NurCheckWardGroup.5nrnbreylj80"),size:"mini"},on:{change:e.LoadGroupWard},model:{value:e.GroupFinds.area,callback:function(t){e.$set(e.GroupFinds,"area",t)},expression:"GroupFinds.area"}},e._l(e.AreaData,function(e){return o("el-option",{key:e.rw,attrs:{value:e.rw,label:e.AreaDesc}})}),1)],1),e._v(" "),o("el-form-item",[o("el-input",{staticStyle:{width:"90px"},attrs:{placeholder:e.$t("menu.NurCheckWardGroup.5nrnbrf4p0k0"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadGroupWard(t)}},model:{value:e.GroupFinds.input,callback:function(t){e.$set(e.GroupFinds,"input",t)},expression:"GroupFinds.input"}})],1),e._v(" "),o("el-form-item",[o("el-select",{staticStyle:{width:"90px"},attrs:{filterable:"",placeholder:e.$t("menu.NurCheckWardGroup.5nrnbrf5qq80"),size:"mini"},on:{change:e.LoadGroupWard},model:{value:e.GroupFinds.grouptype,callback:function(t){e.$set(e.GroupFinds,"grouptype",t)},expression:"GroupFinds.grouptype"}},e._l(e.GroupTypes,function(e){return o("el-option",{key:e.rw,attrs:{label:e.desc,value:e.rw}})}),1)],1),e._v(" "),o("el-form-item",[o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:e.AddGroup}},[e._v("+")]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:e.DeleteGroup}},[e._v("-")]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.MoveRec("U")}}},[e._v("↑")]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.MoveRec("D")}}},[e._v("↓")])],1)],1)],1),e._v(" "),o("div",{staticClass:"top-tool-table"},[o("el-table",{ref:"GroupWardStore",staticStyle:{width:"100%","border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.GroupWardStore,height:e.styleCode?e.Height-169:e.Height-167,"header-cell-style":e.headerCellFontWeight,"row-style":e.ElRowStyle,"highlight-current-row":!0,border:e.styleCode},on:{"selection-change":e.GroupSelectionChange,"row-click":e.GroupRowClick}},[o("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.NurCheckWardGroup.5nrnbrf23io0"),prop:"WardDesc","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.NurCheckWardGroup.5ncy6klzcuc0"),prop:"WardGroup",width:"100","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.NurCheckWardGroup.5ncy6klzlb00"),prop:"WardGroupSort","show-overflow-tooltip":"",width:"65",align:"center"}})],1)],1)])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.$t("menu.NurCheckWardGroup.5nrnbrf7y280"),visible:e.DialogVisible,width:"300px","close-on-click-modal":!1,modal:"",align:"center"},on:{"update:visible":function(t){e.DialogVisible=t}}},[o("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?o("i",{staticClass:"nm-icon-w-plus"}):e._e(),e._v(" "),o("span",[e._v(e._s(e.$t("menu.NurCheckWardGroup.5nrnbrf7y280")))])]),e._v(" "),o("el-form",{ref:"EditForm",attrs:{model:e.EditForm,rules:e.EditRules,"label-width":"64px",inline:!0,"label-position":"right",align:"left"}},[o("el-form-item",{attrs:{label:e.$t("menu.NurCheckWardGroup.5nrnbrfbabk0"),prop:"name"}},[o("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:e.$t("menu.NurCheckWardGroup.5nrnbrfce0k0")},model:{value:e.EditForm.name,callback:function(t){e.$set(e.EditForm,"name",t)},expression:"EditForm.name"}})],1)],1),e._v(" "),o("div",{staticClass:"bottom-button"},[o("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode},on:{click:e.SaveGroup}},[e._v(e._s(e.$t("menu.NurCheckWardGroup.5nrnbrfcfgg0")))]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.DialogVisible=!1}}},[e._v(e._s(e.$t("menu.NurCheckWardGroup.5nrnbrfcft00")))])],1)],1)],1)},staticRenderFns:[]};var c=o("VU/8")(l,i,!1,function(e){o("2VC3")},null,null);t.default=c.exports}});