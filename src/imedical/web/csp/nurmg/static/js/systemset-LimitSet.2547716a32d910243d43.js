webpackJsonp([175],{DVHB:function(e,t){},FfE4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Gu7T"),n=a.n(l),c=a("mvHQ"),i=a.n(c),s=a("Dd8w"),h=a.n(s),o=a("NYxO"),r=a("XlQt"),d=a("W5Fe"),u=a("doZQ"),f={components:{hgbutton:r.default,hgpagination:d.default,hgswitch:u.default},computed:h()({},Object(o.b)(["Height","styleCode"])),data:function(){return{selectAll:!1,selectAllShow:!0,isAccordion:!0,activeNames:[],isCollapse:!1,scrollTop:0,MenuData:[],OrigalMenuData:[],ElementData:[],RoleData:[],checkedVal:[],finds:{role:""},defaultProps:{children:"children",label:"label",id:"id"}}},created:function(){this.loadMenuData(""),this.getRoleData()},methods:{selectAllEvent:function(e){if(e){for(var t=0;t<this.MenuData.length;t++)for(var a=0;a<this.MenuData[t].chd.length;a++)if(this.MenuData[t].chd[a].chk=!0,this.MenuData[t].chd[a].checkAll=!0,this.MenuData[t].chd[a].inCheckAll=!1,this.MenuData[t].chd[a].chd){this.MenuData[t].chd[a].ckall=[];for(var l=0;l<this.MenuData[t].chd[a].chd.length;l++)this.MenuData[t].chd[a].ckall.push(this.MenuData[t].chd[a].chd[l].id)}}else this.MenuData=JSON.parse(i()(this.OrigalMenuData))},roleSelectEvemt:function(e){var t=e;this.selectAllShow=!t,this.selectAll=!1,this.loadMenuData(t)},loadMenuData:function(e){var t=this;e=e||"",t.$ajax.request(t.axiosConfig("web.INMSetComm","GetRoleMenuData","Method","role$"+e)).then(function(e){t.stringConvertObj("MenuData",e.data),t.OrigalMenuData=JSON.parse(i()(t.MenuData))})},stringConvertObj:function(e,t){for(var a=[].concat(n()(t)),l=a.length,c=0;c<l;c++){a[c];for(var i=a[c].chd,s=i.length,h=0;h<s;h++){var o,r;o=i[h].ckall?i[h].ckall.length:0,0!==(r=i[h].chd?i[h].chd.length:0)||i[h].chk?(a[c].chd[h].checkAll=o===r,a[c].chd[h].inCheckAll=o>0&&o<r):(a[c].chd[h].checkAll=!1,a[c].chd[h].inCheckAll=!1)}}this[e]=a},switchChange:function(e,t){e?t.fatherId&&this.SetFatherCheck(t.fatherId):(t.ckall=new Array,t.inCheckAll=!1,t.checkAll=!1,1==t.isFather&&this.SetChildNoCheck(t.id))},SetChildNoCheck:function(e){for(var t=this.MenuData.length,a=0;a<t;a++){this.MenuData[a];for(var l=this.MenuData[a].chd,n=l.length,c=0;c<n;c++)l[c].fatherId==e&&(this.MenuData[a].chd[c].chk=!1,this.MenuData[a].chd[c].ckall=new Array,this.MenuData[a].chd[c].inCheckAll=!1,this.MenuData[a].chd[c].checkAll=!1,1==!!l[c].isFather&&this.SetChildNoCheck(l[c].id))}},SetFatherCheck:function(e){for(var t=this.MenuData.length,a=0;a<t;a++){this.MenuData[a];for(var l=this.MenuData[a].chd,n=l.length,c=0;c<n;c++)l[c].id==e&&(this.MenuData[a].chd[c].chk=!0,l[c].fatherId&&this.SetFatherCheck(l[c].fatherId))}},handleCheckAllChange:function(e,t){if(t.ckall=new Array,e)for(var a=0;a<t.chd.length;a++)t.ckall.push(t.chd[a].id);else t.ckall=new Array;t.inCheckAll=!1},handleCheckedChange:function(e,t){var a=e.length;t.checkAll=a===t.chd.length,t.inCheckAll=a>0&&a<t.chd.length},getRoleData:function(){var e=this,t=e.axiosConfig("web.INMSetComm","FindRoleList","RecQuery");this.$ajax.request(t).then(function(t){e.RoleData=t.data.rows})},saveClick:function(e){var t=this,a=t.finds.role;if(a){var l=t.MenuData;if(!l||l<=0)t.$message({type:"warning",message:"无数据保存!",showClose:!0,customClass:"warning_class"});else for(var n=l.length,c=0;c<l.length;c++){for(var i,s=l[c],h="",o=s.chd,r=0;r<o.length;r++){var d=o[r],u="";d.ckall&&d.ckall.length>0&&(u=d.ckall.join("~")),d.chk&&(h=""!=h?h+"@MenuID|"+d.id+"^Elements|"+u+"^rw|":"MenuID|"+d.id+"^Elements|"+u+"^rw|")}i="RoleID|"+a+"^MoudID|"+s.id+"^RowID|",t.$ajax.request(t.axiosConfig("web.INMSetComm","SaveLimitMoud","Method","parr$"+i,"str$"+h,"index$"+c)).then(function(e){e.data==n-1&&(t.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}),t.loadMenuData(t.finds.role))})}}else t.$message({type:"warning",message:"请选择角色!",showClose:!0,customClass:"warning_class"})}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"limit-set-panel"},[a("div",{staticClass:"top-tool-input"},[a("el-form",{ref:"form1",attrs:{inline:!0,"label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("menu.LimitSet.5nrnc5t5ui40")}},[a("el-select",{attrs:{clearable:"",filterable:"",size:"mini",placeholder:e.$t("menu.LimitSet.5nrnc5t6q580")},on:{change:e.roleSelectEvemt},model:{value:e.finds.role,callback:function(t){e.$set(e.finds,"role",t)},expression:"finds.role"}},e._l(e.RoleData,function(e){return a("el-option",{key:e.rw,attrs:{label:e.RoleDesc,value:e.rw}})}),1)],1),e._v(" "),a("el-form-item",[a("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode,icon:"nm-icon-w-save"},on:{click:function(t){return e.saveClick("maincollapse")}}},[e._v(e._s(e.$t("menu.LimitSet.5nrnc5t6re80")))]),e._v(" "),a("hgswitch",{attrs:{"active-text":e.$t("menu.LimitSet.5nrnc5t7l080"),"inactive-text":e.$t("menu.LimitSet.5ncy6t95dvw0"),disabled:e.selectAllShow},on:{change:e.selectAllEvent},model:{value:e.selectAll,callback:function(t){e.selectAll=t},expression:"selectAll"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"limit-set-content"},[a("div",{staticClass:"limit-set-content-div",style:{height:e.Height-82+"px"}},[a("el-scrollbar",{staticClass:"limitcheck",style:{height:e.Height-80+"px"}},[a("el-collapse",{ref:"maincollapse",attrs:{accordion:e.isAccordion},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.MenuData,function(t){return a("el-collapse-item",{key:t.id,attrs:{title:t.lbl,name:t.id,value:t.id}},e._l(t.chd,function(t){return a("el-card",{key:t.id,style:{marginLeft:t.fatherId?"20px":"10px"},attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.lbl))]),e._v(" "),a("hgswitch",{ref:t.id,refInFor:!0,attrs:{name:t.id},on:{change:function(a){return e.switchChange(a,t)}},model:{value:t.chk,callback:function(a){e.$set(t,"chk",a)},expression:"im.chk"}}),e._v(" "),t.chd&&t.chd.length>0?a("el-checkbox",{attrs:{disabled:!t.chk,indeterminate:t.inCheckAll},on:{change:function(a){return e.handleCheckAllChange(a,t)}},model:{value:t.checkAll,callback:function(a){e.$set(t,"checkAll",a)},expression:"im.checkAll"}},[e._v(e._s(e.$t("menu.LimitSet.5nrnc5t7l080")))]):e._e()],1),e._v(" "),a("el-checkbox-group",{attrs:{size:"large"},on:{change:function(a){return e.handleCheckedChange(a,t)}},model:{value:t.ckall,callback:function(a){e.$set(t,"ckall",a)},expression:"im.ckall"}},e._l(t.chd,function(l){return a("el-checkbox",{key:l.id,ref:l.id,refInFor:!0,attrs:{disabled:!t.chk,value:l.id,name:l.id,label:l.id}},[e._v(e._s(l.lbl))])}),1)],1)}),1)}),1)],1)],1)])])},staticRenderFns:[]};var m=a("VU/8")(f,k,!1,function(e){a("DVHB")},null,null);t.default=m.exports}});