webpackJsonp([327],{qfDe:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create_excel=function(e,t,r,o,a,i,h,s,c){n().then(function(n){n.Promise;return n.fromBlankAsync().then(function(n){var g=1;i&&(n.sheet(0).row(1).height(30),n.sheet(0).range("A1:"+l(e.length)+"1").merged(!0),n.sheet(0).cell("A1").value(i||"列表"),n.sheet(0).cell("A1").style({wrapText:!0}),n.sheet(0).cell("A1").style({bold:!0,fontSize:14,verticalAlignment:"center",horizontalAlignment:"center"}),g+=1),s=s||new Array,n.sheet(0).row(g).height(20);for(var u=0;u<s.length;u++){var d=n.sheet(0).row(g).cell(u+1);d.value(s[u])}0!=s.length&&(g+=1);for(var p=0,v=new Array,f=0;f!=e.length;f++){p++;var w=n.sheet(0).row(g).cell(p),m=parseInt(e[f].width/10)+2;v.push(m),n.sheet(0).column(p).width(m),w.value(e[f].label),w.style({bold:!0,border:!0})}g+=1;for(var y=0;y<t.length;y++){for(var b=1,A=0;A<e.length;A++){void 0==t[y][e[A].prop]&&(t[y][e[A].prop]="");var C=n.sheet(0).row(y+g).cell(A+1),x=t[y][e[A].prop];if(x=(x=void 0==x?"":x).toString(),C.value(x),C.style({border:!0,verticalAlignment:"center",wrapText:!0}),r[y]&&r[y][e[A].prop]){var O=r[y][e[A].prop].split("!")[0];O&&-1!=O.indexOf("#")&&C.style({fontColor:{rgb:O.substr(1)}});var S=r[y][e[A].prop].split("!")[1];S&&-1!=S.indexOf("#")&&C.style({fill:S.substr(1)})}var U=parseInt(x.replace(/[\u4e00-\u9fa5]/g,"aa").length/v[A])+1;U>b&&(b=U)}var L=20*b;L=b>1?18*b:L,n.sheet(0).row(y+g).height(L)}o&&(n.sheet(0).range("A"+(g+t.length)+":"+l(p)+(g+t.length)).merged(!0),n.sheet(0).row(g+t.length).cell(1).value("备注："+o),n.sheet(0).row(g+t.length).height(24*o.split("\n").length),n.sheet(0).cell("A"+(g+t.length)).style({verticalAlignment:"top"})),c&&c.close(),"export"==a&&n.outputAsync().then(function(e){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,(h||"列表")+".xlsx");else{var t=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.href=t,r.download=(h||"列表")+".xlsx",r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}}).catch(function(e){throw alert(e.message||e),e})})})},t.getColCode=l,t.fixdata=function(e){for(var t="",r=0,n=10240;r<e.byteLength/n;++r)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n,r*n+n)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n)))};var n=function(){return Promise.all([r.e(21),r.e(7)]).then(r.bind(null,"7WPZ"))};function l(e){if(null==e||void 0==e||""==e||e<=0)return"";if(e<=26)return String.fromCharCode(64+e);var t=(e-1)%26;return l(Math.floor((e-1)/26))+String.fromCharCode(65+t)}}});