webpackJsonp([138,181],{"/bRx":function(e,t){},"1een":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),r=s("yKG+"),n=s("NYxO"),i=s("z8xk"),l=s("XlQt"),c=s("W5Fe"),u={name:"FocusQues",components:{NurQualCheckScore:r.default,hgpanel:i.default,hgbutton:l.default,hgpagination:c.default},computed:o()({},Object(n.b)(["Height","styleCode"])),data:function(){return{WardContTD:{border:"1px solid #EBEEF5",fontSize:"13px",fontFamily:"Microsoft YaHei",height:"26px"},TdStyle:{border:"1px solid #EBEEF5",fontSize:"13px",fontFamily:"Microsoft YaHei",height:"30px"},leftShowFlag:!0,OtherHeight:106,elementlist:{},ToolForm:{Status:"",StDate:"",EndDate:""},StatusStore:[{value:"N",label:"保存"},{value:"Y",label:"已提交"},{value:"B",label:"驳回"},{value:"S",label:"已审核"}],WardStore:[],TaskTable:[],PageSize:20,CurrentPage:1,TotalCount:0,DialogVisible:!1,RecLoading:!1,EditForm:{KeyQuesDesc:"",KeyQuesWard:[],KeyQuesStDate:(new Date).getMonthDate(1).addDate(-1).getMonthDate(1),KeyQuesEndDate:(new Date).getMonthDate(1).addDate(-1).getMonthLastDate(),KeyQuesRate:0,Qual:[],rw:""},Rules:{Qual:[{required:!0,message:"质控不能为空",trigger:"change"}],KeyQuesDesc:[{required:!0,message:"级别不能为空",trigger:"blur"}],KeyQuesWard:[{required:!0,message:"检查项目不能为空",trigger:"change",type:"array"}],KeyQuesStDate:[{required:!0,message:"检查人不能为空",trigger:"change",type:"date"}],KeyQuesEndDate:[{required:!0,message:"检查病区不能为空",trigger:"change",type:"date"}],KeyQuesRate:[{required:!0,message:"错误率不能为空",trigger:"blur"}]},SelectRow:"",RowEditAble:!0,EditFlag:!1,AuditFlag:!1,AuditStatusStore:[{label:"审核",id:"S"},{label:"驳回",id:"B"}],AuditForm:{Status:"",Reason:"",AuditorName:sessionStorage.loginName},AuditDialogVisible:!1,AuditRules:{Status:[{required:!0,message:"请选择审批结果",trigger:"change"}]},ItemTableData:[],QualStore:[],RejectInfo:[],winFlag:0}},methods:{LoadQualItem:function(){var e=this;this.QualStore=[];var t="";this.EditForm.KeyQuesStDate instanceof Date&&(t=this.EditForm.KeyQuesStDate.Format("YYYY")),this.EditForm.KeyQuesEndDate instanceof Date&&(t=t+","+this.EditForm.KeyQuesEndDate.Format("YYYY"));var s=this.axiosConfig("web.INMQualControlComm","FindQualForType","RecQuery","year$"+t);this.$ajax.request(s).then(function(t){t.data instanceof Object?e.QualStore=t.data.rows:e.$message({type:"error",message:"获取质控项目失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取质控项目失败",showClose:!0,customClass:"error_class"})})},LoadRoleWard:function(){var e=this;this.WardStore=[];var t=this.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.loginID);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardStore=t.data.rows:e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})})},ToolFormSearch:function(e){var t=this,s=(this.CurrentPage-1)*this.PageSize,a=this.CurrentPage*this.PageSize,o=this.ToolForm.Status,r="";this.ToolForm.StDate instanceof Date&&(r=this.ToolForm.StDate.Format("YYYY-MM-dd"));var n="";this.ToolForm.EndDate instanceof Date&&(n=this.ToolForm.EndDate.Format("YYYY-MM-dd"));var i=o+"^"+r+"^"+n;this.TaskTable=new Array,this.SelectRow="";var l=this.axiosConfig("web.INMQualControlComm","FindFocusQues","RecQuery","parr$"+i,"nurseid$"+sessionStorage.loginID);this.$ajax.request(l).then(function(o){if(o.data instanceof Object){var r=o.data.rows;if(e)for(var n=0;n<r.length;n++){var i=r[n];i.rw==e&&t.RowDblClick(i,"","")}t.TaskTable=r.slice(s,a),t.TotalCount=parseInt(o.data.results)}else t.$message({type:"error",message:"获取任务列表失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取任务列表失败",showClose:!0,customClass:"error_class"})})},AddTask:function(){var e=this;this.RowEditAble=!0,this.DialogVisible=!0,this.winFlag=0,this.$nextTick(function(){e.$refs.EditForm.resetFields(),e.EditForm.rw="",e.LoadQualItem()})},SaveTaskData:function(e){var t=this;this.$refs.EditForm.validate(function(s){if(s){var a=t.EditForm.Qual.toString(),o=t.EditForm.KeyQuesWard.toString(),r=t.EditForm.KeyQuesStDate;r instanceof Date&&(r=r.Format("YYYY-MM-dd"));var n=t.EditForm.KeyQuesEndDate;n instanceof Date&&(n=n.Format("YYYY-MM-dd"));var i=a+"^"+o+"^"+r+"^"+n+"^"+e+"^"+t.EditForm.rw+"^"+t.EditForm.KeyQuesDesc+"^"+t.EditForm.KeyQuesRate;t.RecLoading=!0;var l=t.axiosConfig("web.INMQualControlComm","SaveFocusQues","Method","parr$"+i,"nurseid$"+sessionStorage.loginID);t.$ajax.request(l).then(function(e){t.RecLoading=!1,1==e.data?(t.DialogVisible=!1,t.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}),t.ToolFormSearch()):e.data.length<100?t.$message({type:"warning",message:e.data,showClose:!0,customClass:"warning_class"}):t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.RecLoading=!1,t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}})},EditTask:function(){var e=this;this.SelectRow&&this.SelectRow.rw?(this.RowEditAble=!1,this.DialogVisible=!0,this.$nextTick(function(){e.$refs.EditForm.resetFields(),e.EditForm.rw="",e.GetEditForm()})):this.$message({type:"warning",message:"请先选择一条数据",showClose:!0,customClass:"warning_class"})},GetEditForm:function(){var e=this;this.RecLoading=!0;var t=this.axiosConfig("web.INMQualControlComm","GetFocusQues","RecMethod","rw$"+this.SelectRow.rw);this.$ajax.request(t).then(function(t){e.RecLoading=!1,t.data instanceof Object?(e.setForm(e.$refs.EditForm,e.EditForm,t.data),e.LoadQualItem()):e.$message({type:"error",message:"获取数据失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.RecLoading=!1,e.$message({type:"error",message:"获取数据失败",showClose:!0,customClass:"error_class"})})},DeleteTask:function(){var e=this;this.SelectRow&&this.SelectRow.rw?this.$confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",closeOnClickModal:!1,type:"warning"}).then(function(){var t=e.axiosConfig("web.INMQualControlComm","DelFocusQues","Method","rw$"+e.SelectRow.rw,"nurseid$"+sessionStorage.loginID);e.$ajax.request(t).then(function(t){1==t.data?(e.$message({type:"success",message:"删除成功",showClose:!0,customClass:"success_class"}),e.ToolFormSearch()):t.data.length<100?e.$message({type:"warning",message:res.data,showClose:!0,customClass:"warning_class"}):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"删除失败",showClose:!0,customClass:"error_class"})})}).catch(function(){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):this.$message({type:"warning",message:"请先选择一条数据",showClose:!0,customClass:"warning_class"})},RowClick:function(e,t,s){this.SelectRow=e},RowDblClick:function(e,t,s){this.SelectRow=e,this.winFlag=1,this.LoadItemTableData()},LoadItemTableData:function(){var e=this,t=e.SelectRow;e.EditFlag=!1,e.AuditFlag=!1,e.$nextTick(function(){if("N"!=t.KeyQuesStatus&&"B"!=t.KeyQuesStatus||t.Creator!=sessionStorage.getItem("loginID")||(e.EditFlag=!0),"Y"==t.KeyQuesStatus&&(e.AuditFlag=!0),t&&t.rw){var s=new Array,a=t.RejectInfo;if(a)for(var o=a.split("」"),r=0;r<o.length;r++){var n=o[r];n&&s.push({date:n.split("「")[1],name:n.split("「")[2],reason:n.split("「")[0]})}e.RejectInfo=s;var i=e.axiosConfig("web.INMQualControlComm","LoadFocusQuesByID","RecQuery","id$"+t.rw);e.$ajax.request(i).then(function(t){e.ItemTableData=t.data.rows})}else e.$message({type:"warning",message:"请先选择一条数据",showClose:!0,customClass:"warning_class"})})},HandleSizeChange:function(e){this.PageSize=e,this.ToolFormSearch()},HandleCurrentChange:function(e){this.CurrentPage=e.currentPage,this.ToolFormSearch()},AuditClick:function(){var e=this;this.SelectRow&&this.SelectRow.rw?(this.AuditDialogVisible=!0,this.$nextTick(function(){e.$refs.AuditForm.resetFields()})):this.$message({type:"warning",message:"请先选中一行数据",showClose:!0,customClass:"warning_class"})},AuditApp:function(){var e=this;this.$refs.AuditForm.validate(function(t){if(t){var s=e.AuditForm.Status+"「"+e.AuditForm.Reason+"「"+(new Date).Format("yyyy-MM-dd")+"「"+sessionStorage.loginName;e.FinishClick(s)}})},FinishClick:function(e){var t=this;if(!this.SelectRow||!this.SelectRow.rw)return this.$message({type:"warning",message:"请先选中一行数据",showClose:!0,customClass:"warning_class"}),void(this.AuditDialogVisible=!1);var s=this.axiosConfig("web.INMQualControlComm","AuditKeyQues","Method","parr$"+e,"id$"+this.SelectRow.rw,"nurseid$"+sessionStorage.loginID);this.$ajax.request(s).then(function(e){!isNaN(Number(e.data))&&Number(e.data)>0?(t.AuditDialogVisible=!1,t.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),t.ToolFormSearch(e.data)):e.data.length<100?t.$message({type:"warning",message:e.data,showClose:!0,customClass:"warning_class"}):t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.RecLoading=!1,t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})},SaveItem:function(e){var t=this,s=e.Result+"「"+e.Remark,a=this.axiosConfig("web.INMQualControlComm","SaveFocusQuesItem","Method","parr$"+s,"rw$"+e.rw);this.$ajax.request(a).then(function(e){1==e.data?t.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}):e.data.length<100?t.$message({type:"warning",message:e.data,showClose:!0,customClass:"warning_class"}):t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.RecLoading=!1,t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})},DelQuesClick:function(e){var t=this,s=this.axiosConfig("web.INMQualControlComm","DelFocusQuesSub","Method","id$"+e,"nurseid$"+sessionStorage.getItem("loginID"));this.$ajax.request(s).then(function(e){1==e.data?(t.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),t.LoadItemTableData()):e.data.length<100?t.$message({type:"warning",message:e.data,showClose:!0,customClass:"warning_class"}):t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.RecLoading=!1,t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}},created:function(){this.LoadRoleWard(),this.ToolFormSearch();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"focus-ques-panel",attrs:{id:"FocusQues"}},[s("el-row",{staticStyle:{padding:"10px 12px 10px 10px"},attrs:{gutter:12}},[s("el-col",{attrs:{span:12}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.FocusQues.5ncy6jxulpg0"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-31}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.leftShowFlag,expression:"leftShowFlag"}]},[s("div",{staticClass:"top-tool-inputDiv"},[s("el-form",{attrs:{inline:!0,model:e.ToolForm}},[s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqz9sbg0")}},[s("el-select",{staticStyle:{width:"100px"},attrs:{clearable:"",placeholder:e.$t("menu.FocusQues.5nrnbqzbb240"),size:"mini"},model:{value:e.ToolForm.Status,callback:function(t){e.$set(e.ToolForm,"Status",t)},expression:"ToolForm.Status"}},e._l(e.StatusStore,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5ncy6jxupmo0")}},[s("el-form-item",[s("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.FocusQues.5nrnbqzcx6w0"),size:"mini"},model:{value:e.ToolForm.StDate,callback:function(t){e.$set(e.ToolForm,"StDate",t)},expression:"ToolForm.StDate"}})],1),e._v(" "),s("el-form-item",[s("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.FocusQues.5nrnbqzeh040"),size:"mini"},model:{value:e.ToolForm.EndDate,callback:function(t){e.$set(e.ToolForm,"EndDate",t)},expression:"ToolForm.EndDate"}})],1)],1),e._v(" "),s("el-form-item",[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.ToolFormSearch}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzeiow0")))])],1)],1)],1),e._v(" "),s("div",{staticClass:"top-tool-button"},[0==this.$store.state.login.LoginId||e.elementlist.taskadd?s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":""},on:{click:e.AddTask}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzejy40")))]):e._e(),e._v(" "),0==this.$store.state.login.LoginId||e.elementlist.taskdel?s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-cancel":"nm-icon-lite-cance"},on:{click:e.DeleteTask}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzeky80")))]):e._e()],1),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"TaskTable",attrs:{data:e.TaskTable,"highlight-current-row":"",border:e.styleCode,height:e.styleCode?e.Height-190:e.Height-184,"header-cell-style":e.headerCellFontWeight},on:{"row-click":e.RowClick,"row-dblclick":e.RowDblClick}},[s("el-table-column",{attrs:{type:"index",align:"center",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"KeyQuesStatusDesc",label:e.$t("menu.FocusQues.5nrnbqz9sbg0"),"show-overflow-tooltip":"",width:"70"}}),e._v(" "),s("el-table-column",{attrs:{prop:"KeyQuesDesc",label:e.$t("menu.FocusQues.5nrnbqzjhb40"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"KeyQuesRate",label:e.$t("menu.FocusQues.5nrnbqzley00"),"show-overflow-tooltip":"",width:"90"}}),e._v(" "),s("el-table-column",{attrs:{prop:"KeyQuesWardDesc",label:e.$t("menu.FocusQues.5nrnbqzmtag0"),"show-overflow-tooltip":"",width:"130"}}),e._v(" "),s("el-table-column",{attrs:{prop:"KeyQuesDualDate",label:e.$t("menu.FocusQues.5ncy6jxuumo0"),"show-overflow-tooltip":"",width:"200",formatter:e.PTableDateHisShow},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                  "+e._s(t.row.KeyQuesStDate)+e._s(e.$t("menu.FocusQues.5nrnbqzmwjk0"))+e._s(t.row.KeyQuesEndDate)+"\n                              ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"QualDesc",label:e.$t("menu.FocusQues.5nrnbqzomnw0"),"show-overflow-tooltip":"",width:"90"}}),e._v(" "),s("el-table-column",{attrs:{prop:"CreatorDesc",label:e.$t("menu.FocusQues.5nrnbqzpmss0"),"show-overflow-tooltip":""}})],1),e._v(" "),s("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.TotalCount,pageNumber:e.CurrentPage,pageSize:e.PageSize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1)])])],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.FocusQues.5ncy6jxuymc0"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-31}},[s("div",{staticClass:"top-tool-button"},[0==e.$store.state.login.LoginId||e.elementlist.audit?s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.FinishClick,time:500,status:"Y"},expression:"{func:FinishClick,time:500,status:'Y'}"}],attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-submit":"nm-icon-lite-submit",disabled:!e.EditFlag}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzppo00")))]):e._e(),e._v(" "),0==e.$store.state.login.LoginId||e.elementlist.check?s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.AuditClick,time:500},expression:"{func:AuditClick,time:500}"}],attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-stamp":"nm-icon-lite-stamp",disabled:!e.AuditFlag}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzpq7k0")))]):e._e()],1),e._v(" "),s("div",[s("div",{staticStyle:{width:"100%",overflow:"auto"},style:{height:e.Height-e.OtherHeight+"px","border-top":e.styleCode?"1px solid #ccc":"1px solid #e2e2e2"}},[s("table",{staticStyle:{width:"100%","border-collapse":"collapse","table-layout":"fixed","word-wrap":"break-word"},style:{border:e.styleCode?"1px solid #ccc":"1px solid #e2e2e2"},attrs:{cellspacing:"0",cellpadding:"0"}},[s("thead",[s("tr",{staticStyle:{color:"#000"},style:{"border-bottom":e.styleCode?"1px solid #ccc":"1px solid #e2e2e2","background-color":e.styleCode?"#F4F6F5":"#f8f8f8"}},[s("th",{staticStyle:{"min-width":"150px",width:"150px","font-weight":"normal","text-align":"left","padding-left":"10px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzsolo0")))]),e._v(" "),s("th",{staticStyle:{"min-width":"60px",width:"50px","font-weight":"normal","text-align":"left","padding-left":"10px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5ncy6jxwa840")))]),e._v(" "),s("th",{staticStyle:{"min-width":"120px",width:"60px","font-weight":"normal","text-align":"left","padding-left":"10px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzley00")))]),e._v(" "),s("th",{staticStyle:{"min-width":"120px",width:"80px","font-weight":"normal","text-align":"left","padding-left":"10px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzspvw0")))]),e._v(" "),s("th",{staticStyle:{"min-width":"120px",width:"120px","font-weight":"normal","text-align":"left","padding-left":"10px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzsq7g0")))]),e._v(" "),s("th",{staticStyle:{"min-width":"50px",width:"50px","font-weight":"normal"},style:e.TdStyle},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzsqhc0")))])])]),e._v(" "),s("tbody",[e._l(e.ItemTableData,function(t,a){return[s("tr",{key:"item"+a},[s("td",{staticStyle:{"padding-left":"10px"},style:e.TdStyle},[e._v(e._s(t.QuesDesc))]),e._v(" "),s("td",{staticStyle:{"padding-left":"10px"},style:e.TdStyle},[e._v(e._s(t.ErrNum+"/"+t.CheckNum))]),e._v(" "),s("td",{staticStyle:{"padding-left":"10px"},style:e.TdStyle},[e._v(e._s(t.ErrRate))]),e._v(" "),s("td",{style:e.TdStyle},[s("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.EditFlag,size:"mini"},on:{change:function(s){return e.SaveItem(t)}},model:{value:t.Result,callback:function(s){e.$set(t,"Result",s)},expression:"item['Result']"}},[s("el-option",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzurio0"),value:e.$t("menu.FocusQues.5nrnbqzurio0")}}),e._v(" "),s("el-option",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzwrao0"),value:e.$t("menu.FocusQues.5nrnbqzwrao0")}})],1)],1),e._v(" "),s("td",{style:e.TdStyle},[s("el-input",{staticStyle:{width:"100%"},attrs:{disabled:!e.EditFlag,placeholder:"",size:"mini"},on:{blur:function(s){return e.SaveItem(t)}},model:{value:t.Remark,callback:function(s){e.$set(t,"Remark",s)},expression:"item['Remark']"}})],1),e._v(" "),s("td",{attrs:{align:"center"}},[e.EditFlag?s("i",{class:e.styleCode?"nm-icon-cancel":"nm-icon-lite-cancel",staticStyle:{color:"#FF0000",cursor:"pointer"},on:{click:function(s){return e.DelQuesClick(t.rw)}}}):e._e()])])]})],2)])])])])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:(e.winFlag,e.$t("menu.FocusQues.5nrnbqzejy40")),visible:e.DialogVisible,"close-on-click-modal":!1,width:"424px"},on:{"update:visible":function(t){e.DialogVisible=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?s("span",[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzejy40")))]):1==e.winFlag?s("span",[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzejy40")))]):e._e()]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.RecLoading,expression:"RecLoading"}],attrs:{"element-loading-text":e.$t("menu.FocusQues.5nrnbr006ds0")}},[s("el-form",{ref:"EditForm",attrs:{model:e.EditForm,rules:e.Rules,disabled:!e.RowEditAble,"label-position":"right","label-width":"100px",inline:!0,align:"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzjhb40"),prop:"KeyQuesDesc"}},[s("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"","show-word-limit":"",size:"mini"},model:{value:e.EditForm.KeyQuesDesc,callback:function(t){e.$set(e.EditForm,"KeyQuesDesc",t)},expression:"EditForm.KeyQuesDesc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzmtag0"),prop:"KeyQuesWard"}},[s("el-select",{staticStyle:{width:"280px","margin-bottom":"8px"},attrs:{clearable:"",multiple:"","collapse-tags":"",size:"mini"},model:{value:e.EditForm.KeyQuesWard,callback:function(t){e.$set(e.EditForm,"KeyQuesWard",t)},expression:"EditForm.KeyQuesWard"}},e._l(e.WardStore,function(e){return s("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzcx6w0"),prop:"KeyQuesStDate"}},[s("el-date-picker",{staticStyle:{width:"280px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.FocusQues.5nrnbqzcx6w0"),size:"mini"},on:{change:e.LoadQualItem},model:{value:e.EditForm.KeyQuesStDate,callback:function(t){e.$set(e.EditForm,"KeyQuesStDate",t)},expression:"EditForm.KeyQuesStDate"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzeh040"),prop:"KeyQuesEndDate"}},[s("el-date-picker",{staticStyle:{width:"280px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.FocusQues.5nrnbqzcx6w0"),size:"mini"},on:{change:e.LoadQualItem},model:{value:e.EditForm.KeyQuesEndDate,callback:function(t){e.$set(e.EditForm,"KeyQuesEndDate",t)},expression:"EditForm.KeyQuesEndDate"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzomnw0"),prop:"Qual"}},[s("el-select",{staticStyle:{width:"280px"},attrs:{clearable:"",filterable:"",placeholder:e.$t("menu.FocusQues.5nrnbqzbb240"),size:"mini"},model:{value:e.EditForm.Qual,callback:function(t){e.$set(e.EditForm,"Qual",t)},expression:"EditForm.Qual"}},e._l(e.QualStore,function(e){return s("el-option",{key:e.Qual,attrs:{label:e.QualDesc,value:e.Qual}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbqzley00"),prop:"KeyQuesRate"}},[s("el-input-number",{staticStyle:{width:"280px"},attrs:{min:0,placeholder:"","show-word-limit":"",size:"mini"},model:{value:e.EditForm.KeyQuesRate,callback:function(t){e.$set(e.EditForm,"KeyQuesRate",t)},expression:"EditForm.KeyQuesRate"}})],1)],1),e._v(" "),s("div",{staticClass:"bottom-button"},[0==e.$store.state.login.LoginId||e.elementlist.save?s("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode,disabled:!e.RowEditAble},on:{click:function(t){return e.SaveTaskData("N")}}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbr0awm80")))]):e._e(),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.DialogVisible=!1}}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbr0axao0")))])],1)],1)]),e._v(" "),s("el-dialog",{attrs:{title:e.$t("menu.FocusQues.5nrnbr0bybg0"),visible:e.AuditDialogVisible,"close-on-click-modal":!1,width:"554px"},on:{"update:visible":function(t){e.AuditDialogVisible=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{staticClass:"nm-icon-w-paper"}):e._e(),e._v(" "),s("span",[e._v(e._s(e.$t("menu.FocusQues.5nrnbr0bybg0")))])]),e._v(" "),s("el-form",{ref:"AuditForm",attrs:{model:e.AuditForm,rules:e.AuditRules,"label-position":"right",inline:"","label-width":"100px",align:"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbr0cywo0"),prop:"Status"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"",size:"mini"},model:{value:e.AuditForm.Status,callback:function(t){e.$set(e.AuditForm,"Status",t)},expression:"AuditForm.Status"}},e._l(e.AuditStatusStore,function(e){return s("el-option",{key:e.id,attrs:{value:e.id,label:e.label}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbr0e0og0"),prop:"Reason"}},[s("el-input",{staticStyle:{width:"410px","margin-top":"10px"},attrs:{type:"textarea",placeholder:"",rows:3,maxlength:"200","show-word-limit":"",size:"mini"},model:{value:e.AuditForm.Reason,callback:function(t){e.$set(e.AuditForm,"Reason",t)},expression:"AuditForm.Reason"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5nrnbr0fxls0"),prop:"AuditorName"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{disabled:"",placeholder:"",size:"mini"},model:{value:e.AuditForm.AuditorName,callback:function(t){e.$set(e.AuditForm,"AuditorName",t)},expression:"AuditForm.AuditorName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.FocusQues.5ncy6jxwve00")}},[s("el-input",{staticStyle:{width:"150px"},attrs:{value:(new Date).Format(this.$store.state.mainframe.DateFormat),disabled:"",placeholder:"",size:"mini"}})],1)],1),e._v(" "),s("div",{staticClass:"bottom-button"},[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:e.AuditApp}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbqzppo00")))]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.AuditDialogVisible=!1}}},[e._v(e._s(e.$t("menu.FocusQues.5nrnbr0axao0")))])],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(u,d,!1,function(e){s("/bRx")},null,null);t.default=h.exports},nMRI:function(e,t){},"yKG+":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Gu7T"),o=s.n(a),r=s("Dd8w"),n=s.n(r),i=s("NYxO"),l=s("s5sJ"),c={components:{hgbutton:s("XlQt").default},name:"NurQualCheckScore",computed:n()({},Object(i.b)(["Height","styleCode"])),props:["params"],directives:{dragMove:{inserted:function(e,t,s){if(navigator.userAgent.indexOf("Trident")>-1&&navigator.userAgent.indexOf("rv:11.0")>-1||navigator.userAgent.indexOf("MSIE")>-1){var a=document.createElement("span"),o=document.createElement("label");a.appendChild(o),a.style.position="relative",a.style.verticalAlign="bottom",o.style.position="absolute",o.style.width="17px",o.style.height="17px",o.style.background="url(\"data:image/svg+xml,%3Csvg viewBox='0 0 1024 1024' xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cpath d='M765.558 510.004a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM765.558 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM422.15700000000004 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM422.15700000000004 510.004a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM765.558 202.54a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0zM66.77700000000002 821.46a93.65 93.65 0 1 0 191.665 0 93.65 93.65 0 1 0-191.665 0z' fill='%23BFBFBF'/%3E%3C/svg%3E\") no-repeat center",o.style.bottom="0",o.style.right="0",o.style.backgroundSize="12px 12px",a.onmousedown=function(t){e.dragMovePreY=t.pageY,e.dragMovePreH=e.offsetHeight,document.onmousemove=function(t){var s=e.dragMovePreH+(t.pageY-e.dragMovePreY);s<39&&(s=39),e.style.height=s+"px"},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,e.dragMovePreY=null}},e.appendChild(a)}}}},data:function(){return{TdStyle:{border:"1px solid #EBEEF5",fontSize:"16px",fontFamily:"Microsoft YaHei",padding:"4px",height:"30px"},Title:"",TableData:[],total:[],scoreType:"",scoreTypeSub:"",Deepth:1,InsertCount:0,contextMenuData:{menuName:"taskmenulist",axis:{x:null,y:null},menulists:[],checkedValueList:[]},selectrow:{},selectcolumn:0,CheckInfo:{User:"",Ward:"",Date:new Date,Score:"",Status:"",Remark:"",CheckAccordScore:"",CheckAccordScoreSum:""},Editable:!1,rules:{Date:[{required:!0,message:"检查日期不能为空",trigger:"change",type:"date"}]},InsertHead:[],InsertHeadPat:[],InsertHeadNur:[],InsertHeadInput:[],WardPatientStore:[],WardNurseStore:[],CheckScoreFlag:"N",PrintWhiteFlag:!1,DefaultScore:[],IsOverHlb:!1}},methods:{GetSummary:function(e){e.columns,e.data;var t=[];return t.push.apply(t,o()(new Array(this.Deepth).fill(""))),t[0]="合计",2==this.scoreTypeSub&&"Y"==this.CheckScoreFlag&&t.push(this.CheckInfo.CheckAccordScoreSum),t.push.apply(t,o()(this.total)),1==this.params.Review&&t.push(""),2==this.scoreTypeSub&&"Y"==this.CheckScoreFlag&&t.push(this.CheckInfo.CheckAccordScore),2==this.scoreTypeSub&&t.push(this.CheckInfo.Score),t.push(""),t},QualSpan:function(e){var t=e.row,s=(e.column,e.rowIndex,e.columnIndex+1);if(2==this.scoreTypeSub){var a=1+this.InsertCount+("Y"==this.CheckScoreFlag?2:0),o=this.Deepth+a+1,r=o+this.Deepth-1;s>=o&&s<=r&&(s=s-(s-o)-a-(s-o)-1)}var n=t.SubSort.split(".").length-1;if(s<n){var i=s+1;if(t.Roots.some(function(e){return e.split(".").length-1==i})){var l=t.SubSort.split(".").slice(0,s+1).join(".");return[this.TableData.find(function(e){return e.SubSort==l}).RowSpan,1]}return[0,0]}return s==n?[1,this.Deepth-n+1]:s>this.Deepth?[1,1]:[0,0]},CalculateScore:function(e){for(var t=0,s=0,a=0,o=0;o<e.length;o++){var r=e[o];if("-"!=r){var n=r.split("@");t+=n[0]?isNaN(parseInt(n[0]))?0:parseInt(n[0]):0,s+=n[1]?isNaN(parseInt(n[1]))?0:parseInt(n[1]):0,a+=n[2]?isNaN(parseInt(n[2]))?0:parseInt(n[2]):0}}var i="100%";return t+s+a!=0&&(i=(t/(t+s+a)*100).toFixed(2)+"%"),i},CalculateFatherScore:function(e){var t=0,s=0,a=0;if(!e)return"";e=e.substring(0,e.lastIndexOf(".")),this.TableData.forEach(function(o){if(0==o.HasChild&&o.SubSort.substring(0,e.length)==e)for(var r=0;r<o.ItemScore.length;r++){var n=o.ItemScore[r];if("-"!=n){var i=n.split("@");t+=i[0]?isNaN(parseInt(i[0]))?0:parseInt(i[0]):0,s+=i[1]?isNaN(parseInt(i[1]))?0:parseInt(i[1]):0,a+=i[2]?isNaN(parseInt(i[2]))?0:parseInt(i[2]):0}}});var o="100%";return t+s+a!=0&&(o=(t/(t+s+a)*100).toFixed(2)+"%"),o},GetFatherRowSpan:function(e){return e=e.substring(0,e.lastIndexOf(".")),this.TableData.find(function(t){return t.SubSort==e}).RowSpan},GetReverseRoots:function(e){return[].concat(o()(e)).reverse()},GetFatherDesc:function(e){return e=e.substring(0,e.lastIndexOf(".")),this.TableData.find(function(t){return t.SubSort==e}).SubItem},GetSchduleData:function(){var e=this,t=this;t.$ajax.request(t.axiosConfig("web.INMQualControlComm","GetQualCheck","Method","task$"+t.params.TaskId,"qualpar$"+t.params.TaskItem,"ward$"+t.params.TaskWard)).then(function(s){if(s.data instanceof Object){t.scoreType=s.data.ScoreType,t.scoreTypeSub=s.data.ScoreTypeSub,t.CheckScoreFlag=s.data.CheckScoreFlag,t.InsertCount=isNaN(parseInt(s.data.InsertCount))?1:parseInt(s.data.InsertCount),2==s.data.ScoreType?t.total=new Array(t.InsertCount+1).fill(0):2==s.data.ScoreTypeSub?t.total=new Array(t.InsertCount).fill(""):t.total=new Array(t.InsertCount).fill("100%"),t.Deepth=isNaN(parseInt(s.data.Deepth))?1:parseInt(s.data.Deepth),t.InsertHead=s.data.QualInsert?s.data.QualInsert:[],t.InsertHeadPat=s.data.QualInsertPat?s.data.QualInsertPat:[],t.InsertHeadNur=s.data.QualInsertNur?s.data.QualInsertNur:[],t.InsertHeadInput=s.data.QualInsertInput?s.data.QualInsertInput:[],s.data.QualSubItems=s.data.QualSubItems?s.data.QualSubItems:[],e.DefaultScore=new Array(s.data.QualSubItems.length).fill(""),s.data.QualSubItems.forEach(function(a,o){if(0==a.HasChild){if(a.ItemScore?(a.ItemScore=a.ItemScore.split(","),e.DefaultScore[o]=a.ItemScore[0]):2!=s.data.ScoreType&&2==s.data.ScoreTypeSub?(a.ItemScore=new Array(t.InsertCount).fill("@@"),e.DefaultScore[o]="@@"):(a.ItemScore=new Array(t.InsertCount).fill(""),e.DefaultScore[o]=""),2!=s.data.ScoreType&&2==s.data.ScoreTypeSub){a.ScoreToShow=new Array(t.InsertCount);var r=a.CheckMenu.split(",");a.ItemScore.forEach(function(e,t){if(e)if("-"==e)a.ScoreToShow[t]="不适用";else{var s="";e.split("@").forEach(function(e,t){e&&(s=s?s+","+r[t].split("@")[0]+":"+e:r[t].split("@")[0]+":"+e)}),a.ScoreToShow[t]=s}else a.ScoreToShow[t]=""})}else if(2==s.data.ScoreType&&6==s.data.ScoreTypeSub){a.ScoreToShow=new Array(t.InsertCount);var n=a.CheckMenu.split(",");a.ItemScore.forEach(function(e,t){if(e){var s="";e.split("@").forEach(function(e,t){e&&(s=s?s+","+n[parseInt(e)].split("@")[0]:n[parseInt(e)].split("@")[0])}),a.ScoreToShow[t]=s}else a.ScoreToShow[t]=""})}if(2==s.data.ScoreType&&0==a.HasChild){var i=Number(a.SubScore);t.total[0]=t.total[0]+(isNaN(i)?0:i)}}}),t.TableData=s.data.QualSubItems;for(var a=0;a<t.InsertCount;a++)t.selectcolumn=a,t.CalculateTotal();e.$nextTick(function(){e.$refs["qual-check-table"].doLayout()})}else t.$message({type:"error",message:"获取检查单失败!",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取检查单失败!",showClose:!0,customClass:"error_class"})})},CellClickEvent:function(e,t,s,a,o){if(this.Editable){var r=[];t.CheckMenu&&t.CheckMenu.split(",").forEach(function(e,n){var i=e.split("@"),l=i[0],c=i[1],u=i[2]?i[2]:"",d=!(!a||"不适用"==l),h=!(!o||"不适用"==l),m=n+"",p="";d&&t.ItemScore[s]&&"-"!=t.ItemScore[s]&&(p=t.ItemScore[s].split("@")[n]),r.push({fnHandler:d?"":"MarkScore",icoName:u,btnName:l,fnHandlerArg:c,showInput:d,inputValue:p,showCheckBox:h,checkedValue:m})}),this.selectrow=t,this.selectcolumn=s,o&&(t.ItemScore[s]?this.contextMenuData.checkedValueList=t.ItemScore[s].split("@"):this.contextMenuData.checkedValueList.splice(0,this.contextMenuData.checkedValueList.length)),this.contextMenuData.menulists=r,this.contextMenuData.axis={x:e.clientX,y:e.clientY}}},ChangeScore:function(e,t){if(this.Editable){this.selectrow=e,this.selectcolumn=t;var s=Number(e.ItemScore[t]);if(isNaN(s))e.ItemScore.splice(t,1,0);else if(s>Number(e.SubScore)){var a=Number(e.SubScore);e.ItemScore.splice(t,1,2==this.scoreType&&3==this.scoreTypeSub?a:-a)}else 2==this.scoreType&&3==this.scoreTypeSub&&s<0?e.ItemScore.splice(t,1,0):2==this.scoreType&&4==this.scoreTypeSub&&(Math.abs(s)>Number(e.SubScore)?e.ItemScore.splice(t,1,-Number(e.SubScore)):e.ItemScore.splice(t,1,-Math.abs(s)));this.CalculateTotal()}},ChangeScore2:function(e){if(this.Editable){var t=Number(e.SubAccordScore);isNaN(t)?e.SubAccordScore="":Math.abs(t)>Number(e.SubScore)?e.SubAccordScore=-Number(e.SubScore):e.SubAccordScore=-Math.abs(t),this.CalculateTotal()}},MarkScore:function(e){this.selectrow.ItemScore.splice(this.selectcolumn,1,e),"-"==e&&2!=this.scoreType&&2==this.scoreTypeSub&&this.selectrow.ScoreToShow.splice(this.selectcolumn,1,"不适用"),this.CalculateTotal()},HandleCountChange:function(e,t){"-"==this.selectrow.ItemScore[this.selectcolumn]&&this.selectrow.ItemScore[this.selectcolumn];var s=this.selectrow.ItemScore[this.selectcolumn].split("@");s[t]=e,this.selectrow.ItemScore[this.selectcolumn]=s.join("@");var a=this.selectrow.CheckMenu.split(","),o="";s.forEach(function(e,t){e&&(o=o?o+","+a[t].split("@")[0]+":"+e:a[t].split("@")[0]+":"+e)}),this.selectrow.ScoreToShow.splice(this.selectcolumn,1,o),this.CalculateTotal()},HandleCheckChange:function(e,t,s){this.selectrow.ItemScore[this.selectcolumn]=e.join("@");var a=this.selectrow.CheckMenu.split(","),o="";e.forEach(function(e){o=o?o+","+a[parseInt(e)].split("@")[0]:a[parseInt(e)].split("@")[0]}),this.selectrow.ScoreToShow.splice(this.selectcolumn,1,o),this.CalculateTotal()},CalculateTotal:function(){var e=this,t=0,s=0,a=0,o=0,r=0,n=0,i=0,l=0,c=0,u=0,d=0;if(this.TableData.forEach(function(h){if(0==h.HasChild)if(2!=e.scoreType&&1==e.scoreTypeSub)"√"==h.ItemScore[e.selectcolumn]?a+=1:"×"==h.ItemScore[e.selectcolumn]&&(s+=1);else if(2!=e.scoreType&&2==e.scoreTypeSub){for(var m=0;m<h.ItemScore.length;m++)if("-"!=h.ItemScore[m]){var p=h.ItemScore[m].split("@"),S=p[0]?isNaN(parseInt(p[0]))?0:parseInt(p[0]):0,b=p[1]?isNaN(parseInt(p[1]))?0:parseInt(p[1]):0,f=p[2]?isNaN(parseInt(p[2]))?0:parseInt(p[2]):0;m==e.selectcolumn&&(o+=S,r+=b,n+=f),i+=S,l+=b,c+=f}var g=Number(h.SubAccordScore),y=Number(h.SubScore);u+=isNaN(g)?0:g,d+=isNaN(y)?0:y}else if(2!=e.scoreType||3!=e.scoreTypeSub&&4!=e.scoreTypeSub&&5!=e.scoreTypeSub){if(2==e.scoreType&&6==e.scoreTypeSub){var v=h.ItemScore[e.selectcolumn].split("@"),C=h.CheckMenu.split(","),w=0;v.forEach(function(e){if(e=parseInt(e),!(isNaN(e)||e>=C.length)){var t=C[e].split("@")[1];t=Number(t),isNaN(t)||(w-=t)}}),Math.abs(w)>Number(h.SubScore)&&(w=-Number(h.SubScore)),t+=w}}else{var k=Number(h.ItemScore[e.selectcolumn]);t+=isNaN(k)?0:k}}),2!=this.scoreType&&1==this.scoreTypeSub){var h="100%";a+s!=0&&(h=(a/(a+s)*100).toFixed(2)+"%"),this.total.splice(this.selectcolumn,1,h)}else if(2!=this.scoreType&&2==this.scoreTypeSub){var m="总例数:"+(o+r+n)+",完全符合:"+o,p=this.selectcolumn;this.total.splice(p,1,m)}else 2!=this.scoreType||3!=this.scoreTypeSub&&5!=this.scoreTypeSub?2!=this.scoreType||4!=this.scoreTypeSub&&6!=this.scoreTypeSub||this.total.splice(this.selectcolumn+1,1,this.total[0]+t):this.total.splice(this.selectcolumn+1,1,t);if(2!=this.scoreType)if(2==this.scoreTypeSub){var S="100%";i+l+c!=0&&(S=(i/(i+l+c)*100).toFixed(2)+"%"),this.CheckInfo.Score=S,this.CheckInfo.CheckAccordScore=u,this.CheckInfo.CheckAccordScoreSum=d}else{var b=0;this.total.forEach(function(e,t){var s=Number(e.replace("%",""));b+=isNaN(s)?0:s}),this.CheckInfo.Score=this.total.length>0?(b/this.total.length).toFixed(2)+"%":"0%"}else if(2==this.scoreType){var f=0;this.total.forEach(function(e,t){if(0!=t){var s=Number(e);f+=isNaN(s)?0:s}}),this.CheckInfo.Score=this.total.length>1?(f/(this.total.length-1)).toFixed(2):0}},Save:function(e){var t=this;this.$refs.CheckInfo.validate(function(s){if(s){var a=t.params.TaskId+"^"+t.params.TaskItem+"^"+t.params.TaskWard+"^"+t.params.TaskType+"^"+t.CheckInfo.Date.Format("YYYY-MM-dd");a=(a=a+"^"+t.CheckInfo.Score+"^"+e+"^"+t.CheckInfo.Remark+"^"+t.params.ResultId)+"^"+t.CheckInfo.CheckAccordScore+"^"+t.CheckInfo.CheckAccordScoreSum+"^"+t.CheckScoreFlag;var o=[];t.InsertHead.indexOf(1)>-1?o.push(t.InsertHeadPat.join("^")):o.push(""),t.InsertHead.indexOf(2)>-1?o.push(t.InsertHeadNur.join("^")):o.push(""),t.InsertHead.indexOf(3)>-1?o.push(t.InsertHeadInput.join("^")):o.push(""),o=o.join("ˇ");var r="";t.TableData.forEach(function(e){var t="";e.ItemScore instanceof Array?e.ItemScore.forEach(function(e,s){t=0==s?e:t+","+e}):t=e.ItemScore,r=r?r+"ˇ"+e.QualSubId+"^"+t+"^"+e.ResultSubId+"^"+e.Remark+"^"+e.SubAccordScore:e.QualSubId+"^"+t+"^"+e.ResultSubId+"^"+e.Remark+"^"+e.SubAccordScore});var n=t.axiosConfig("web.INMQualControlComm","SaveQualCheck","Method","parr$"+a,"insert$"+o,"table$"+r,"nurseid$"+sessionStorage.getItem("loginID"));t.$ajax.request(n).then(function(e){!isNaN(Number(e.data))&&Number(e.data)>0?(t.$emit("CloseDialog"),t.$emit("LoadCheckList"),t.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"})):t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}})},Print:function(){var e=document.getElementById("schduleprint").innerHTML,t="<style>.NurQualCheckScoreCell{width:100%;height:100%;}.NurQualCheckScoreCell span{left:50%;transform:translateX(-50%);}</style>";t+="<style>.printNone{display:none;}table,tr,th,td{border:1px solid black!important;}</style>";var s="<html><head>"+(t+="<style>.printCheckInfo{display:block;}</style>")+"</head><body>"+e+"</body></html>",a=Object(l.a)();a.PRINT_INIT(""),a.SET_PRINT_PAGESIZE(2,"210mm","297mm","A4"),a.ADD_PRINT_HTM("0.1cm","0.1cm","RightMargin:0.1cm","BottomMargin:0.1cm",s),a.SET_SHOW_MODE("LANDSCAPE_DEFROTATED",1),a.PREVIEW(),this.PrintWhiteFlag=!1},PrintWhite:function(){var e=this;this.PrintWhiteFlag=!0,this.$nextTick(function(){e.Print()})},ReviewChange:function(e){"Y"==e.Review?e.ReviewDesc="复查通过":"N"==e.Review&&(e.ReviewDesc="复查未通过")},SaveReview:function(){var e=this,t="";this.TableData.forEach(function(e){"Y"==e.NeedReview&&(t=t?t+"^"+e.ResultSubId+","+e.Review:e.ResultSubId+","+e.Review)});var s=this.axiosConfig("web.INMQualControlComm","SaveReview","Method","parr$"+t,"nurseid$"+sessionStorage.loginID);this.$ajax.request(s).then(function(t){1==t.data?(e.$emit("CloseDialog"),e.$emit("LoadCheckList"),e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"})):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})},LoadWardPatient:function(){var e=this;this.WardPatientStore=[];var t=this.axiosConfig("web.INMHISComm","FindWardPatList","RecQuery","ward$"+this.params.TaskWard);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardPatientStore=t.data.rows:e.$message({type:"error",message:"获取病区患者失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取病区患者失败",showClose:!0,customClass:"error_class"})})},LoadWardNurse:function(){var e=this;this.WardNurseStore=[];var t=this.axiosConfig("web.INMHRComm","FindWardNurseList","RecQuery","ward$"+this.params.TaskWard);this.$ajax.request(t).then(function(t){t.data instanceof Object?e.WardNurseStore=t.data.rows:e.$message({type:"error",message:"获取病区人员失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取病区人员失败",showClose:!0,customClass:"error_class"})})},AddColumn:function(){var e=this;this.TableData.forEach(function(t,s){0==t.HasChild&&(2!=e.scoreType&&2==e.scoreTypeSub?t.ItemScore.push("@@"):2!=e.scoreType||3!=e.scoreTypeSub&&5!=e.scoreTypeSub?t.ItemScore.push(e.DefaultScore[s]):t.ItemScore.push(t.SubScore),(2!=e.scoreType&&2==e.scoreTypeSub||2==e.scoreType&&6==e.scoreTypeSub)&&t.ScoreToShow.push(""))}),this.InsertHead.indexOf(1)>-1&&this.InsertHeadPat.push(""),this.InsertHead.indexOf(2)>-1&&this.InsertHeadNur.push(""),this.InsertHead.indexOf(3)>-1&&this.InsertHeadInput.push(""),this.total.push(""),this.InsertCount+=1,this.selectcolumn=this.InsertCount-1,this.CalculateTotal(),this.$nextTick(function(){e.$refs["qual-check-table"].doLayout()})},DelColumn:function(e){var t=this;this.InsertCount-=1,this.TableData.forEach(function(s){0==s.HasChild&&(s.ItemScore.splice(e,1),(2!=t.scoreType&&2==t.scoreTypeSub||2==t.scoreType&&6==t.scoreTypeSub)&&s.ScoreToShow.splice(e,1))}),this.InsertHead.indexOf(1)>-1&&this.InsertHeadPat.splice(e,1),this.InsertHead.indexOf(2)>-1&&this.InsertHeadNur.splice(e,1),this.InsertHead.indexOf(3)>-1&&this.InsertHeadInput.splice(e,1),this.total.splice(e,1),this.$nextTick(function(){t.$refs["qual-check-table"].doLayout()})},GetPatName:function(e){var t=this.WardPatientStore.find(function(t){return t.PAPatMasId==e});return t?t.PatientName:""},GetNurName:function(e){var t=this.WardNurseStore.find(function(t){return t.Per==e});return t?t.PerName:""},Back:function(){var e=this,t=this.axiosConfig("web.INMQualControlComm","BackQualCheck","Method","id$"+this.params.ResultId);this.$ajax.request(t).then(function(t){e.DialogLoading=!1,1==t.data?(e.$emit("CloseDialog"),e.$emit("LoadCheckList"),e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"})):t.data.length<100?e.$message({type:"warning",message:t.data,showClose:!0,customClass:"warning_class"}):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}},created:function(){this.IsOverHlb=sessionStorage.getItem("loginRoleCodes").split(",").some(function(e){return"0"==e||"1"==e||"2"==e||"3"==e||"4"==e}),this.GetSchduleData(),this.LoadWardPatient(),this.LoadWardNurse(),this.Title=this.params.TaskItemDesc,"T"==this.params.TaskStatus?(this.CheckInfo.Date=new Date,this.params.TaskChecker&&this.params.TaskChecker.split(",").indexOf(sessionStorage.loginPerID)>-1||0==sessionStorage.loginID||""==this.params.TaskChecker?this.Editable=!0:this.Editable=!1,0==sessionStorage.loginID?this.CheckInfo.User="管理员":this.CheckInfo.User=sessionStorage.loginName):(sessionStorage.loginID!=this.params.TaskSubmitter&&0!=sessionStorage.loginID||"S"==this.params.TaskStatus?this.Editable=!1:this.Editable=!0,this.CheckInfo.User=this.params.TaskSubmitterName,this.CheckInfo.Date=new Date(this.params.TaskCheckDate)),this.CheckInfo.Ward=this.params.TaskWardDesc,this.CheckInfo.Score=this.params.TaskScore,this.CheckInfo.Status=this.params.TaskStatusDesc,this.CheckInfo.Remark=this.params.TaskRemark}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"checkscore-print-panel",staticStyle:{overflow:"auto",color:"#000"},style:{height:e.Height+10+"px"},attrs:{id:"schduleprint"}},[s("div",{staticStyle:{"font-size":"14px","text-align":"center",margin:"10px 0"}},[e._v(e._s(e.Title))]),e._v(" "),s("div",{staticClass:"top-tool-table-dialog-top dialog-div-top-radius"},[s("el-form",{ref:"CheckInfo",staticClass:"printNone",attrs:{model:e.CheckInfo,inline:!0,rules:e.rules}},[s("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbs9nf3c0"),prop:"User"}},[s("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.User,callback:function(t){e.$set(e.CheckInfo,"User",t)},expression:"CheckInfo.User"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq7qoc0"),prop:"Ward"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Ward,callback:function(t){e.$set(e.CheckInfo,"Ward",t)},expression:"CheckInfo.Ward"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq8wng0"),prop:"Date"}},[s("el-date-picker",{staticStyle:{width:"130px"},attrs:{disabled:!e.Editable,type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.CheckInfo.Date,callback:function(t){e.$set(e.CheckInfo,"Date",t)},expression:"CheckInfo.Date"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsq9vm40"),prop:"Score"}},[s("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Score,callback:function(t){e.$set(e.CheckInfo,"Score",t)},expression:"CheckInfo.Score"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsqauyo0"),prop:"Status"}},[s("el-input",{staticStyle:{width:"100px"},attrs:{disabled:"",size:"mini"},model:{value:e.CheckInfo.Status,callback:function(t){e.$set(e.CheckInfo,"Status",t)},expression:"CheckInfo.Status"}})],1),e._v(" "),s("el-form-item",[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-print"},on:{click:e.Print}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqaw9g0")))]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-print"},on:{click:e.PrintWhite}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqawmo0")))])],1)],1)],1),e._v(" "),s("div",{staticClass:"printCheckInfo",staticStyle:{"font-size":"16px"},domProps:{innerHTML:e._s(e.$t("menu.NurQualCheckScore.5nrnbsqbor80")+e.CheckInfo.User+e.$t("menu.NurQualCheckScore.5nrnbsqc9ao0")+e.CheckInfo.Ward+e.$t("menu.NurQualCheckScore.5nrnbsqcr1w0")+(e.CheckInfo.Date instanceof Date?e.CheckInfo.Date.Format("YYYY-MM-dd"):"")+e.$t("menu.NurQualCheckScore.5nrnbsqd7sk0")+e.CheckInfo.Score+e.$t("menu.NurQualCheckScore.5ncy6l1t4nk0")+e.CheckInfo.Status)}}),e._v(" "),s("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius",staticStyle:{overflow:"auto"}},[s("el-table",{ref:"qual-check-table",staticClass:"qual-check-score-table printNone",staticStyle:{width:"100%"},attrs:{data:e.TableData.filter(function(e){return 0==e.HasChild}),"span-method":e.QualSpan,height:e.Height-64-26-46-40-10-4,"show-summary":"","summary-method":e.GetSummary,"header-cell-style":e.headerCellFontWeight,border:e.styleCode}},[e._l(e.Deepth,function(t,a){return s("el-table-column",{key:a,attrs:{label:0==a?e.$t("menu.NurQualCheckScore.5nrnbsqfqa40"):"","column-key":"QualItem",fixed:""},scopedSlots:e._u([{key:"default",fn:function(s){return[e._v(e._s(e.TableData.find(function(e){return e.SubSort==s.row.SubSort.split(".").slice(0,t+1).join(".")}).SubItem))]}}],null,!0)})}),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("el-table-column",{attrs:{prop:"SubScore",label:e.$t("menu.NurQualCheckScore.5nrnbsqhzt80"),width:"80px",fixed:""}}):e._e(),e._v(" "),e._l(e.InsertCount,function(t,a){return s("el-table-column",{key:"score"+a,attrs:{"class-name":"qual-check-score-input-col",width:e.InsertHead.length>0?180:80},scopedSlots:e._u([{key:"header",fn:function(){return[e.InsertHead.indexOf(1)>-1?s("div",[s("el-select",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqiveo0"),clearable:"",size:"mini"},model:{value:e.InsertHeadPat[a],callback:function(t){e.$set(e.InsertHeadPat,a,t)},expression:"InsertHeadPat[index]"}},e._l(e.WardPatientStore,function(e){return s("el-option",{key:e.PAPatMasId,attrs:{label:e.PatientName,value:e.PAPatMasId}})}),1)],1):e._e(),e._v(" "),e.InsertHead.indexOf(2)>-1?s("div",[s("el-select",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqjpbc0"),clearable:"",size:"mini"},model:{value:e.InsertHeadNur[a],callback:function(t){e.$set(e.InsertHeadNur,a,t)},expression:"InsertHeadNur[index]"}},e._l(e.WardNurseStore,function(e){return s("el-option",{key:e.Per,attrs:{label:e.PerName,value:e.Per}})}),1)],1):e._e(),e._v(" "),e.InsertHead.indexOf(3)>-1?s("div",[s("el-input",{attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqkn100"),clearable:"",size:"mini"},model:{value:e.InsertHeadInput[a],callback:function(t){e.$set(e.InsertHeadInput,a,t)},expression:"InsertHeadInput[index]"}})],1):e._e(),e._v(" "),0==e.InsertHead.length?s("div",[e._v(e._s(4==e.scoreTypeSub?e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"):e.$t("menu.NurQualCheckScore.5nrnbsqlubs0")+t))]):e._e(),e._v(" "),s("el-button",0==a?{staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-circle-plus",size:"mini"},on:{click:e.AddColumn}}:{staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-remove",size:"mini"},on:{click:function(t){return e.DelColumn(a)}}})]},proxy:!0},{key:"default",fn:function(a){return[2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?s("input",{directives:[{name:"model",rawName:"v-model",value:a.row.ItemScore[t-1],expression:"scope.row['ItemScore'][insert-1]"}],staticStyle:{"text-align":"left"},attrs:{readonly:!e.Editable},domProps:{value:a.row.ItemScore[t-1]},on:{blur:function(s){return e.ChangeScore(a.row,t-1)},input:function(s){s.target.composing||e.$set(a.row.ItemScore,t-1,s.target.value)}}}):2==e.scoreType&&5==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,a.row,t-1,!1,!1)}}},[s("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(a.row.ItemScore[t-1]))])]):2==e.scoreType&&6==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,a.row,t-1,!1,!0)}}},[s("span",[e._v(e._s(a.row.ScoreToShow[t-1]))])]):2!=e.scoreType&&1==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,a.row,t-1,!1,!1)}}},[s("span",{staticStyle:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"}},[e._v(e._s(a.row.ItemScore[t-1]))])]):2!=e.scoreType&&2==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,a.row,t-1,!0,!1)}}},[s("span",[e._v(e._s(a.row.ScoreToShow[t-1]))])]):e._e()]}}],null,!0)})}),e._v(" "),1==e.params.Review?s("el-table-column",{attrs:{label:e.$t("menu.NurQualCheckScore.5nrnbsqp3gw0"),width:"180px",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{attrs:{disabled:!t.row.NeedReview||"N"==t.row.NeedReview,size:"mini"},on:{change:function(s){return e.ReviewChange(t.row)}},model:{value:t.row.Review,callback:function(s){e.$set(t.row,"Review",s)},expression:"scope.row['Review']"}},e._l(t.row.ReviewMenu,function(e,t){return s("el-option",{key:"option"+t,attrs:{value:e.value,label:e.label}})}),1)]}}],null,!1,3216757719)}):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("el-table-column",{attrs:{"class-name":"qual-check-score-input-col",label:e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"),width:"70px",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.row.SubAccordScore,expression:"scope.row['SubAccordScore']"}],staticStyle:{"text-align":"left",padding:"0 10px"},attrs:{readonly:!e.Editable},domProps:{value:t.row.SubAccordScore},on:{blur:function(s){return e.ChangeScore2(t.row)},input:function(s){s.target.composing||e.$set(t.row,"SubAccordScore",s.target.value)}}})]}}],null,!1,678372833)}):e._e(),e._v(" "),2==e.scoreTypeSub?e._l(e.Deepth,function(t,a){return s("el-table-column",{key:"Accord"+a,attrs:{label:0==a?e.$t("menu.NurQualCheckScore.5nrnbsqqn740"):"","column-key":"AccordPercent"},scopedSlots:e._u([{key:"default",fn:function(s){return[e._v(e._s(e.Deepth-t+1==s.row.SubSort.split(".").length-1?e.CalculateScore(s.row.ItemScore):e.Deepth-t+1>s.row.SubSort.split(".").length-1?"":e.CalculateFatherScore(s.row.SubSort.split(".").slice(0,e.Deepth-t+1+1+1).join("."))))]}}],null,!0)})}):e._e(),e._v(" "),s("el-table-column",{attrs:{prop:"Remark","class-name":"qual-check-score-input-col",label:e.$t("menu.NurQualCheckScore.5nrnbsqsewg0"),"min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.row.Remark,expression:"scope.row['Remark']"}],attrs:{readonly:!e.Editable},domProps:{value:t.row.Remark},on:{input:function(s){s.target.composing||e.$set(t.row,"Remark",s.target.value)}}})]}}])})],2),e._v(" "),s("table",{staticClass:"printCheckInfo",staticStyle:{width:"100%","border-collapse":"collapse",border:"1px solid #EBEEF5"},attrs:{cellspacing:"0",cellpadding:"0"}},[s("thead",[s("tr",{staticStyle:{"background-color":"#F5F7FA",color:"#101010"}},[s("th",{staticStyle:{"min-width":"300px"},style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqfqa40")))]),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("th",{staticStyle:{"min-width":"60px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqhzt80")))]):e._e(),e._v(" "),e._l(e.InsertCount,function(t,a){return s("th",{key:t,style:e.TdStyle},[e.InsertHead.indexOf(1)>-1?s("div",[s("el-select",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqiveo0"),clearable:"",size:"mini"},model:{value:e.InsertHeadPat[a],callback:function(t){e.$set(e.InsertHeadPat,a,t)},expression:"InsertHeadPat[index]"}},e._l(e.WardPatientStore,function(e){return s("el-option",{key:e.PAPatMasId,attrs:{label:e.PatientName,value:e.PAPatMasId}})}),1),e._v(" "),s("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.GetPatName(e.InsertHeadPat[a])))])],1):e._e(),e._v(" "),e.InsertHead.indexOf(2)>-1?s("div",[s("el-select",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqjpbc0"),clearable:"",size:"mini"},model:{value:e.InsertHeadNur[a],callback:function(t){e.$set(e.InsertHeadNur,a,t)},expression:"InsertHeadNur[index]"}},e._l(e.WardNurseStore,function(e){return s("el-option",{key:e.Per,attrs:{label:e.PerName,value:e.Per}})}),1),e._v(" "),s("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.GetNurName(e.InsertHeadNur[a])))])],1):e._e(),e._v(" "),e.InsertHead.indexOf(3)>-1?s("div",[s("el-input",{staticClass:"printNone",attrs:{disabled:!e.Editable,placeholder:e.$t("menu.NurQualCheckScore.5nrnbsqkn100"),clearable:"",size:"mini"},model:{value:e.InsertHeadInput[a],callback:function(t){e.$set(e.InsertHeadInput,a,t)},expression:"InsertHeadInput[index]"}}),e._v(" "),s("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.InsertHeadInput[a]))])],1):e._e(),e._v(" "),0==e.InsertHead.length?s("span",[e._v(e._s(4==e.scoreTypeSub?e.$t("menu.NurQualCheckScore.5nrnbsql8hc0"):e.$t("menu.NurQualCheckScore.5nrnbsqlubs0")+t))]):e._e(),e._v(" "),s("el-button",0==a?{staticClass:"printNone",staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-circle-plus",size:"mini"},on:{click:e.AddColumn}}:{staticClass:"printNone",staticStyle:{width:"auto",padding:"0"},attrs:{disabled:!e.Editable,type:"text",icon:"el-icon-remove",size:"mini"},on:{click:function(t){return e.DelColumn(a)}}})],1)}),e._v(" "),1==e.params.Review?s("th",{style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqp3gw0")))]):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("th",{style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsql8hc0")))]):e._e(),e._v(" "),2==e.scoreTypeSub?s("th",{staticStyle:{"min-width":"100px"},style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqqn740")))]):e._e(),e._v(" "),s("th",{staticStyle:{"min-width":"120px"},style:e.TdStyle},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsqsewg0")))])],2)]),e._v(" "),s("tbody",[e._l(e.TableData,function(t,a){return[0==t.HasChild?s("tr",{key:"item"+a},[e._l(t.Roots,function(t,a){return[s("td",{key:a,style:e.TdStyle,attrs:{rowspan:e.GetFatherRowSpan(t)}},e._l(e.GetFatherDesc(t).split("「"),function(t,a){return s("li",{key:a,staticStyle:{"list-style-type":"none"}},[e._v("\n                                    "+e._s(t)+"\n                                ")])}),0)]}),e._v(" "),s("td",{style:e.TdStyle,attrs:{colspan:e.Deepth-t.SubSort.split(".").length+2}},e._l(t.SubItem.split("「"),function(t,a){return s("li",{key:a,staticStyle:{"list-style-type":"none"}},[e._v("\n                                "+e._s(t)+"\n                            ")])}),0),e._v(" "),2==e.scoreType||2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(t.SubScore))]):e._e(),e._v(" "),e._l(e.InsertCount,function(a){return s("td",{key:"score"+a,staticStyle:{position:"relative",overflow:"hidden"},style:[e.TdStyle,{width:2==e.scoreTypeSub?"200px":"120px"}],attrs:{align:"center"}},[2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?s("div",{staticClass:"printCheckInfo",staticStyle:{"text-align":"center",border:"none"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[a-1]))]):e._e(),e._v(" "),2==e.scoreType&&5!=e.scoreTypeSub&&6!=e.scoreTypeSub?s("input",{directives:[{name:"model",rawName:"v-model",value:t.ItemScore[a-1],expression:"item['ItemScore'][InsertIndex-1]"}],staticClass:"printNone",staticStyle:{width:"100%",height:"100%","text-align":"center",border:"none"},attrs:{readonly:!e.Editable},domProps:{value:t.ItemScore[a-1]},on:{blur:function(s){return e.ChangeScore(t,a-1)},input:function(s){s.target.composing||e.$set(t.ItemScore,a-1,s.target.value)}}}):2==e.scoreType&&5==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,t,a-1,!1,!1)}}},[s("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[a-1]))])]):2==e.scoreType&&6==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,t,a-1,!1,!0)}}},[s("span",[e._v(e._s(e.PrintWhiteFlag?"":t.ScoreToShow[a-1]))])]):2!=e.scoreType&&1==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,t,a-1,!1,!1)}}},[s("span",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"}},[e._v(e._s(e.PrintWhiteFlag?"":t.ItemScore[a-1]))])]):2!=e.scoreType&&2==e.scoreTypeSub?s("div",{staticClass:"NurQualCheckScoreCell",on:{click:function(s){return e.CellClickEvent(s,t,a-1,!0,!1)}}},[s("span",[e._v(e._s(e.PrintWhiteFlag?"":t.ScoreToShow[a-1]))])]):e._e()])}),e._v(" "),1==e.params.Review?s("td",{staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[s("el-select",{staticClass:"printNone",attrs:{disabled:!t.NeedReview||"N"==t.NeedReview,size:"mini"},on:{change:function(s){return e.ReviewChange(t)}},model:{value:t.Review,callback:function(s){e.$set(t,"Review",s)},expression:"item.Review"}},e._l(t.ReviewMenu,function(e,t){return s("el-option",{key:"option"+t,attrs:{value:e.value,label:e.label}})}),1),e._v(" "),s("div",{staticClass:"printCheckInfo",staticStyle:{"text-align":"center"}},[e._v(e._s(t.ReviewDesc))])],1):e._e(),e._v(" "),2==e.scoreTypeSub?["Y"==e.CheckScoreFlag?s("td",{staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[s("div",{staticClass:"printCheckInfo"},[e._v(e._s(e.PrintWhiteFlag?"":t.SubAccordScore))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.SubAccordScore,expression:"item['SubAccordScore']"}],staticClass:"printNone",staticStyle:{width:"100%",height:"100%","text-align":"center",border:"none"},attrs:{readonly:!e.Editable},domProps:{value:t.SubAccordScore},on:{blur:function(s){return e.ChangeScore2(t)},input:function(s){s.target.composing||e.$set(t,"SubAccordScore",s.target.value)}}})]):e._e(),e._v(" "),s("td",{staticStyle:{width:"70px"},style:e.TdStyle,attrs:{colspan:e.Deepth-t.SubSort.split(".").length+2}},[e._v(e._s(e.PrintWhiteFlag?"":e.CalculateScore(t.ItemScore)))]),e._v(" "),e._l(e.GetReverseRoots(t.Roots),function(t,a){return[s("td",{key:a+"-",staticStyle:{width:"70px"},style:e.TdStyle,attrs:{rowspan:e.GetFatherRowSpan(t)}},[e._v("\n                                    "+e._s(e.PrintWhiteFlag?"":e.CalculateFatherScore(t))+"\n                                ")])]})]:e._e(),e._v(" "),s("td",{directives:[{name:"dragMove",rawName:"v-dragMove"}],staticStyle:{position:"relative",width:"120px"},style:e.TdStyle},[s("p",{staticClass:"printCheckInfo",staticStyle:{width:"120px","word-break":"break-all","word-wrap":"break-word"}},[e._v(e._s(e.PrintWhiteFlag?"":t.Remark))]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Remark,expression:"item['Remark']"}],staticClass:"printNone",staticStyle:{border:"none",width:"99%",height:"100%",resize:"vertical"},attrs:{readonly:!e.Editable},domProps:{value:t.Remark},on:{input:function(s){s.target.composing||e.$set(t,"Remark",s.target.value)}}})])],2):e._e()]}),e._v(" "),s("tr",{staticStyle:{"background-color":"#F5F7FA"}},[s("td",{style:e.TdStyle,attrs:{colspan:e.Deepth}},[e._v(e._s("合计"))]),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.CheckAccordScoreSum))]):e._e(),e._v(" "),e._l(e.total,function(t,a){return s("td",{key:a,style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":t))])}),e._v(" "),1==e.params.Review?s("td",{style:e.TdStyle}):e._e(),e._v(" "),2==e.scoreTypeSub&&"Y"==e.CheckScoreFlag?s("td",{style:e.TdStyle,attrs:{align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.CheckAccordScore))]):e._e(),e._v(" "),2==e.scoreTypeSub?s("td",{style:e.TdStyle,attrs:{colspan:e.Deepth,align:"center"}},[e._v(e._s(e.PrintWhiteFlag?"":e.CheckInfo.Score))]):e._e(),e._v(" "),s("td",{style:e.TdStyle})],2)],2)])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"10px"}},[s("div",{staticClass:"printCheckInfo",staticStyle:{border:"1px solid black","border-top":"0","min-height":"100px"}},[e._v(e._s(e.CheckInfo.Remark))]),e._v(" "),s("el-input",{staticClass:"printNone",attrs:{disabled:!e.Editable,type:"textarea",size:"small",maxlength:1e3,"show-word-limit":"",rows:2},model:{value:e.CheckInfo.Remark,callback:function(t){e.$set(e.CheckInfo,"Remark",t)},expression:"CheckInfo.Remark"}})],1),e._v(" "),s("div",{staticClass:"printNone bottom-button"},[e.params.Review?e._e():s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Save,time:500,status:"N"},expression:"{func:Save,time:500,status:'N'}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode,disabled:!e.Editable}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr06gg0")))]),e._v(" "),e.params.Review?e._e():s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Save,time:500,status:"S"},expression:"{func:Save,time:500,status:'S'}"}],staticStyle:{width:"120px"},attrs:{type:"default",styleCode:e.styleCode,disabled:!e.Editable}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07700")))]),e._v(" "),e.params.Review?e._e():s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.Back,time:500},expression:"{func:Back,time:500}"}],attrs:{type:"default",styleCode:e.styleCode,disabled:!e.IsOverHlb||"S"!=e.params.TaskStatus}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07jg0")))]),e._v(" "),1==e.params.Review?s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveReview,time:500},expression:"{func:SaveReview,time:500}"}],attrs:{type:"default",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr06gg0")))]):e._e(),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.$emit("CloseDialog")}}},[e._v(e._s(e.$t("menu.NurQualCheckScore.5nrnbsr07zg0")))])],1),e._v(" "),s("vue-context-menu",{ref:"cellContextMenu",attrs:{contextMenuData:e.contextMenuData},on:{MarkScore:e.MarkScore,change:e.HandleCountChange,checkChange:e.HandleCheckChange}})],1)},staticRenderFns:[]};var d=s("VU/8")(c,u,!1,function(e){s("nMRI")},null,null);t.default=d.exports}});