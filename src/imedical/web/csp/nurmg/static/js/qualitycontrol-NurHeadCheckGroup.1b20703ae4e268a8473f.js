webpackJsonp([288],{fI4R:function(e,t){},wMoD:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("Dd8w"),r=s.n(o),a=s("NYxO"),n=s("XlQt"),l=s("z8xk"),i=s("doZQ"),c={components:{hgpanel:l.default,hgbutton:n.default,hgswitch:i.default},name:"NurHeadCheckGroup",computed:r()({},Object(a.b)(["Height","styleCode"])),data:function(){return{loading:!1,elrowstyle:{height:"20px"},CheckTypeStore:[],SysNurHeadStore:[],GroupTool:{GroupType:"",GroupMode:""},SysFinds:{input:""},CheckFinds:{input:"",type:""},CheckPerGroup:[],CheckPerstore:[],SysSelection:[],CheckSelection:[],DialogVisible:!1,EditForm:{name:""},EditRules:{name:[{required:!0,message:"组名不为空",trigger:"blur"}]},LastSelection:[],CheckerPost:"护士长!科护士长!副护士长",winFlag:0}},watch:{"GroupTool.GroupType":function(e,t){this.GroupTypeChange(e)},"CheckFinds.type":function(e,t){this.LoadCheckPersons()}},methods:{LoadGroupType:function(){var e=this,t=e.axiosConfig("web.INMQualControlComm","FindQualTypeList","RecQuery","type$N");e.$ajax.request(t).then(function(t){t.data instanceof Object?(e.CheckTypeStore=t.data.rows,e.CheckTypeStore.length>0&&(e.GroupTool.GroupType=e.CheckTypeStore[0].rw)):e.$message({type:"error",message:"获取类型失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取类型失败",showClose:!0,customClass:"error_class"})})},GroupTypeChange:function(e){var t=this.CheckTypeStore.find(function(t){return e==t.rw});t&&(this.GroupTool.GroupMode="TRUE"==t.SubValue.toUpperCase()?"TRUE":"FALSE"),this.LoadNurseHead(),this.LoadGroupForType()},LoadNurseHead:function(){var e=this;if(e.GroupTool.GroupType){var t=e.GroupTool.GroupType,s=e.SysFinds.input;e.SysNurHeadStore=new Array,e.$ajax.request(e.axiosConfig("web.INMQualControlComm","FindNurseForType","RecQuery","type$"+t,"post$"+this.CheckerPost,"input$"+s)).then(function(t){t instanceof Object?e.SysNurHeadStore=t.data.rows:e.$message({type:"error",message:"获取系统护士长失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取系统护士长失败",showClose:!0,customClass:"error_class"})})}else e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},LoadGroupForType:function(e){var t=this,s=t.GroupTool.GroupType;if(s){var o=t.axiosConfig("web.INMQualControlComm","FindNurCheckGroupList","RecQuery","type$"+s);t.$ajax.request(o).then(function(s){s.data instanceof Object?(t.CheckPerGroup=s.data.rows,e&&t.CheckPerGroup.length>0?t.CheckFinds.type=e:t.CheckPerGroup.length>0?t.CheckFinds.type=t.CheckPerGroup[0].GroupDesc:t.CheckFinds.type=""):(t.CheckFinds.type="",t.$message({type:"error",message:"获取分组失败",showClose:!0,customClass:"error_class"}))}).catch(function(e){t.CheckFinds.type="",t.$message({type:"error",message:"获取分组失败",showClose:!0,customClass:"error_class"})})}else t.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},LoadCheckPersons:function(e){var t=this,s=t.GroupTool.GroupType;if(s){var o=t.CheckFinds.type,r=t.CheckFinds.input;t.$ajax.request(t.axiosConfig("web.INMQualControlComm","FindGroupPersonList","RecQuery","type$"+s,"group$"+o,"input$"+r)).then(function(s){s instanceof Object?(t.CheckPerstore=s.data.rows,e&&t.$nextTick(function(){t.LastSelection.forEach(function(e){var s=t.CheckPerstore.find(function(t){return e.rw==t.rw});s&&t.$refs.CheckPerstore.toggleRowSelection(s,!0)})})):t.$message({type:"error",message:"获取分组成员失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取分组成员失败",showClose:!0,customClass:"error_class"})})}else t.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},GroupModeChange:function(e){var t=this;t.loading=!0;var s=t.axiosConfig("web.INMQualControlComm","ChangeNurCheckGroupMode","Method","type$"+t.GroupTool.GroupType,"mode$"+t.GroupTool.GroupMode);t.$ajax.request(s).then(function(s){if(t.loading=!1,1==s.data){var o=t.CheckTypeStore.find(function(e){return e.rw==t.GroupTool.GroupType});o&&(o.SubValue=e),t.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"})}else t.GroupTool.GroupMode="TRUE"==e?"FALSE":"TRUE",t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(s){t.loading=!1,t.GroupTool.GroupMode="TRUE"==e?"FALSE":"TRUE",t.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})},AddGroup:function(){var e=this;this.winFlag=0,this.DialogVisible=!0,this.$nextTick(function(){e.$refs.EditForm.resetFields()})},SaveClick:function(){var e=this,t=e.GroupTool.GroupType;t?e.$refs.EditForm.validate(function(s){if(s){if(-1!=e.CheckPerGroup.findIndex(function(t){return t==e.EditForm.name}))return void e.$message({type:"warning",message:"名称重复",showClose:!0,customClass:"warning_class"});e.EditForm.name=e.EditForm.name.toUpperCase(),e.CheckPerGroup.push({GroupDesc:e.EditForm.name,GroupType:t}),e.CheckFinds.type=e.EditForm.name,e.DialogVisible=!1}}):e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},DeleteGroup:function(){var e=this,t=e.GroupTool.GroupType;if(t){var s=e.CheckFinds.type;s?e.$confirm("此操作将删除该组所有关联病区, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warning",closeOnClickModal:!1}).then(function(){e.$ajax.request(e.axiosConfig("web.INMQualControlComm","DeleteNurCheckGroup","Method","type$"+t,"group$"+s)).then(function(t){1==t.data?(e.$message({type:"success",message:"删除成功",showClose:!0,customClass:"success_class"}),e.LoadNurseHead(),e.LoadGroupForType()):e.$message({type:"error",message:"删除失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"连接服务器失败",showClose:!0,customClass:"error_class"})})}).catch(function(t){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):e.$message({type:"warning",message:"请选择要删除的组",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},IsSelectPer:function(e){return"1"==e.Flag&&"TRUE"==this.GroupTool.GroupMode?1:0},SysRowClick:function(e){"1"==e.Flag&&"TRUE"==this.GroupTool.GroupMode&&this.$refs.SysNurHeadStore.toggleRowSelection(e)},CheckRowClick:function(e){this.$refs.CheckPerstore.toggleRowSelection(e)},SysSelectionChange:function(e){this.SysSelection=e},CheckSelectionChange:function(e){this.CheckSelection=e},MoveLeft:function(){var e=this,t=e.GroupTool.GroupType,s=e.CheckFinds.type;if(t)if(s){var o=e.CheckSelection.map(function(e){return e.rw}).join("^");o?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","RemoveNurGroupPerson","Method","type$"+t,"group$"+s,"parr$"+o)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),e.LoadNurseHead(),e.LoadCheckPersons()):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择检查人员",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择右侧组别",showClose:!0,customClass:"warning_class"});else e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},MoveRight:function(){var e=this,t=e.GroupTool.GroupType,s=e.CheckFinds.type;if(t)if(s){var o=e.SysSelection.map(function(e){return e.Per}).join("^");o?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","AddNurGroupPerson","Method","type$"+t,"group$"+s,"parr$"+o)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),e.LoadNurseHead(),e.LoadCheckPersons()):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择系统护士长",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择右侧组别",showClose:!0,customClass:"warning_class"});else e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},MoveRec:function(e){var t=this;if(t.CheckSelection&&0!=t.CheckSelection.length){t.CheckSelection.sort(function(e,t){return e.GroupSort-t.GroupSort}),"D"==e&&t.CheckSelection.reverse();for(var s="",o=0;o<t.CheckSelection.length;o++){var r=t.CheckSelection[o];if(1==r.GroupSort&&"U"==e)return void t.$message({type:"warning",message:"所选记录存在最上方，不可上移",showClose:!0,customClass:"warning_class"});if(t.CheckPerstore.indexOf(r)==t.CheckPerstore.length-1&&"D"==e)return void t.$message({type:"warning",message:"所选记录存在最下方，不可下移",showClose:!0,customClass:"warning_class"});s=""==s?r.rw:s+","+r.rw}t.LastSelection=t.CheckSelection,t.$ajax.request(t.axiosConfig("web.INMQualControlComm","MoveCheckNur","Method","type$"+e,"parr$"+s)).then(function(e){1==e.data?t.LoadCheckPersons(!0):t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}else t.$message({type:"warning",message:"请选择要移动的行",showClose:!0,customClass:"warning_class"})},IsSelectable:function(){return"TRUE"==this.GroupTool.GroupMode?1:0},IsDisable:function(){return"TRUE"!=this.GroupTool.GroupMode},LoadCheckerParram:function(){var e=this,t=this.axiosConfig("web.INMSetComm","FindParamSubList","RecQuery","parr$^NightCheckerPost");this.$ajax.request(t).then(function(t){t.data instanceof Object&&t.data.rows.length>0&&(e.CheckerPost=t.data.rows.map(function(e){return e.SubValue}).join("!"))}).catch(function(t){e.$message({type:"error",message:"获取参数失败",showClose:!0,customClass:"error_class"})})}},created:function(){this.LoadCheckerParram(),this.LoadGroupType()}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"nurhead-check-group-panel",attrs:{"element-loading-text":e.$t("menu.NurHeadCheckGroup.5nrnbrlzd280")}},[s("div",{staticClass:"top-tool-inputDiv"},[s("el-form",{attrs:{model:e.GroupTool,inline:!0,"label-position":"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrm26180")}},[s("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"","default-first-option":"",size:"mini"},model:{value:e.GroupTool.GroupType,callback:function(t){e.$set(e.GroupTool,"GroupType",t)},expression:"GroupTool.GroupType"}},e._l(e.CheckTypeStore,function(e){return s("el-option",{key:e.rw,attrs:{label:e.SubDesc,value:e.rw}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5ncy6kpw8jo0")}},[s("hgswitch",{staticStyle:{width:"100px"},attrs:{"active-text":e.$t("menu.NurHeadCheckGroup.5nrnbrm3sq40"),"inactive-text":e.$t("menu.NurHeadCheckGroup.5ncy6kpw9dc0"),"active-value":"TRUE","inactive-value":"FALSE",disabled:e.GroupTool.length>0},on:{change:e.GroupModeChange},model:{value:e.GroupTool.GroupMode,callback:function(t){e.$set(e.GroupTool,"GroupMode",t)},expression:"GroupTool.GroupMode"}})],1)],1)],1),e._v(" "),s("div",[s("el-row",{staticStyle:{padding:"10px 12px 10px 10px"}},[s("el-col",{attrs:{span:11}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurHeadCheckGroup.5ncy6kpwadw0"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[s("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[s("el-form",{attrs:{model:e.SysFinds,inline:!0,align:"left"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",[s("el-input",{staticStyle:{width:"140px"},attrs:{"suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search",disabled:e.IsDisable(),size:"mini",placeholder:e.$t("menu.NurHeadCheckGroup.5ncy6kpwblo0")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadNurseHead(t)}},model:{value:e.SysFinds.input,callback:function(t){e.$set(e.SysFinds,"input",t)},expression:"SysFinds.input"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"SysNurHeadStore",staticClass:"dialog-table-bottom-radius",staticStyle:{width:"100%","border-bottom":"0"},attrs:{data:e.SysNurHeadStore,height:e.Height-169,border:e.styleCode,"header-cell-style":e.headerCellFontWeight,"highlight-current-row":""},on:{"selection-change":e.SysSelectionChange,"row-click":e.SysRowClick}},[s("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{type:"selection",align:"center",width:"55",selectable:e.IsSelectPer}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrm7trk0"),prop:"PerName",width:"80","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrm94r00"),prop:"WardDesc","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5ncy6kpwh5s0"),prop:"Group",width:"80","show-overflow-tooltip":""}})],1)],1)])],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"bottom-button",staticStyle:{width:"100%",margin:"0 auto"},style:{height:e.Height-67+"px"}},[s("div",{staticStyle:{"padding-bottom":"20px"},style:{"padding-top":(e.Height-107)/2+"px"}},[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.SysSelection||0==e.SysSelection.length},on:{click:e.MoveRight}},[s("i",{class:e.styleCode?"el-icon-arrow-right":"nm-icon-lite-right-arrow"})])],1),e._v(" "),s("div",[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.CheckSelection||0==e.CheckSelection.length},on:{click:e.MoveLeft}},[s("i",{class:e.styleCode?"el-icon-arrow-left":"nm-icon-lite-left-arrow"})])],1)])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurHeadCheckGroup.5nrnbrma5u00"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[s("div",{attrs:{slot:"tool"},slot:"tool"},[s("div",{staticClass:"panel-button-space"},[s("el-form",{attrs:{model:e.CheckFinds,inline:!0}},[s("el-form-item",[s("el-input",{staticStyle:{width:"110px"},attrs:{disabled:e.IsDisable(),placeholder:e.$t("menu.NurHeadCheckGroup.5ncy6kpwblo0"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadCheckPersons(t)}},model:{value:e.CheckFinds.input,callback:function(t){e.$set(e.CheckFinds,"input",t)},expression:"CheckFinds.input"}})],1),e._v(" "),s("el-form-item",[s("el-select",{staticStyle:{width:"80px"},attrs:{disabled:e.IsDisable(),filterable:"",size:"mini",placeholder:e.$t("menu.NurHeadCheckGroup.5ncy6kpwh5s0")},on:{change:e.LoadCheckPersons},model:{value:e.CheckFinds.type,callback:function(t){e.$set(e.CheckFinds,"type",t)},expression:"CheckFinds.type"}},e._l(e.CheckPerGroup,function(e){return s("el-option",{key:e.GroupDesc,attrs:{value:e.GroupDesc,label:e.GroupDesc}})}),1)],1),e._v(" "),s("el-form-item",[s("hgbutton",{staticStyle:{width:"40px"},attrs:{type:"default",styleCode:e.styleCode,disabled:e.IsDisable()},on:{click:e.AddGroup}},[e._v("+")]),e._v(" "),s("hgbutton",{staticStyle:{width:"40px !important"},attrs:{type:"default",styleCode:e.styleCode,disabled:e.IsDisable()},on:{click:e.DeleteGroup}},[e._v("-")]),e._v(" "),s("hgbutton",{staticStyle:{width:"40px"},attrs:{type:"default",styleCode:e.styleCode,disabled:e.IsDisable()},on:{click:function(t){return e.MoveRec("U")}}},[e._v("↑")]),e._v(" "),s("hgbutton",{staticStyle:{width:"40px"},attrs:{type:"default",styleCode:e.styleCode,disabled:e.IsDisable()},on:{click:function(t){return e.MoveRec("D")}}},[e._v("↓")])],1)],1)],1)]),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"CheckPerstore",staticStyle:{"border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.CheckPerstore,height:e.Height-169,"header-cell-style":e.headerCellFontWeight,"row-style":e.elrowstyle,"highlight-current-row":!0,border:e.styleCode},on:{"selection-change":e.CheckSelectionChange,"row-click":e.CheckRowClick}},[s("el-table-column",{attrs:{type:"selection",align:"center",width:"55",selectable:e.IsSelectable}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrm7trk0"),prop:"PerName",width:"80","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrm94r00"),prop:"WardDesc","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrmd0ik0"),prop:"GroupSort",width:"50",align:"center"}})],1)],1)])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.$t("menu.NurHeadCheckGroup.5nrnbrmf49c0"),visible:e.DialogVisible,"close-on-click-modal":!1,width:"300px",modal:"",align:"center"},on:{"update:visible":function(t){e.DialogVisible=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{staticClass:"nm-icon-w-plus"}):e._e(),e._v(" "),s("span",[e._v(e._s(e.$t("menu.NurHeadCheckGroup.5nrnbrmf49c0")))])]),e._v(" "),s("el-form",{ref:"EditForm",attrs:{model:e.EditForm,rules:e.EditRules,"label-width":"64px",inline:!0,"label-position":"right",align:"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.NurHeadCheckGroup.5nrnbrmgbrc0"),prop:"name"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:e.$t("menu.NurHeadCheckGroup.5nrnbrmhaxc0")},model:{value:e.EditForm.name,callback:function(t){e.$set(e.EditForm,"name",t)},expression:"EditForm.name"}})],1)],1),e._v(" "),s("div",{staticClass:"bottom-button"},[s("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode},on:{click:e.SaveClick}},[e._v(e._s(e.$t("menu.NurHeadCheckGroup.5nrnbrmhc0w0")))]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.DialogVisible=!1}}},[e._v(e._s(e.$t("menu.NurHeadCheckGroup.5nrnbrmhcdc0")))])],1)],1)],1)},staticRenderFns:[]};var p=s("VU/8")(c,u,!1,function(e){s("fI4R")},null,null);t.default=p.exports}});