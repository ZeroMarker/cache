webpackJsonp([120],{"543u":function(e,t){},TmV0:function(e,t,o){o("fZOM"),e.exports=o("FeBl").Object.values},XKDF:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("gRE1"),r=o.n(n),a=o("fZjL"),s=o.n(a),l=o("woOf"),i=o.n(l),c=o("Dd8w"),d=o.n(c),m=o("/dO2"),u=o("NYxO"),h=o("XlQt"),f=(o("W5Fe"),o("z8xk")),v=o("doZQ"),g={components:{hgpanel:f.default,hgbutton:h.default,hgswitch:v.default},name:"PersonItemSet",computed:d()({},Object(u.b)(["Height","DeveloperMode","styleCode"])),data:function(){return{ItemForm:{defaultModel:{ItemCode:"",ItemDesc:"",SortIdx:1,ShowFlag:"Y"},Model:{ItemCode:"",ItemDesc:"",SortIdx:1,ShowFlag:"Y"},Rules:{ItemCode:[{required:!0,message:"项目代码不能为空"}],ItemDesc:[{required:!0,message:"项目名称不能为空"}]}},showItemDialog:!1,tableData:[],currentRow:{},winFlag:0}},created:function(){this.loadData()},mounted:function(){document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},this.initSortable()},methods:{handleCurrentChange:function(e){this.currentRow=e},handleDblClick:function(e){this.onEdit(e),this.showItemDialog=!0},submit:function(){var e=this,t=this.packageParam(this.ItemForm.Model),o=i()({},{ClassName:"web.INMPersonComm",MethodName:"SavePerItemTab",MethodType:"Method"},{parr:t});this.$refs.formRef.validate(function(t){t&&e.asyncRequest(o).then(function(t){1==t.data?(e.showItemDialog=!1,e.nurMessage.success("提交表单成功"),e.loadData()):e.nurMessage.error(t.data)})})},close:function(){this.showItemDialog=!1},onUpMove:function(e){var t=e.$index,o=e.$index-1;this.moveItem(o,t)},onDownMove:function(e){var t=e.$index,o=e.$index+1;this.moveItem(o,t)},onAdd:function(){var e=this;this.winFlag=0;this.asyncRequest({ClassName:"web.INMPersonComm",MethodName:"GetNextSortIdx",MethodType:"RecMethod"}).then(function(t){var o=t.data.NextSort;e.ItemForm.Model=i()({},e.ItemForm.defaultModel,{SortIdx:o}),e.showItemDialog=!0})},onEdit:function(e){this.winFlag=1,i()(this.ItemForm.Model,e),this.showItemDialog=!0},getShowInfo:function(e){return"Y"===e?{desc:"显示",color:"#07C160"}:{desc:"隐藏",color:"#ff3d2c"}},initSortable:function(){var e=this,t=this.$refs.tableRef.$el.querySelector(".el-table__body > tbody");m.a.create(t,{animation:150,handle:".sortable-handle",filter:".sortable-disabled",dragClass:"sortable-drag",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",onEnd:function(t){var o=t.newIndex,n=t.oldIndex;e.moveItem(o,n)},onUpdate:function(e){e.newIndex,e.oldIndex}})},moveItem:function(e,t){if(e!==t){var o=this.sortItem(e,t),n=this.packArrayParam(o);this.asyncSortPerItem(n)}},sortItem:function(e,t){var o=this.deepClone(this.tableData),n=this.deepClone(this.tableData),r=n.splice(t,1)[0];n.splice(e,0,r);for(var a=0;a<n.length;a++)n[a].SortIdx=a+1;o.sort(function(e,t){return e.rw-t.rw}),n.sort(function(e,t){return e.rw-t.rw});for(var s=[],l=0;l<n.length;l++){var i=o[l].SortIdx,c=n[l].SortIdx;i!==c&&s.push({rw:o[l].rw,SortIdx:c})}return s},asyncSortPerItem:function(e){var t=this,o=i()({},{ClassName:"web.INMPersonComm",MethodName:"SortBatchPerItemTab",MethodType:"Method"},{parr:e});this.asyncRequest(o).then(function(e){1==e.data?(t.nurMessage.success("排序成功"),t.loadData()):t.nurMessage.error("排序失败:"+e.data)}).catch(function(){return t.nurMessage.error("网络走丢了")})},loadData:function(){var e=this;this.asyncRequest({ClassName:"web.INMPersonComm",MethodName:"FindPerItemTab",MethodType:"RecQuery"}).then(function(t){e.tableData=t.data.rows}).catch()},packArrayParam:function(e){if(!Array.isArray(e)||!e.length||!s()(e[0]).length)return"";var t=s()(e[0]).join("@"),o=[];return e.forEach(function(e){var t=r()(e);o.push(t.join("@"))}),[t,o.join("|")].join("^")}}},p={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"person-item-set"},[o("div",{staticClass:"top-tool-button",style:{height:e.DeveloperMode?e.styleCode?"36px":"32px":"2px"}},[e.DeveloperMode?o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.onAdd}},[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6oga880")))]):e._e(),e._v(" "),e.DeveloperMode?o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-edit":"nm-icon-lite-write-order"},on:{click:function(t){return e.onEdit(e.currentRow)}}},[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6ogb1s0")))]):e._e()],1),e._v(" "),o("div",{staticClass:"top-tool-table"},[o("el-table",{ref:"tableRef",staticStyle:{"border-bottom":"0"},attrs:{data:e.tableData,border:e.styleCode,"header-cell-style":e.headerCellFontWeight,"row-key":"rw",height:e.DeveloperMode?e.styleCode?e.Height-45+"px":e.Height-41+"px":e.Height-11+"px","highlight-current-row":""},on:{"row-dblclick":e.handleDblClick,"current-change":e.handleCurrentChange}},[e.DeveloperMode?o("el-table-column",{attrs:{label:e.$t("menu.PersonItemSet.5ncy6trsi640"),align:"center",width:"60"}},[[o("hgbutton",{staticClass:"sortable-handle",attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-dragsort":"nm-icon-lite-dragsort"}})]],2):e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"ItemDesc",label:e.$t("menu.PersonItemSet.5nrnc6ohq5c0"),width:"180",align:"left"}}),e._v(" "),o("el-table-column",{attrs:{prop:"ItemCode",label:e.$t("menu.PersonItemSet.5ncy6trsjm80"),width:"180",align:"left"}}),e._v(" "),o("el-table-column",{attrs:{prop:"SortIdx",label:e.$t("menu.PersonItemSet.5nrnc6oiugo0"),width:"160",align:"left"}}),e._v(" "),o("el-table-column",{attrs:{prop:"ShowFlag",label:e.$t("menu.PersonItemSet.5nrnc6ojqdk0"),align:"left",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{style:{color:e.getShowInfo(t.row.ShowFlag).color}},[e._v(e._s(t.row.ShowFlagDesc))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.PersonItemSet.5nrnc6okunk0"),prop:"CreateTime",align:"left"}}),e._v(" "),e.DeveloperMode?o("el-table-column",{attrs:{label:e.$t("menu.PersonItemSet.5nrnc6olsds0"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-edit":"nm-icon-lite-write-order"},on:{click:function(o){return e.onEdit(t.row)}}}),e._v(" "),o("hgbutton",{directives:[{name:"show",rawName:"v-show",value:t.$index>0,expression:"scope.$index > 0"}],attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-up":"nm-icon-lite-up"},on:{click:function(o){return e.onUpMove(t)}}}),e._v(" "),o("hgbutton",{directives:[{name:"show",rawName:"v-show",value:t.$index<e.tableData.length-1,expression:"scope.$index < tableData.length - 1"}],attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-down":"nm-icon-lite-down"},on:{click:function(o){return e.onDownMove(t)}}})]}}],null,!1,1118764604)}):e._e()],1)],1),e._v(" "),o("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:0==e.winFlag?e.$t("menu.PersonItemSet.5nrnc6oga880"):e.$t("menu.PersonItemSet.5nrnc6ogb1s0"),visible:e.showItemDialog,"close-on-click-modal":!1,width:"384px"},on:{"update:visible":function(t){e.showItemDialog=t}}},[o("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?o("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?o("span",[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6oga880")))]):1==e.winFlag?o("span",[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6ogb1s0")))]):e._e()]),e._v(" "),o("el-form",{ref:"formRef",attrs:{model:e.ItemForm.Model,rules:e.ItemForm.Rules,"label-width":"120px","label-position":"right",inline:!0,align:"left"}},[o("el-form-item",{attrs:{prop:"ItemCode",label:e.$t("menu.PersonItemSet.5ncy6trsjm80")}},[e.ItemForm.Model.rw?o("span",{staticStyle:{color:"#000"}},[e._v(e._s(e.ItemForm.Model.ItemCode))]):o("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.ItemForm.Model.ItemCode,callback:function(t){e.$set(e.ItemForm.Model,"ItemCode",t)},expression:"ItemForm.Model.ItemCode"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"ItemDesc",label:e.$t("menu.PersonItemSet.5nrnc6ohq5c0")}},[o("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.ItemForm.Model.ItemDesc,callback:function(t){e.$set(e.ItemForm.Model,"ItemDesc",t)},expression:"ItemForm.Model.ItemDesc"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"SortIdx",label:e.$t("menu.PersonItemSet.5nrnc6oiugo0")}},[o("el-input-number",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.ItemForm.Model.SortIdx,callback:function(t){e.$set(e.ItemForm.Model,"SortIdx",t)},expression:"ItemForm.Model.SortIdx"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"ShowFlag",label:e.$t("menu.PersonItemSet.5nrnc6ojqdk0")}},[o("hgswitch",{attrs:{size:"mini","active-value":"Y","inactive-value":"N","inactive-text":e.$t("menu.PersonItemSet.5ncy6trsoso0"),"active-text":e.$t("menu.PersonItemSet.5ncy6trsovg0")},model:{value:e.ItemForm.Model.ShowFlag,callback:function(t){e.$set(e.ItemForm.Model,"ShowFlag",t)},expression:"ItemForm.Model.ShowFlag"}})],1)],1),e._v(" "),o("div",{staticClass:"bottom-button"},[o("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.submit,time:500},expression:"{func:submit,time:500}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6ooi3k0")))]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:e.close}},[e._v(e._s(e.$t("menu.PersonItemSet.5nrnc6ooino0")))])],1)],1)],1)},staticRenderFns:[]};var I=o("VU/8")(g,p,!1,function(e){o("543u")},null,null);t.default=I.exports},fZOM:function(e,t,o){var n=o("kM2E"),r=o("mbce")(!1);n(n.S,"Object",{values:function(e){return r(e)}})},gRE1:function(e,t,o){e.exports={default:o("TmV0"),__esModule:!0}},mbce:function(e,t,o){var n=o("+E39"),r=o("lktj"),a=o("TcQ7"),s=o("NpIQ").f;e.exports=function(e){return function(t){for(var o,l=a(t),i=r(l),c=i.length,d=0,m=[];c>d;)o=i[d++],n&&!s.call(l,o)||m.push(e?[o,l[o]]:l[o]);return m}}}});