webpackJsonp([209],{Od0w:function(e,t){},bRvV:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("Dd8w"),a=s.n(o),n=s("NYxO"),i=s("XlQt"),l=s("W5Fe"),r={components:{hgbutton:i.default,hgpagination:l.default},computed:a()({},Object(n.b)(["Height","styleCode"])),name:"SetCode",data:function(){return{inputdesc:"",toolForm:{inputDesc:""},tabledata:[],subtabledata:[],pagesize:20,criteria:"",currentPage:1,totalCount:0,setcodeflag:!1,subcodeflag:!1,subitmflag:!1,selectrow:"",editform:{SetCode:"",SetDesc:"",SetRemark:"",RowID:""},subform:{subCode:"",subDesc:"",subRemark:"",subStDate:new Date,subEndDate:"",subSymbol:"",Par:"",raw:"",subSort:1,subFiterSymbol:""},subselectrow:"",rules:{SetCode:[{required:!0,message:"请输入代码",trigger:"blur"}],SetDesc:[{required:!0,message:"请输入描述",trigger:"blur"}]},subrules:{subCode:[{required:!0,message:"请输入代码",tirgger:"blur"}],subDesc:[{required:!0,message:"请输入描述",tirgger:"blur"}],subStDate:[{required:!0,message:"请选择启用日期",tirgger:"change",type:"date"}]},elementlist:[],winFlag:0}},watch:{currentPage:function(e,t){this.LoadSetCodeData()}},beforeCreate:function(){var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)},created:function(){this.LoadSetCodeData()},methods:{DescChange:function(){this.LoadSetCodeData()},SelectChange:function(e,t){this.subselectrow=e.par+"||"+e.raw},RowSubDblClick:function(e,t){var s=this;s.winFlag=1,e?(s.subitmflag=!0,s.$ajax.request(s.axiosConfig("web.INMDBComm","GetSubItem","RecMethod","id$"+e.par+"||"+e.raw)).then(function(e){s.$refs.subform.resetFields(),s.$nextTick(function(){s.setForm(s.$refs.subform,s.subform,e.data)})})):s.$message({type:"warning",message:"请选择要编辑的行!",showClose:!0,customClass:"warning_class"})},SaveSetCode:function(){var e=this,t="";for(var s in e.editform){var o=e.editform[s];t=t+"^"+s+"|"+o}this.$refs.editform.validate(function(s){if(!s)return!1;e.$ajax.request(e.axiosConfig("web.INMDBComm","SaveSetCode","Method","parr$"+t)).then(function(t){1==t.data?(e.setcodeflag=!1,e.$message({message:"更新成功！",type:"success",showClose:!0,customClass:"success_class"}),e.LoadSetCodeData()):(e.$message({message:t.data+"!更新失败！",type:"info",showClose:!0,customClass:"info_class"}),e.LoadSetCodeData())})})},AddSubCode:function(){var e=this;e.winFlag=0,e.subitmflag=!0,e.subform.raw="",e.$nextTick(function(){e.$refs.subform.resetFields(),e.$ajax.request(e.axiosConfig("web.INMDBComm","ComCodeSubSort","Method","par$"+e.selectrow)).then(function(t){e.subform.subSort=t.data})})},UpSort:function(){var e=this;e.subselectrow?e.$ajax.request(e.axiosConfig("web.INMDBComm","SetCodeSubSort","Method","rowid$"+e.subselectrow,"type$up")).then(function(t){0==t.data&&e.$message({type:"warning",message:"已经置顶了",showClose:!0,customClass:"warning_class"}),e.LoadSubItems(e.selectrow,e.inputdesc)}):this.$message({message:"请选择要移动的行",type:"warning",showClose:!0,customClass:"warning_class"})},DownSort:function(){var e=this;e.subselectrow?e.$ajax.request(e.axiosConfig("web.INMDBComm","SetCodeSubSort","Method","rowid$"+e.subselectrow,"type$down")).then(function(t){1==t.data&&e.$message({type:"warning",message:"已经置底了",showClose:!0,customClass:"warning_class"}),e.LoadSubItems(e.selectrow,e.inputdesc)}):this.$message({message:"请选择要移动的行",type:"warning",showClose:!0,customClass:"warning_class"})},SaveSubForm:function(){var e=this,t=this,s="";for(var o in t.subform)if("Par"==o)s=s?s+"^Par|"+this.selectrow:"Par|"+this.selectrow;else{var a=t.subform[o];a||(a=""),s=a instanceof Date?s?s+"^"+o+"|"+a.Format("YYYY-MM-dd"):o+"|"+a.Format("YYYY-MM-dd"):s?s+"^"+o+"|"+a:o+"|"+a}t.$refs.subform.validate(function(o){o&&t.$ajax.request(t.axiosConfig("web.INMDBComm","SaveSubCode","Method","parr$"+s)).then(function(s){if(1==s.data)t.subitmflag=!1,t.subselectrow="",t.LoadSubItems(t.selectrow,t.inputdesc),t.$message({message:"更新成功！",type:"success",showClose:!0,customClass:"success_class"});else if(2==s.data)return void t.$message({type:"warning",message:"此记录已经存在！",showClose:!0,customClass:"warning_class"});""==s.data&&e.$message({message:"更新失败！",type:"error",showClose:!0,customClass:"error_class"})})})},LinkSubCode:function(){if(this.selectrow){var e=this.selectrow;this.subcodeflag=!0,this.inputdesc="",this.LoadSubItems(e,this.inputdesc)}else this.$message({type:"warning",message:"请选择行记录",showClose:!0,customClass:"warning_class"})},RowClick:function(e,t){this.selectrow=e.setrw},RowDblClick:function(e,t){var s=this;s.winFlag=1,s.selectrow=e.setrw,s.setcodeflag=!0,s.$ajax.request(s.axiosConfig("web.INMDBComm","GetSetCode","RecMethod","id$"+e.setrw)).then(function(e){s.editform=e.data})},InputChange:function(){this.LoadSubItems(this.selectrow,this.inputdesc)},LoadSubItems:function(e,t){var s=this;s.$ajax.request(s.axiosConfig("web.INMDBComm","FindSetSubCode","RecQuery","substr$"+e,"input$"+t)).then(function(e){s.subtabledata=e.data.rows})},SubHandleClose:function(e){e(),this.subselectrow=""},HandleClose:function(e){e()},SetCodeFlag:function(e){this.setcodeflag=e},HandleSizeChange:function(e){this.pagesize=e,this.LoadSetCodeData()},HandleCurrentChange:function(e){this.currentPage=e.currentPage,this.LoadSetCodeData()},LoadSetCodeData:function(){var e=this;e.$ajax.request(e.axiosConfig("web.INMDBComm","FindSetCodes","RecQuery","setstr$"+e.toolForm.inputDesc,"start$"+(e.currentPage-1)*e.pagesize,"limit$"+e.pagesize)).then(function(t){e.tabledata=t.data.rows,e.totalCount=parseInt(t.data.results),e.selectrow=""})},ClearSetCode:function(){for(var e in this.editform)this.editform[e]=""},AddSetCode:function(){this.winFlag=0,this.ClearSetCode(),this.selectrow="",this.setcodeflag=!0;try{this.$refs[editform].resetFields()}catch(e){}}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"code-set-panel"},[s("div",{staticClass:"top-tool-inputDiv"},[s("el-form",{attrs:{model:e.toolForm,inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",[s("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:e.$t("menu.CodeSet.5nrnaw7a0bs0"),size:"mini"},on:{change:e.DescChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadSetCodeData(t)}},model:{value:e.toolForm.inputDesc,callback:function(t){e.$set(e.toolForm,"inputDesc",t)},expression:"toolForm.inputDesc"}})],1),e._v(" "),s("el-form-item",[e.elementlist.codesearch?s("hgbutton",{ref:"codesearch",attrs:{type:"default",styleCode:e.styleCode,icon:"el-icon-search"},on:{click:e.LoadSetCodeData}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a1r00")))]):e._e()],1)],1)],1),e._v(" "),s("div",{staticClass:"top-tool-button"},[e.elementlist.codeadd?s("hgbutton",{ref:"codeadd",attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.AddSetCode}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q80")))]):e._e(),e._v(" "),s("hgbutton",{ref:"codeadd",attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-edit":"nm-icon-lite-write-order"},on:{click:e.LinkSubCode}},[e._v(e._s(e.$t("menu.CodeSet.5ncy62xzdyk0")))])],1),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"setCodeTable",attrs:{"header-cell-style":e.headerCellFontWeight,"highlight-current-row":!0,data:e.tabledata,border:e.styleCode,height:e.styleCode?e.Height-130:e.Height-124,"default-sort":{prop:"index",order:"asc"}},on:{"row-dblclick":e.RowDblClick,"row-click":e.RowClick}},[s("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"SetCode",label:e.$t("menu.CodeSet.5nrnaw7bm4k0"),"show-overflow-tooltip":"",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"SetDesc",label:e.$t("menu.CodeSet.5nrnaw7cqi80"),"show-overflow-tooltip":"",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"SetRemark",label:e.$t("menu.CodeSet.5nrnaw7ec940"),"show-overflow-tooltip":"",width:""}}),e._v(" "),e._e()],1),e._v(" "),s("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.totalCount,pageNumber:e.currentPage,pageSize:e.pagesize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:0==e.winFlag?e.$t("menu.CodeSet.5nrnaw7a2q80"):e.$t("menu.CodeSet.5nrnaw7a2q81"),modal:"",visible:e.setcodeflag,"close-on-click-modal":!1,width:"337px","before-close":e.HandleClose},on:{"update:visible":function(t){e.setcodeflag=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?s("span",[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q80")))]):1==e.winFlag?s("span",[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q81")))]):e._e()]),e._v(" "),s("el-form",{ref:"editform",attrs:{model:e.editform,"label-width":"100px",rules:e.rules,inline:!0,"label-position":"right",align:"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7bm4k0"),prop:"SetCode"}},[s("el-input",{attrs:{disabled:!!e.editform.RowID,size:"mini"},model:{value:e.editform.SetCode,callback:function(t){e.$set(e.editform,"SetCode",t)},expression:"editform.SetCode"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7cqi80"),prop:"SetDesc"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.editform.SetDesc,callback:function(t){e.$set(e.editform,"SetDesc",t)},expression:"editform.SetDesc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7ec940"),prop:"SetRemark"}},[s("el-input",{attrs:{size:"mini"},model:{value:e.editform.SetRemark,callback:function(t){e.$set(e.editform,"SetRemark",t)},expression:"editform.SetRemark"}})],1)],1),e._v(" "),s("div",{staticClass:"bottom-button"},[s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveSetCode,time:500},expression:"{func:SaveSetCode,time:500}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jfyo0")))]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.setcodeflag=!1}}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jgm80")))])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.$t("menu.CodeSet.5ncy62xzdyk0"),modal:"",visible:e.subcodeflag,"close-on-click-modal":!1,"custom-class":"el-dialog_list","before-close":e.SubHandleClose},on:{"update:visible":function(t){e.subcodeflag=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{staticClass:"nm-icon-w-edit"}):e._e(),e._v(" "),s("span",[e._v(e._s(e.$t("menu.CodeSet.5ncy62xzdyk0")))])]),e._v(" "),s("div",{staticClass:"top-tool-button-dialog-toph dialog-div-top-radius"},[s("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"",size:"mini","suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search"},on:{change:e.InputChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.InputChange(t)}},model:{value:e.inputdesc,callback:function(t){e.inputdesc=t},expression:"inputdesc"}})],1),e._v(" "),s("div",{staticClass:"top-tool-single-sides"},[s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.AddSubCode}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q80")))]),e._v(" "),s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-up":"nm-icon-lite-up"},on:{click:e.UpSort}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jjbw0")))]),e._v(" "),s("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-down":"nm-icon-lite-down"},on:{click:e.DownSort}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jjqc0")))])],1),e._v(" "),s("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius"},[s("el-table",{ref:"subtabledata",staticClass:"dialog-table-bottom-radius",attrs:{"header-cell-style":e.headerCellFontWeight,"highlight-current-row":!0,data:e.subtabledata,border:e.styleCode,height:"300"},on:{"row-click":e.SelectChange,"row-dblclick":e.RowSubDblClick}},[s("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7bm4k0"),prop:"SubCode","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7cqi80"),prop:"SubDesc","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5ncy62xzonk0"),prop:"SubSymbol"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7njvs0"),width:"60",prop:"SubRemark"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.row.SubRemark,expression:"scope.row['SubRemark']"}],staticStyle:{width:"100%","vertical-align":"middle"},attrs:{color:e.row.SubRemark,size:"mini"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7ooa80"),width:"100",prop:"SubStDate",formatter:e.PTableDateHisShow}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7q4s00"),width:"100",prop:"SubEndDate",formatter:e.PTableDateHisShow}}),e._v(" "),e._e(),e._v(" "),e._e()],1)],1)]),e._v(" "),s("el-dialog",{attrs:{title:0==e.winFlag?e.$t("menu.CodeSet.5nrnaw7a2q80"):e.$t("menu.CodeSet.5nrnaw7a2q81"),modal:"",visible:e.subitmflag,"close-on-click-modal":!1,width:"344px","before-close":e.HandleClose},on:{"update:visible":function(t){e.subitmflag=t}}},[s("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?s("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?s("span",[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q80")))]):1==e.winFlag?s("span",[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7a2q81")))]):e._e()]),e._v(" "),s("div",[s("el-form",{ref:"subform",attrs:{model:e.subform,rules:e.subrules,"label-width":"100px",inline:"","label-position":"right",align:"left"}},[s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7bm4k0"),prop:"subCode"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",disabled:!!e.subform.raw},model:{value:e.subform.subCode,callback:function(t){e.$set(e.subform,"subCode",t)},expression:"subform.subCode"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7cqi80"),prop:"subDesc"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.subform.subDesc,callback:function(t){e.$set(e.subform,"subDesc",t)},expression:"subform.subDesc"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:e.$t("menu.CodeSet.5nrnaw7njvs0"),prop:"subRemark"}},[s("el-color-picker",{attrs:{size:"mini"},model:{value:e.subform.subRemark,callback:function(t){e.$set(e.subform,"subRemark",t)},expression:"subform.subRemark"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-top":"-10px"},attrs:{label:e.$t("menu.CodeSet.5ncy62xzonk0"),prop:"subSymbol"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.subform.subSymbol,callback:function(t){e.$set(e.subform,"subSymbol",t)},expression:"subform.subSymbol"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5ncy62xzufg0"),prop:"subFiterSymbol"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.subform.subFiterSymbol,callback:function(t){e.$set(e.subform,"subFiterSymbol",t)},expression:"subform.subFiterSymbol"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7ooa80"),prop:"subStDate"}},[s("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.subform.subStDate,callback:function(t){e.$set(e.subform,"subStDate",t)},expression:"subform.subStDate"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("menu.CodeSet.5nrnaw7q4s00"),prop:"subEndDate"}},[s("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.subform.subEndDate,callback:function(t){e.$set(e.subform,"subEndDate",t)},expression:"subform.subEndDate"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"bottom-button"},[s("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveSubForm,time:500},expression:"{func:SaveSubForm,time:500}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jfyo0")))]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.subitmflag=!1}}},[e._v(e._s(e.$t("menu.CodeSet.5nrnaw7jgm80")))])],1)])],1)},staticRenderFns:[]};var d=s("VU/8")(r,u,!1,function(e){s("Od0w")},null,null);t.default=d.exports}});