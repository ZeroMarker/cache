webpackJsonp([255],{"XYs+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Dd8w"),a=i.n(n),s=i("NYxO"),l=i("XlQt"),r=i("z8xk"),o={components:{hgbutton:l.default,Hgpanel:r.default},computed:a()({},Object(s.b)(["Height","SysTomcat","LoginId","DateFormat","MonthFormat","styleCode","Width"])),name:"PersonHeadUpload",id:"PersonHeadUpload",data:function(){return{filelength:1,fileindex:0,status:"",percentage:0,limitstr:"",noperstr:"",repeatstr:"",height:"",ward:{},browserWidth:0}},methods:{handleuploadClick:function(){return document.getElementById("fileupload").click()},UploadMethod:function(e,t,i){var n=this;n.$ajax.request(n.axiosConfig("web.INMPersonComm","IsExistByHISNo","Method","realname$"+t)).then(function(t){var a=t.data.split("^");if("0"===a[0]){var s="images/head&filename="+a[1];n.$ajax.post(n.SysTomcat+"Fileupdate/servlet/VueFileuploadServlet?filesname="+s,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){var t=e.data.split(":");if(n.fileindex=n.fileindex+1,n.percentage=parseInt(n.fileindex/n.filelength*100),"success"===t[0]){var i=a[1]+"^"+t[1];n.$ajax.request(n.axiosConfig("web.INMPersonComm","saveperpic","Method","parr$"+i)).then(function(e){})}else this.$message.error(t[1])})}else n.fileindex=n.fileindex+1,n.percentage=parseInt(n.fileindex/n.filelength*100),n.noperstr=n.noperstr+i+"、"})},UploadCert:function(e){var t=e.target.files||e.dataTransfer.files;if(0==t.length)return!1;this.filelength=t.length,this.fileindex=0,this.percentage=0===this.filelength?0:parseInt(this.fileindex/this.filelength*100),this.limitstr="",this.noperstr="",this.repeatstr="";for(var i=new Array,n=new Array,a=0;a<t.length;a++){var s=(r=t[a].name).split("."),l=r.substring(0,r.lastIndexOf("."+s[s.length-1]));-1==i.indexOf(l)?i.push(l):n.push(l)}for(a=0;a<t.length;a++){var r;s=(r=t[a].name).split("."),l=r.substring(0,r.lastIndexOf("."+s[s.length-1]));if(this.limitImg(t[a]))if(n.indexOf(l)>-1)this.fileindex=this.fileindex+1,this.percentage=parseInt(this.fileindex/this.filelength*100),this.repeatstr=this.repeatstr+r+"、";else{var o=l.split("^")[0],d=l.split("^")[1],p=new FormData;p.append("file",t[a]),this.UploadMethod(p,o+"^"+d,r)}else this.fileindex=this.fileindex+1,this.percentage=parseInt(this.fileindex/this.filelength*100),this.limitstr=this.limitstr+r+"、"}document.getElementById("fileupload").value=""},limitImg:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,i=e.size/1024/128,n=e.name.split("^");return!(n.length<1||0==n[0].length)&&(!!t&&!!i)},loadWardData:function(){var e=this,t=e.axiosConfig("web.INMDBComm","FindInuseWardList","RecQuery");e.$ajax.request(t).then(function(t){for(var i=t.data.rows,n=new Object,a=0;a<i.length;a++)n[i[a].WardDesc]=i[a].rw;e.ward=n})}},created:function(){this.height=this.$store.state.mainframe.Height-133+"px",this.loadWardData(),this.browserWidth=window.innerWidth}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"head-upload-panel"},[i("div",{staticClass:"panel-button-bottom"},[i("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:e.handleuploadClick}},[e._v(e._s(e.$t("menu.PersonHeadUpload.5ncy6fudqfw0")))]),e._v(" "),i("span",{staticStyle:{size:"10px",color:"#999","line-height":"30px",height:"30px",display:"inline-block","vertical-align":"middle"}},[e._v(e._s(e.$t("menu.PersonHeadUpload.5ncy6fudr300")))]),e._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"fileupload",type:"file",multiple:"",webkitdirectory:""},on:{change:e.UploadCert}})],1),e._v(" "),i("div",{staticStyle:{padding:"5px 10px"}},[i("el-progress",{attrs:{percentage:e.percentage}})],1),e._v(" "),i("div",{staticClass:"headupload"},[i("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.PersonHeadUpload.5ncy6fudut40"),styleCode:e.styleCode,icon:"#nm-icon-paper-table",panelHeight:e.Height-97}},[i("div",{staticStyle:{"overflow-y":"auto"},style:{height:e.height-10}},[i("el-row",[0!=e.limitstr.length?i("hgpanel",{staticStyle:{margin:"10px 10px 0 10px"},style:{width:e.browserWidth-250},attrs:{title:e.$t("menu.PersonHeadUpload.5ncy6fudvos0"),styleCode:e.styleCode,icon:"#nm-icon-paper-table",panelHeight:150}},[i("div",{staticStyle:{"overflow-y":"auto",padding:"10px 10px"}},[i("span",[e._v(e._s(e.limitstr.substring(0,e.limitstr.length-1)))])])]):e._e()],1),e._v(" "),i("el-row",[0!=e.repeatstr.length?i("hgpanel",{staticStyle:{margin:"10px 10px 0 10px"},style:{width:e.browserWidth-250},attrs:{title:e.$t("menu.PersonHeadUpload.5ncy6fudwdc0"),styleCode:e.styleCode,icon:"#nm-icon-paper-table",panelHeight:150}},[i("div",{staticStyle:{"overflow-y":"auto",padding:"10px 10px"}},[i("span",[e._v(e._s(e.repeatstr.substring(0,e.repeatstr.length-1)))])])]):e._e()],1),e._v(" "),i("el-row",[0!=e.noperstr.length?i("hgpanel",{staticStyle:{margin:"10px 10px 0 10px"},style:{width:e.browserWidth-250},attrs:{title:e.$t("menu.PersonHeadUpload.5ncy6fudx140"),styleCode:e.styleCode,icon:"#nm-icon-paper-table",panelHeight:150}},[i("div",{staticStyle:{"overflow-y":"auto",padding:"10px 10px"}},[i("span",[e._v(e._s(e.noperstr.substring(0,e.noperstr.length-1)))])])]):e._e()],1)],1)])],1)])},staticRenderFns:[]};var p=i("VU/8")(o,d,!1,function(e){i("vmFb")},null,null);t.default=p.exports},vmFb:function(e,t){}});