webpackJsonp([219],{WTc7:function(e,o){},oMK0:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t("Dd8w"),a=t.n(r),s=t("NYxO"),l=t("W5Fe"),i={name:"SpecialGroupScore",components:{hgbutton:t("XlQt").default,hgpagination:l.default},computed:a()({},Object(s.b)(["Height","styleCode"])),data:function(){return{elementlist:{},ToolForm:{Group:"",Name:"",StDate:new Date((new Date).setDate(1)),EndDate:(new Date).getMonthDate((new Date).getMonthDay())},GroupStore:[],TableData:[],TableDataAll:[],CurrentPage:1,PageSize:20,TotalCount:0,SelectRow:{},ScoreDialogVisible:!1,ScoreLoading:!1,ScoreForm:{Group:"",Per:"",Motivation:0,Contribute:0,rw:""},Rules:{Group:[{required:!0,message:"请选择专业组",trigger:"change"}],Per:[{required:!0,message:"请选择人员",trigger:"change"}],Motivation:[{required:!0,message:"请选择填写积极性得分",trigger:"blur"}],Contribute:[{required:!0,message:"请选填写实际贡献情况得分",trigger:"blur"}]},GroupPerStore:[],winFlag:0}},methods:{LoadRoleGroup:function(){var e=this;this.GroupStore=[];var o=this.axiosConfig("web.INMSpecialComm","FindRoleGroupList","RecQuery","nurseid$"+sessionStorage.loginID);this.$ajax.request(o).then(function(o){o.data instanceof Object?e.GroupStore=o.data.rows:e.$message({type:"error",message:"获取权限专业组失败",showClose:!0,customClass:"error_class"})}).catch(function(o){e.$message({type:"error",message:"获取权限专业组失败",showClose:!0,customClass:"error_class"})})},ToolFormSearch:function(){var e=this,o=(this.CurrentPage-1)*this.PageSize,t=this.PageSize,r=this.ToolForm.Group,a=this.ToolForm.Name,s="";this.ToolForm.StDate instanceof Date&&(s=this.ToolForm.StDate.Format("YYYY-MM-dd"));var l="";this.ToolForm.EndDate instanceof Date&&(l=this.ToolForm.EndDate.Format("YYYY-MM-dd"));var i=r+"^"+a+"^"+s+"^"+l;this.TableData=[];var n=this.axiosConfig("web.INMSpecialComm","FindGroupScoreList","RecQuery","parr$"+i,"nurseid$"+sessionStorage.loginID);this.$ajax.request(n).then(function(r){r.data instanceof Object?(e.TableData=r.data.rows.slice(o,o+t),e.TableDataAll=r.data.rows,e.TotalCount=parseInt(r.data.results)):e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"}),e.SelectRow=""}).catch(function(o){e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"})})},AddClick:function(){var e=this;this.winFlag=0,this.ScoreForm.rw="",this.ScoreDialogVisible=!0,this.$nextTick(function(){e.$refs.ScoreForm.resetFields()})},FormGroupChange:function(){this.ScoreForm.Per="",this.LoadGroupMember()},LoadGroupMember:function(){var e=this;this.GroupPerStore=[];var o=this.ScoreForm.Group+"^"+(new Date).Format("YYYY-MM-dd"),t=this.axiosConfig("web.INMSpecialComm","FindMemberList","RecQuery","parr$"+o);this.$ajax.request(t).then(function(o){o.data instanceof Object?e.GroupPerStore=o.data.rows:e.$message({type:"error",message:"获取专业组成员列表失败",showClose:!0,customClass:"error_class"})}).catch(function(o){e.$message({type:"error",message:"获取专业组成员列表失败",showClose:!0,customClass:"error_class"})})},SaveScore:function(){var e=this;this.$refs.ScoreForm.validate(function(o){if(o){var t=e.ScoreForm.Group+"^"+e.ScoreForm.Per+"^"+e.ScoreForm.Motivation+"^"+e.ScoreForm.Contribute+"^"+e.ScoreForm.rw;e.ScoreLoading=!0;var r=e.axiosConfig("web.INMSpecialComm","SaveGroupScore","Method","parr$"+t,"nurseid$"+sessionStorage.loginID);e.$ajax.request(r).then(function(o){e.ScoreLoading=!1,1==o.data?(e.ScoreDialogVisible=!1,e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}),e.ToolFormSearch()):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(o){e.ScoreLoading=!1,e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}})},LoadScoreForm:function(){var e=this;this.ScoreLoading=!0;var o=this.axiosConfig("web.INMSpecialComm","GetGroupScore","RecMethod","id$"+this.SelectRow.rw);this.$ajax.request(o).then(function(o){e.ScoreLoading=!1,o.data instanceof Object?(e.ScoreForm.Group=o.data.ScoreGroup,e.ScoreForm.Per=o.data.ScorePer,e.ScoreForm.Motivation=o.data.ScoreMotivation,e.ScoreForm.Contribute=o.data.ScoreContribute,e.ScoreForm.rw=o.data.rw,e.LoadGroupMember()):(e.ScoreDialogVisible=!1,e.$message({type:"error",message:"获取记录内容失败",showClose:!0,customClass:"error_class"}))}).catch(function(o){e.ScoreLoading=!1,e.ScoreDialogVisible=!1,e.$message({type:"error",message:"获取记录内容失败",showClose:!0,customClass:"error_class"})})},DeleteClick:function(){var e=this;this.SelectRow&&this.SelectRow.rw?this.$confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",closeOnClickModal:!1,type:"warning"}).then(function(){var o=e.axiosConfig("web.INMSpecialComm","DeleteGroupScore","Method","id$"+e.SelectRow.rw);e.$ajax.request(o).then(function(o){1==o.data?(e.$message({message:"删除成功",type:"success",showClose:!0,customClass:"success_class"}),e.ToolFormSearch()):e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})}).catch(function(o){e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})})}).catch(function(){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):this.$message({type:"warning",message:"请先选中一行数据",showClose:!0,customClass:"warning_class"})},RowClick:function(e,o,t){this.SelectRow=e},RowDblClick:function(e,o,t){var r=this;this.winFlag=1,this.SelectRow=e,this.ScoreForm.rw="",this.ScoreDialogVisible=!0,this.$nextTick(function(){r.$refs.ScoreForm.resetFields(),r.LoadScoreForm()})},HandleSizeChange:function(e){this.PageSize=e,this.ToolFormSearch()},HandleCurrentChange:function(e){this.CurrentPage=e.currentPage,this.ToolFormSearch()}},created:function(){this.LoadRoleGroup(),this.ToolFormSearch();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)}},n={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"special-groupscore-panel"},[t("div",{staticClass:"top-tool-inputDiv"},[t("el-form",{attrs:{model:e.ToolForm,inline:!0,"label-position":"left"}},[t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1noec00"),prop:"Group"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini"},model:{value:e.ToolForm.Group,callback:function(o){e.$set(e.ToolForm,"Group",o)},expression:"ToolForm.Group"}},e._l(e.GroupStore,function(e){return t("el-option",{key:e.SubValue,attrs:{label:e.SubDesc,value:e.SubValue}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1npdbw0"),prop:"Name"}},[t("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:e.$t("menu.SpecialGroupScore.5nrnc1nqnn00"),size:"mini"},model:{value:e.ToolForm.Name,callback:function(o){e.$set(e.ToolForm,"Name",o)},expression:"ToolForm.Name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1ns3nk0")}},[t("el-date-picker",{staticStyle:{width:"120px"},attrs:{clearable:"",type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.ToolForm.StDate,callback:function(o){e.$set(e.ToolForm,"StDate",o)},expression:"ToolForm.StDate"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1nt47o0")}},[t("el-date-picker",{staticStyle:{width:"120px"},attrs:{clearable:"",type:"date",format:this.$store.state.mainframe.DateFormat,size:"mini"},model:{value:e.ToolForm.EndDate,callback:function(o){e.$set(e.ToolForm,"EndDate",o)},expression:"ToolForm.EndDate"}})],1),e._v(" "),t("el-form-item",[t("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.ToolFormSearch}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt5nc0")))])],1)],1)],1),e._v(" "),t("div",{staticClass:"top-tool-button"},[0==this.$store.state.login.LoginId||e.elementlist.scoreadd?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.AddClick}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt6d00")))]):e._e(),e._v(" "),0==this.$store.state.login.LoginId||e.elementlist.scoredelete?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-cancel":"nm-icon-lite-cancel"},on:{click:e.DeleteClick}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt72o0")))]):e._e(),e._v(" "),t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-export":"nm-icon-lite-export"},on:{click:function(o){e.exportData("TableData",e.TableDataAll,e.$t("menu.SpecialGroupScore.5ncy6r7d83g0"))}}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt7mg0")))])],1),e._v(" "),t("div",{staticClass:"top-tool-table"},[t("el-table",{ref:"TableData",attrs:{data:e.TableData,"header-cell-style":e.headerCellFontWeight,"highlight-current-row":"",border:e.styleCode,height:e.styleCode?e.Height-130:e.Height-124},on:{"row-click":e.RowClick,"row-dblclick":e.RowDblClick}},[t("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1npdbw0"),prop:"ScorePerName",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1noec00"),prop:"ScoreGroupDesc","show-overflow-tooltip":"",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fouk0"),prop:"ScoreMotivation","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fp7g0"),prop:"ScoreContribute","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fpik0"),prop:"ScoreTotal","show-overflow-tooltip":""}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fptg0"),prop:"UpdatorName","show-overflow-tooltip":"",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fq8k0"),prop:"UpdateDate","show-overflow-tooltip":"",width:"100",formatter:e.PTableDateHisShow}})],1),e._v(" "),t("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.TotalCount,pageNumber:e.CurrentPage,pageSize:e.PageSize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1),e._v(" "),t("el-dialog",{attrs:{title:0==e.winFlag?e.$t("menu.SpecialGroupScore.5nrnc1nt6d00"):e.$t("menu.SpecialGroupScore.5nrnc1nt6d01"),visible:e.ScoreDialogVisible,"close-on-click-modal":!1,width:"396px"},on:{"update:visible":function(o){e.ScoreDialogVisible=o}}},[t("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?t("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?t("span",[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt6d00")))]):1==e.winFlag?t("span",[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1nt6d01")))]):e._e()]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.ScoreLoading,expression:"ScoreLoading"}],attrs:{"element-loading-text":e.$t("menu.SpecialGroupScore.5nrnc1nye0g0")}},[t("el-form",{ref:"ScoreForm",attrs:{model:e.ScoreForm,rules:e.Rules,inline:!0,"label-position":"right","label-width":"140px",align:"left"}},[t("el-row",[t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1noec00"),prop:"Group"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{size:"mini"},on:{change:e.FormGroupChange},model:{value:e.ScoreForm.Group,callback:function(o){e.$set(e.ScoreForm,"Group",o)},expression:"ScoreForm.Group"}},e._l(e.GroupStore,function(e){return t("el-option",{key:e.SubValue,attrs:{label:e.SubDesc,value:e.SubValue}})}),1)],1)],1),e._v(" "),t("el-row",[t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5nrnc1o0m340"),prop:"Per"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{disabled:!e.ScoreForm.Group,size:"mini"},model:{value:e.ScoreForm.Per,callback:function(o){e.$set(e.ScoreForm,"Per",o)},expression:"ScoreForm.Per"}},e._l(e.GroupPerStore,function(e){return t("el-option",{key:e.MemberPer,attrs:{label:e.MemberPerName,value:e.MemberPer}})}),1)],1)],1),e._v(" "),t("el-row",[t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fouk0"),prop:"Motivation"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:5,placeholder:"","controls-position":"right",size:"mini"},model:{value:e.ScoreForm.Motivation,callback:function(o){e.$set(e.ScoreForm,"Motivation",o)},expression:"ScoreForm.Motivation"}})],1)],1),e._v(" "),t("el-row",[t("el-form-item",{attrs:{label:e.$t("menu.SpecialGroupScore.5ncy6r7fp7g0"),prop:"Contribute"}},[t("el-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:5,placeholder:"","controls-position":"right",size:"mini"},model:{value:e.ScoreForm.Contribute,callback:function(o){e.$set(e.ScoreForm,"Contribute",o)},expression:"ScoreForm.Contribute"}})],1)],1)],1),e._v(" "),t("div",{staticClass:"bottom-button"},[0==this.$store.state.login.LoginId||e.elementlist.scoreadd?t("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode},on:{click:e.SaveScore}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1o0p2o0")))]):e._e(),e._v(" "),t("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(o){e.ScoreDialogVisible=!1}}},[e._v(e._s(e.$t("menu.SpecialGroupScore.5nrnc1o0pfo0")))])],1)],1)])],1)},staticRenderFns:[]};var c=t("VU/8")(i,n,!1,function(e){t("WTc7")},null,null);o.default=c.exports}});