webpackJsonp([191],{KUgB:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("Dd8w"),s=t.n(o),a=t("NYxO"),n=t("XlQt"),i=t("W5Fe"),l=t("doZQ"),u={components:{hgbutton:n.default,hgpagination:i.default,hgswitch:l.default},name:"ArgPerGroup",computed:s()({},Object(a.b)(["Height","styleCode"])),data:function(){return{elementlist:{},WardStore:[],Finds:{Ward:"",Type:"G"},GroupTableData:[],LabelWidth:"width:200px",CurrentPage:1,PageSize:20,TotalCount:0,DialogVisible:!1,EditForm:{GroupWard:"",GroupDesc:"",GroupMaster:"",GroupMember:[],GroupBedGroup:"",GroupResBeds:[],GroupRemark:"",rw:""},Rules:{GroupWard:[{required:!0,message:"请选择病区",trigger:"change"}],GroupDesc:[{required:!0,message:"请输入组名",trigger:"blur"}],GroupMaster:[{required:!0,message:"请设置组长",trigger:"change"}],GroupMember:[{required:!0,message:"请设置组员",trigger:"change",type:"array"}]},WardPersonStore:[],WardBedStore:[],WardBedGroupStore:[],SelGroupRow:"",winFlag:0}},methods:{LoadRoleWard:function(){var e=this,r=e.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.loginID);e.$ajax.request(r).then(function(r){r.data instanceof Object?(e.WardStore=r.data.rows,e.WardStore.length>0&&(e.Finds.Ward=e.WardStore[0].rw,e.FindWardNurGroup())):e.$message({type:"error",message:"获取权限病区类型失败",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({type:"error",message:"获取权限病区方法失败",showClose:!0,customClass:"error_class"})})},FindWardNurGroup:function(){var e=this;if(e.Finds.Ward){var r=(e.CurrentPage-1)*e.PageSize,t=e.PageSize,o=e.axiosConfig("web.INMArgComm","FindNurGroupList","RecQuery","ward$"+e.Finds.Ward,"nurseid$"+sessionStorage.loginID,"start$"+r,"limit$"+t);e.$ajax.request(o).then(function(r){r.data instanceof Object?(e.GroupTableData=r.data.rows,e.TotalCount=parseInt(r.data.results)):e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"}),e.SelGroupRow=""}).catch(function(r){e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"})})}else e.$message({type:"warning",message:"请选择病区",showClose:!0,customClass:"warning_class"})},AddGroup:function(){var e=this;this.DialogVisible=!0,this.winFlag=0,this.EditForm.rw="",this.$nextTick(function(){e.$refs.EditForm.resetFields()})},GroupWardChange:function(){this.EditForm.GroupMaster="",this.EditForm.GroupMember=[],this.EditForm.GroupBedGroup="",this.EditForm.GroupResBeds=[],this.LoadWardPerson(),this.LoadWardBedGroup(),this.LoadWardBed()},LoadWardPerson:function(){var e=this,r=e.axiosConfig("web.INMHRComm","FindWardNurseList","RecQuery","ward$"+e.EditForm.GroupWard);e.$ajax.request(r).then(function(r){r instanceof Object?e.WardPersonStore=r.data.rows:e.$message({type:"error",message:"获取病区人员列表失败",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({type:"error",message:"获取病区人员列表失败",showClose:!0,customClass:"error_class"})})},LoadWardBedGroup:function(){var e=this;e.WardBedGroupStore=new Array;var r=e.axiosConfig("web.INMHISComm","FindBedGroupList","RecQuery","parr$"+e.EditForm.GroupWard);e.$ajax.request(r).then(function(r){r.data instanceof Object?e.WardBedGroupStore=r.data.rows:e.$message({type:"error",message:"获取病区床位分组列表失败",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({type:"error",message:"获取病区床位分组列表失败",showClose:!0,customClass:"error_class"})})},LoadWardBed:function(){var e=this,r=e.axiosConfig("web.INMHISComm","FindBedList","RecQuery","parr$"+e.EditForm.GroupWard);e.$ajax.request(r).then(function(r){r instanceof Object?e.WardBedStore=r.data.rows:e.$message({type:"error",message:"获取病区床位列表失败",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({type:"error",message:"获取病区床位列表失败",showClose:!0,customClass:"error_class"})})},GetBedByGroup:function(){var e=this;e.EditForm.GroupResBeds=[];var r=e.axiosConfig("web.INMHISComm","GetBedIdByGroup","Method","parr$"+e.EditForm.GroupBedGroup);e.$ajax.request(r).then(function(r){e.EditForm.GroupResBeds=r.data?r.data.replace(/\|\|/g,"__").split(","):[]}).catch(function(r){e.$message({type:"error",message:"获取分组床位列表失败",showClose:!0,customClass:"error_class"})})},SaveGroup:function(){var e=this;this.$refs.EditForm.validate(function(r){if(r){var t=e.EditForm.GroupWard+"^"+e.EditForm.GroupDesc+"^"+e.EditForm.GroupMaster+"^"+e.EditForm.GroupMember.join(",");t=t+"^"+e.EditForm.GroupBedGroup+"^"+e.EditForm.GroupResBeds.join(",")+"^"+e.EditForm.GroupRemark+"^"+e.EditForm.rw;var o=e.axiosConfig("web.INMArgComm","SaveNurGroup","Method","parr$"+t);e.$ajax.request(o).then(function(r){1==r.data?(e.DialogVisible=!1,e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}),e.FindWardNurGroup()):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})}})},GroupEdit:function(e){var r=this,t=this,o=this.axiosConfig("web.INMArgComm","GetNurGroup","RecMethod","id$"+t.SelGroupRow.rw);this.$ajax.request(o).then(function(e){if(e instanceof Object){var o={GroupWard:e.data.GroupWard,GroupDesc:e.data.GroupDesc,GroupMaster:e.data.GroupMaster,GroupMember:e.data.GroupMember?e.data.GroupMember.split(","):[],GroupBedGroup:e.data.GroupBedGroup,GroupResBeds:e.data.GroupResBeds?e.data.GroupResBeds.split(","):[],GroupRemark:e.data.GroupRemark,rw:e.data.rw};t.EditForm=o,r.LoadWardPerson(),r.LoadWardBedGroup(),r.LoadWardBed()}else t.$message({type:"error",message:"获取分组数据失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取分组数据失败",showClose:!0,customClass:"error_class"})})},DeleteGroup:function(){var e=this,r=e.SelGroupRow.rw;r?e.$confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",closeOnClickModal:!1,type:"warning"}).then(function(){var t=e.axiosConfig("web.INMArgComm","DeleteNurGroup","Method","id$"+r);e.$ajax.request(t).then(function(r){1==r.data?(e.$message({message:"删除成功",type:"success",showClose:!0,customClass:"success_class"}),e.FindWardNurGroup()):e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})}).catch(function(r){e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})})}).catch(function(){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):e.$message({type:"warning",message:"请选择要删除的记录",showClose:!0,customClass:"warning_class"})},RowClick:function(e){this.SelGroupRow=e},RowDblClick:function(e){var r=this;this.SelGroupRow=e,this.DialogVisible=!0,this.winFlag=1,this.EditForm.rw="",this.$nextTick(function(){r.$refs.EditForm.resetFields(),r.GroupEdit()})},jumpPage:function(e){this.CurrentPage=e.currentPage,this.FindWardNurGroup()},HandleCurrentChange:function(e){this.CurrentPage=e,this.FindWardNurGroup()},HandleSizeChange:function(e){this.PageSize=e,this.FindWardNurGroup()},Move:function(e){var r=this;if(this.SelGroupRow.rw){var t=this.axiosConfig("web.INMArgComm","MoveGroup","Method","id$"+this.SelGroupRow.rw,"type$"+e);this.$ajax.request(t).then(function(e){1==e.data?(r.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),r.FindWardNurGroup()):0==e.data?r.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"}):e.data.length<100?r.$message({type:"warning",message:e.data,showClose:!0,customClass:"warning_class"}):r.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(e){r.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}else this.$message({type:"warning",message:"请选择一行记录",showClose:!0,customClass:"warning_class"})}},created:function(){this.LoadRoleWard();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)}},d={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"argpergroup-panel"},[t("div",{staticClass:"top-tool-inputDiv"},[t("el-form",{ref:"ToolForm",attrs:{model:e.Finds,inline:!0}},[t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnark9d640"),prop:"Ward"}},[t("el-select",{staticStyle:{width:"140px"},attrs:{filterable:"",placeholder:e.$t("menu.ArgPerGroup.5nrnarkbji80"),size:"mini"},model:{value:e.Finds.Ward,callback:function(r){e.$set(e.Finds,"Ward",r)},expression:"Finds.Ward"}},e._l(e.WardStore,function(e){return t("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1),e._v(" "),e._e(),e._v(" "),t("el-form-item",[this.elementlist.arggroupsearch||0==this.$store.state.login.LoginId?t("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.FindWardNurGroup}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarkbok40")))]):e._e()],1)],1)],1),e._v(" "),t("div",{staticClass:"top-tool-button"},[this.elementlist.arggroupcreate||0==this.$store.state.login.LoginId?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.AddGroup}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarkbq8c0")))]):e._e(),e._v(" "),this.elementlist.arggroupdelete||0==this.$store.state.login.LoginId?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-cancel":"nm-icon-lite-cancel"},on:{click:e.DeleteGroup}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarkbrbc0")))]):e._e(),e._v(" "),this.elementlist.arggroupup||0==this.$store.state.login.LoginId?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-up":"nm-icon-lite-up"},on:{click:function(r){return e.Move("U")}}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarkbsxs0")))]):e._e(),e._v(" "),this.elementlist.arggroupdown||0==this.$store.state.login.LoginId?t("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-to-down":"nm-icon-lite-down"},on:{click:function(r){return e.Move("D")}}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarkbu8g0")))]):e._e()],1),e._v(" "),t("div",{staticClass:"top-tool-table"},[t("el-table",{ref:"tablelist",attrs:{data:e.GroupTableData,height:e.styleCode?e.Height-130:e.Height-124,border:e.styleCode,"header-cell-style":e.headerCellFontWeight,"highlight-current-row":""},on:{"row-click":e.RowClick,"row-dblclick":e.RowDblClick}},[t("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnark9d640"),prop:"GroupWardDesc",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkg00c0"),prop:"GroupDesc",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkhygg0"),prop:"GroupMasterName",width:"100"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5ncy615fw1s0"),prop:"GroupMemberName"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5ncy615fwpo0"),prop:"GroupBedGroupDesc",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5ncy615fxf00"),prop:"GroupResBedsDesc"}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkkpsw0"),prop:"GroupRemark"}})],1),e._v(" "),t("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.TotalCount,pageNumber:e.CurrentPage,pageSize:e.PageSize},on:{changePage:e.jumpPage,getPageSize:e.HandleSizeChange}})],1),e._v(" "),t("el-dialog",{attrs:{title:0==e.winFlag?e.$t("menu.ArgPerGroup.5ncy61gayos7"):e.$t("menu.ArgPerGroup.5ncy61gayos8"),visible:e.DialogVisible,"close-on-click-modal":!1,width:"350px",align:"center"},on:{"update:visible":function(r){e.DialogVisible=r}}},[t("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?t("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?t("span",[e._v(e._s(e.$t("menu.ArgPerGroup.5ncy61gayos7")))]):1==e.winFlag?t("span",[e._v(e._s(e.$t("menu.ArgPerGroup.5ncy61gayos8")))]):e._e()]),e._v(" "),t("el-form",{ref:"EditForm",attrs:{model:e.EditForm,rules:e.Rules,inline:!0,"label-position":"right","label-width":"96px",align:"left"}},[t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnark9d640"),prop:"GroupWard"}},[t("el-select",{style:e.LabelWidth,attrs:{filterable:"",placeholder:e.$t("menu.ArgPerGroup.5nrnarkr4gc0"),size:"mini"},on:{change:e.GroupWardChange},model:{value:e.EditForm.GroupWard,callback:function(r){e.$set(e.EditForm,"GroupWard",r)},expression:"EditForm.GroupWard"}},e._l(e.WardStore,function(e){return t("el-option",{key:e.rw,attrs:{value:e.rw,label:e.WardDesc}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkg00c0"),prop:"GroupDesc"}},[t("el-input",{style:e.LabelWidth,attrs:{size:"mini",placeholder:e.$t("menu.ArgPerGroup.5nrnarkuv3o0")},model:{value:e.EditForm.GroupDesc,callback:function(r){e.$set(e.EditForm,"GroupDesc",r)},expression:"EditForm.GroupDesc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkhygg0"),prop:"GroupMaster"}},[t("el-select",{style:e.LabelWidth,attrs:{filterable:"",placeholder:e.$t("menu.ArgPerGroup.5ncy615g6h40"),size:"mini"},model:{value:e.EditForm.GroupMaster,callback:function(r){e.$set(e.EditForm,"GroupMaster",r)},expression:"EditForm.GroupMaster"}},e._l(e.WardPersonStore,function(e){return t("el-option",{key:e.Per,attrs:{value:e.Per,label:e.PerName}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkyieo0"),prop:"GroupMember"}},[t("el-select",{style:e.LabelWidth,attrs:{multiple:"","collapse-tags":"",clearable:"",filterable:"",placeholder:e.$t("menu.ArgPerGroup.5nrnarkzw6c0"),size:"mini"},model:{value:e.EditForm.GroupMember,callback:function(r){e.$set(e.EditForm,"GroupMember",r)},expression:"EditForm.GroupMember"}},e._l(e.WardPersonStore,function(e){return t("el-option",{key:e.Per,attrs:{value:e.Per,label:e.PerName}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5ncy615gazw0"),prop:"GroupBedGroup"}},[t("el-select",{style:e.LabelWidth,attrs:{clearable:"",filterable:"",placeholder:e.$t("menu.ArgPerGroup.5ncy615gc2s0"),size:"mini"},on:{change:e.GetBedByGroup},model:{value:e.EditForm.GroupBedGroup,callback:function(r){e.$set(e.EditForm,"GroupBedGroup",r)},expression:"EditForm.GroupBedGroup"}},e._l(e.WardBedGroupStore,function(e){return t("el-option",{key:e.rw,attrs:{value:e.rw,label:e.groupDesc}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5ncy615gdc00"),prop:"GroupResBeds"}},[t("el-select",{style:e.LabelWidth,attrs:{disabled:!!e.EditForm.GroupBedGroup,multiple:"","collapse-tags":"",clearable:"",placeholder:e.$t("menu.ArgPerGroup.5ncy615ge8g0"),size:"mini"},model:{value:e.EditForm.GroupResBeds,callback:function(r){e.$set(e.EditForm,"GroupResBeds",r)},expression:"EditForm.GroupResBeds"}},e._l(e.WardBedStore,function(e){return t("el-option",{key:e.rw,attrs:{value:e.rw,label:e.BedCode}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("menu.ArgPerGroup.5nrnarkkpsw0"),prop:"GroupRemark"}},[t("el-input",{staticStyle:{"margin-bottom":"5px"},style:e.LabelWidth,attrs:{type:"textarea",placeholder:e.$t("menu.ArgPerGroup.5nrnarl3cig0"),rows:2,size:"mini"},model:{value:e.EditForm.GroupRemark,callback:function(r){e.$set(e.EditForm,"GroupRemark",r)},expression:"EditForm.GroupRemark"}})],1)],1),e._v(" "),t("div",{staticClass:"bottom-button"},[t("hgbutton",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:e.SaveGroup,time:500},expression:"{func:SaveGroup,time:500}"}],attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarl3fnc0")))]),e._v(" "),t("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(r){e.DialogVisible=!1}}},[e._v(e._s(e.$t("menu.ArgPerGroup.5nrnarl3go00")))])],1)],1)],1)},staticRenderFns:[]};var c=t("VU/8")(u,d,!1,function(e){t("hHEO")},null,null);r.default=c.exports},hHEO:function(e,r){}});