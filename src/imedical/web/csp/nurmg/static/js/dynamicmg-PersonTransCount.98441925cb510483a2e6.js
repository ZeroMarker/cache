webpackJsonp([270],{NUwh:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Dd8w"),o=r.n(a),s=r("NYxO"),n=r("zL8q"),c=r("XlQt"),l=r("W5Fe"),d=r("qfDe").create_excel,i={components:{Hgbutton:c.default,hgpagination:l.default},computed:o()({},Object(s.b)(["Height","SysTomcat","LoginId","DateFormat","styleCode"])),name:"RotationProcess",data:function(){return{searchform:{StYear:new Date,EndYear:new Date,Year:new Date,Ward:"",Model:"month"},dateshow:!1,yearshow:!0,drawer:!1,statusstore:[{code:"month",desc:"月度"},{code:"quarter",desc:"季度"},{code:"year",desc:"年度"},{code:"halfyear",desc:"半年"}],tableData:[],wardstore:[],elementlist:[],DetailData:[],RotProcesslist:[],row:"",column:"",datestore:[{code:"01",desc:"01月"},{code:"02",desc:"02月"},{code:"03",desc:"03月"},{code:"04",desc:"04月"},{code:"05",desc:"05月"},{code:"06",desc:"06月"},{code:"07",desc:"07月"},{code:"08",desc:"08月"},{code:"09",desc:"09月"},{code:"10",desc:"10月"},{code:"11",desc:"11月"},{code:"12",desc:"12月"}],currentPage:1,currentPageSize:20,totalCount:0}},created:function(){this.loadWardData(),this.LoadTransData();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)},methods:{loadWardData:function(){var e=this,t=e.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.getItem("loginID"));e.$ajax.request(t).then(function(t){e.wardstore=t.data.rows})},LoadTransData:function(){var e=this,t="";"year"==e.searchform.Model?void 0==e.searchform.StYear&&void 0==e.searchform.EndYear||e.searchform.StYear instanceof Date&&e.searchform.EndYear instanceof Date&&(t=e.searchform.StYear.Format("YYYY")+"-01-01^"+e.searchform.EndYear.Format("YYYY")+"-12-31^"+e.searchform.Model):e.searchform.Year&&e.searchform.Year instanceof Date&&(t=e.searchform.Year.Format("YYYY")+"-01-01^"+e.searchform.Year.Format("YYYY")+"-12-31^"+e.searchform.Model),e.$ajax.request(e.axiosConfig("web.INMPersonCountComm","FindTransCountData","RecQuery","start$"+(e.currentPage-1)*e.currentPageSize,"limit$"+e.currentPageSize,"parr$"+t,"nurseid$"+sessionStorage.loginID)).then(function(t){e.tableData=new Array,e.tableData=t.data.rows,e.totalCount=parseInt(t.data.results)})},TableCellStyle:function(e,t){if(this.row==e.row&&this.column==e.column)return"background-color:#ccc;"},CellClick:function(e,t){var r=this;if(void 0!=t.property){r.row=e,r.column=t;var a="",o="";if("Ward"!=t.property){"Summary"!=t.property?"year"==r.searchform.Model?(a=r.searchform.StYear.Format("YYYY")+"-01-01",o=r.searchform.EndYear.Format("YYYY")+"-12-31"):"month"==r.searchform.Model?(a=r.searchform.Year.Format("YYYY")+"-"+t.property+"-01",o=r.searchform.Year.Format("YYYY")+"-"+(parseInt(t.property)+1)+"-01"):"quarter"==r.searchform.Model?"1"==t.property?(a=r.searchform.Year.Format("YYYY")+"-01-01",o=r.searchform.Year.Format("YYYY")+"-03-31"):"2"==t.property?(a=r.searchform.Year.Format("YYYY")+"-04-01",o=r.searchform.Year.Format("YYYY")+"-06-30"):"3"==t.property?(a=r.searchform.Year.Format("YYYY")+"-07-01",o=r.searchform.Year.Format("YYYY")+"-09-30"):(a=r.searchform.Year.Format("YYYY")+"-10-01",o=r.searchform.Year.Format("YYYY")+"-12-31"):("1"==t.property&&(a=r.searchform.Year.Format("YYYY")+"-01-01",o=r.searchform.Year.Format("YYYY")+"-06-30"),"2"==t.property&&(a=r.searchform.Year.Format("YYYY")+"-07-01",o=r.searchform.Year.Format("YYYY")+"-12-31")):(a=r.searchform.Year.Format("YYYY")+"-01-01",o=r.searchform.Year.Format("YYYY")+"-12-31");var s=e.WardId+"^"+a+"^"+o;r.$ajax.request(r.axiosConfig("web.INMPersonCountComm","FindTransDetailData","RecQuery","parr$"+s,"nurseid$"+sessionStorage.loginID)).then(function(e){r.DetailData=new Array,r.DetailData=e.data.rows,r.drawer=!0})}}},changedate:function(){this.datestore=new Array,"year"==this.searchform.Model?(this.dateshow=!0,this.yearshow=!1,this.changedatestore()):(this.yearshow=!0,this.dateshow=!1,"month"==this.searchform.Model?this.datestore=[{code:"01",desc:"01月"},{code:"02",desc:"02月"},{code:"03",desc:"03月"},{code:"04",desc:"04月"},{code:"05",desc:"05月"},{code:"06",desc:"06月"},{code:"07",desc:"07月"},{code:"08",desc:"08月"},{code:"09",desc:"09月"},{code:"10",desc:"10月"},{code:"11",desc:"11月"},{code:"12",desc:"12月"}]:"quarter"==this.searchform.Model?this.datestore=[{code:"1",desc:"第一季度"},{code:"2",desc:"第二季度"},{code:"3",desc:"第三季度"},{code:"4",desc:"第四季度"}]:this.datestore=[{code:"1",desc:"上半年"},{code:"2",desc:"下半年"}]),this.LoadTransData()},changedatestore:function(){if("year"==this.searchform.Model){if(void 0!=this.searchform.StYear&&void 0!=this.searchform.EndYear){if(this.searchform.StYear instanceof Date&&this.searchform.EndYear instanceof Date){this.datestore=new Array;for(var e=this.searchform.StYear.Format("YYYY"),t=this.searchform.EndYear.Format("YYYY"),r=e;r<=t;r++)this.datestore.push({code:r+"",desc:r+"年"})}this.LoadTransData()}}else this.changedate()},Export:function(){var e=this,t="";"year"==e.searchform.Model?void 0==e.searchform.StYear&&void 0==e.searchform.EndYear||e.searchform.StYear instanceof Date&&e.searchform.EndYear instanceof Date&&(t=e.searchform.StYear.Format("YYYY")+"-01-01^"+e.searchform.EndYear.Format("YYYY")+"-12-31^"+e.searchform.Model):e.searchform.Year&&e.searchform.Year instanceof Date&&(t=e.searchform.Year.Format("YYYY")+"-01-01^"+e.searchform.Year.Format("YYYY")+"-12-31^"+e.searchform.Model),e.$ajax.request(e.axiosConfig("web.INMPersonCountComm","FindTransCountData","RecQuery","parr$"+t,"nurseid$"+sessionStorage.loginID)).then(function(t){if(e.RotProcesslist=new Array,e.RotProcesslist=t.data.rows,0!=e.tableData.length){for(var r=[{label:"病区",prop:"Ward",width:150}],a=0;a<e.datestore.length;a++)r.push({label:e.datestore[a].desc,prop:e.datestore[a].code,width:100});var o=n.Loading.service({fullscreen:!0,text:"拼命加载中..."}),s=new Array,c=new Array;d(r,e.RotProcesslist,s,"","export","院内调岗统计","院内调岗统计",c,o),o.close()}else e.$message({type:"warning",message:"无数据导出",showClose:!0,customClass:"warning_class"})})},handleCurrentChange:function(e){this.currentPage=e.currentPage,this.LoadTransData()},handleSizeChange:function(e){this.currentPageSize=e,this.LoadTransData()}}},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"per-trans-count-panel"},[r("div",{staticClass:"top-tool-input"},[r("el-form",{attrs:{model:e.searchform,inline:!0}},[r("el-form-item",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1g60tg0")}},[r("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:e.$t("menu.PersonTransCount.5nrnb1g7lvk0"),size:"mini"},on:{change:e.changedate},model:{value:e.searchform.Model,callback:function(t){e.$set(e.searchform,"Model",t)},expression:"searchform.Model"}},e._l(e.statusstore,function(e){return r("el-option",{key:e.code,attrs:{label:e.desc,value:e.code}})}),1)],1),e._v(" "),e.dateshow?r("el-form-item",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1g97n00")}},[r("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"year",size:"mini"},on:{change:e.changedatestore},model:{value:e.searchform.StYear,callback:function(t){e.$set(e.searchform,"StYear",t)},expression:"searchform.StYear"}})],1):e._e(),e._v(" "),e.dateshow?r("el-form-item",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gbe1g0")}},[r("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"year",size:"mini"},on:{change:e.changedatestore},model:{value:e.searchform.EndYear,callback:function(t){e.$set(e.searchform,"EndYear",t)},expression:"searchform.EndYear"}})],1):e._e(),e._v(" "),e.yearshow?r("el-form-item",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1g97n00")}},[r("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"year",size:"mini"},on:{change:e.changedatestore},model:{value:e.searchform.Year,callback:function(t){e.$set(e.searchform,"Year",t)},expression:"searchform.Year"}})],1):e._e(),e._v(" "),r("el-form-item",[r("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.LoadTransData}},[e._v(e._s(e.$t("menu.PersonTransCount.5nrnb1gdy1w0")))]),e._v(" "),this.elementlist.Export||0==e.LoginId?r("hgbutton",{ref:"Export",attrs:{type:"default",styleCode:e.styleCode,icon:"el-icon-download"},on:{click:e.Export}},[e._v(e._s(e.$t("menu.PersonTransCount.5nrnb1gdz680")))]):e._e()],1)],1)],1),e._v(" "),r("div",{staticClass:"top-tool-table"},[r("el-table",{ref:"tableData",attrs:{data:e.tableData,height:e.styleCode?e.Height-93:e.Height-91,"header-cell-style":e.headerCellFontWeight,"show-summary":!0,"cell-style":e.TableCellStyle,border:e.styleCode,"highlight-current-row":""},on:{"cell-click":e.CellClick}},[r("el-table-column",{attrs:{type:"index",width:"60",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"Ward",width:"240",label:e.$t("menu.PersonTransCount.5nrnb1gfk5s0"),"show-overflow-tooltip":""}}),e._v(" "),e._l(e.datestore,function(e){return r("el-table-column",{key:e.code,attrs:{prop:e.code,label:e.desc}})}),e._v(" "),r("el-table-column",{attrs:{prop:"Summary",width:"50",label:e.$t("menu.PersonTransCount.5nrnb1gh4600")}})],2),e._v(" "),r("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.totalCount,pageNumber:e.currentPage,pageSize:e.currentPageSize},on:{changePage:e.handleCurrentChange,getPageSize:e.handleSizeChange}})],1),e._v(" "),r("div",[r("el-dialog",{attrs:{title:e.$t("menu.PersonTransCount.5ncy65o4v0o0"),visible:e.drawer,width:"80%"},on:{"update:visible":function(t){e.drawer=t}}},[r("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?r("i",{staticClass:"nm-icon-w-paper"}):e._e(),e._v(" "),r("span",[e._v(e._s(e.$t("menu.PersonTransCount.5ncy65o4v0o0")))])]),e._v(" "),r("div",{staticClass:"top-tool-dialog-table dialog-div-top-radius dialog-table-bottom-radius"},[r("el-table",{staticClass:"dialog-div-top-radius dialog-table-bottom-radius",staticStyle:{"border-bottom":"0"},attrs:{title:e.$t("menu.PersonTransCount.5ncy65o4v0o0"),"header-cell-style":e.headerCellFontWeight,data:e.DetailData,height:e.Height-128,border:e.styleCode,"highlight-current-row":""}},[r("el-table-column",{attrs:{type:"index",width:"60",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gohdg0"),prop:"Person"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gq6cw0"),prop:"TransType"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1grtic0"),prop:"OutWard"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gsqsk0"),prop:"InWard"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gtx7w0"),prop:"StDate",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gv63g0"),prop:"EndDate",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{label:e.$t("menu.PersonTransCount.5nrnb1gw6z40"),prop:"Days"}})],1)],1)])],1)])},staticRenderFns:[]};var m=r("VU/8")(i,h,!1,function(e){r("o8Lv")},null,null);t.default=m.exports},o8Lv:function(e,t){}});