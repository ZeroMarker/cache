webpackJsonp([208],{UzoL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),r=a.n(o),l=a("Dd8w"),n=a.n(l),i=a("NYxO"),s=a("zL8q"),c=a("XlQt"),d=a("W5Fe"),u={name:"PdaRatio",components:{hgbutton:c.default,hgpagination:d.default},computed:n()({},Object(i.b)(["Height","styleCode"])),data:function(){return{ToolForm:{Ward:"",StDate:new Date,EndDate:new Date,selectRadio:"Ward"},ToolFormRules:{StDate:[{required:!0,message:"请选择开始日期",type:"date",trigger:"change"}],EndDate:[{required:!0,message:"请选择结束日期",type:"date",trigger:"change"}]},WardStore:[],WardStoreCopy:[],TableData:[],FullTableData:[],SelectRow:{},CurrentPage:1,PageSize:20,TotalCount:0,columnSubData:[],columnData:[]}},methods:{LoadRoleWard:function(){var e=this;this.WardStore=[],this.WardStoreCopy=[];var t=this.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.loginID);this.$ajax.request(t).then(function(t){t.data instanceof Object?(e.WardStore=t.data.rows,e.WardStoreCopy=JSON.parse(r()(e.WardStore)),e.WardStore.length>0&&(e.ToolForm.Ward=e.WardStore[0].rw),e.ToolFormSearchPre()):e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取权限病区失败",showClose:!0,customClass:"error_class"})})},WardFilter:function(e){this.WardStore=[],this.WardStore=this.WardStoreCopy.filter(function(t){return!e||(t.WardDesc+t.WardSpell+t.WardToNum).indexOf(e.toUpperCase())>-1})},ToolFormSearchPre:function(){this.CurrentPage=1,this.PageSize=20,this.ToolFormSearch()},ToolFormSearch:function(){var e=this,t=(this.CurrentPage-1)*this.PageSize,a=this.PageSize,o=this.ToolForm.Ward,r="";this.ToolForm.StDate instanceof Date&&(r=this.ToolForm.StDate.Format("YYYY-MM-dd"));var l="";this.ToolForm.EndDate instanceof Date&&(l=this.ToolForm.EndDate.Format("YYYY-MM-dd"));var n=this.ToolForm.selectRadio;n||(n="Ward");var i=o+"^"+r+"^"+l+"^"+n;this.SelectRow={},this.TableData=[],this.FullTableData=[];var s=this.axiosConfig("web.INMStatComm","FindPdaWork","RecQuery","parr$"+i,"nurseid$"+sessionStorage.loginID);this.$ajax.request(s).then(function(o){o.data instanceof Object?(e.FullTableData=o.data.rows,e.TableData=o.data.rows.slice(t,t+a),e.TotalCount=parseInt(o.data.results)):e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取数据列表失败",showClose:!0,customClass:"error_class"})})},ExportClick:function(){var e=a("KfmK").create_excel,t=[{label:"病区",prop:"WardDesc",width:100,rowspan:2}];"Nurse"==this.ToolForm.selectRadio&&t.push({label:"姓名",prop:"PerName",width:100,rowspan:2});for(var o=[].concat(t),r=0;r<this.columnData.length;r++){for(var l=this.columnData[r],n=new Array,i=0;i<this.columnSubData.length;i++){var c=this.columnSubData[i];t.push({label:l.label+c.label,prop:l.prop+c.prop,width:100}),n.push({label:c.label,prop:l.prop+c.prop,width:100,rowspan:1})}o.push({label:l.label,prop:l.prop,children:n,rowspan:1})}var d=s.Loading.service({fullscreen:!0,text:"拼命加载中..."});e(t,this.FullTableData,[],"","export","PDA执行率统计","PDA执行率统计",new Array,d,o)},RowClick:function(e){this.SelectRow=e},RowDblClick:function(e){this.SelectRow=e},HandleSizeChange:function(e){this.PageSize=e,this.CurrentPage=1,this.ToolFormSearch()},HandleCurrentChange:function(e){this.CurrentPage=e.currentPage,this.ToolFormSearch()},InitColumnData:function(){var e=this,t=e.axiosConfig("web.INMStatComm","GetColumnData","Method"),a=e.axiosConfig("web.INMStatComm","GetColumnSub","Method");e.$ajax.all([e.$ajax.request(t),e.$ajax.request(a)]).then(e.$ajax.spread(function(t,a){e.columnData=t.data,e.columnSubData=a.data,e.$nextTick(function(){e.$refs.TableData.doLayout()})})).catch(function(e){})}},created:function(){this.InitColumnData(),this.LoadRoleWard()}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pda-ratio-panel"},[a("div",{staticClass:"top-tool-inputDiv"},[a("el-form",{attrs:{model:e.ToolForm,rules:e.ToolFormRules,inline:!0,"label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("menu.PdaRatio.5nrnccex89c0")}},[a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",filterable:"","filter-method":e.WardFilter,size:"mini"},on:{clear:e.WardFilter,change:e.ToolFormSearchPre},model:{value:e.ToolForm.Ward,callback:function(t){e.$set(e.ToolForm,"Ward",t)},expression:"ToolForm.Ward"}},e._l(e.WardStore,function(e){return a("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.PdaRatio.5nrnccey25k0"),prop:"StDate"}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",clearable:!1,editable:!1,size:"mini"},on:{change:e.ToolFormSearchPre},model:{value:e.ToolForm.StDate,callback:function(t){e.$set(e.ToolForm,"StDate",t)},expression:"ToolForm.StDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.PdaRatio.5nrncceywro0"),prop:"EndDate"}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",clearable:!1,editable:!1,size:"mini"},on:{change:e.ToolFormSearchPre},model:{value:e.ToolForm.EndDate,callback:function(t){e.$set(e.ToolForm,"EndDate",t)},expression:"ToolForm.EndDate"}})],1),e._v(" "),a("el-form-item",[a("el-radio-group",{on:{change:e.ToolFormSearchPre},model:{value:e.ToolForm.selectRadio,callback:function(t){e.$set(e.ToolForm,"selectRadio",t)},expression:"ToolForm.selectRadio"}},[a("el-radio",{staticClass:"radio",attrs:{label:"Ward"}},[e._v(e._s(e.$t("menu.PdaRatio.5nrncceyy4w0")))]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"Nurse"}},[e._v(e._s(e.$t("menu.PdaRatio.5nrncceyyeo0")))])],1)],1),e._v(" "),a("el-form-item",[a("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.ToolFormSearchPre}},[e._v(e._s(e.$t("menu.PdaRatio.5nrncceyyts0")))])],1)],1)],1),e._v(" "),a("div",{staticClass:"top-tool-button"},[a("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-export":"nm-icon-lite-export"},on:{click:e.ExportClick}},[e._v(e._s(e.$t("menu.PdaRatio.5nrncceyzao0")))])],1),e._v(" "),a("div",{staticClass:"top-tool-table"},[a("el-table",{ref:"TableData",staticClass:"multi-level-table-head multi-level-table-body",attrs:{data:e.TableData,"header-cell-style":e.headerCellFontWeight,"highlight-current-row":"",border:e.styleCode,height:e.styleCode?e.Height-130:e.Height-124},on:{"row-click":e.RowClick,"row-dblclick":e.RowDblClick}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"WardDesc",label:e.$t("menu.PdaRatio.5nrnccex89c0"),"show-overflow-tooltip":"",width:"200","header-align":"left"}}),e._v(" "),"Nurse"==e.ToolForm.selectRadio?a("el-table-column",{attrs:{prop:"PerName",label:e.$t("menu.PdaRatio.5nrnccf1jb80"),width:"90","header-align":"left"}}):e._e(),e._v(" "),e._l(e.columnData,function(t){return a("el-table-column",{key:t.prop,attrs:{label:t.label,"header-align":"center"}},e._l(e.columnSubData,function(e){return a("el-table-column",{key:t.prop+e.prop,attrs:{width:"100",prop:t.prop+e.prop,label:e.label,"show-overflow-tooltip":"","header-align":"left"}})}),1)})],2),e._v(" "),a("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.TotalCount,pageNumber:e.CurrentPage,pageSize:e.PageSize},on:{changePage:e.HandleCurrentChange,getPageSize:e.HandleSizeChange}})],1)])},staticRenderFns:[]};var h=a("VU/8")(u,m,!1,function(e){a("v1up")},null,null);t.default=h.exports},v1up:function(e,t){}});