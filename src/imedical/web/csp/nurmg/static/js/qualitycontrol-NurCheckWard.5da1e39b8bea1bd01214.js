webpackJsonp([260],{"0Xzi":function(e,t){},yVBp:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),r=s("NYxO"),n=s("XlQt"),l={components:{hgpanel:s("z8xk").default,hgbutton:n.default},name:"NurCheckWard",computed:o()({},Object(r.b)(["Height","styleCode"])),data:function(){return{WardTool:{CheckType:""},PlanTypeStore:[],elrowstyle:{height:"20px"},pagesize:20,currentPage:1,totalCount:0,WardStore:[],CheckedWardStore:[],LeftSelection:[],RightSelection:[],SysFinds:{area:"",input:""},CheckFinds:{area:"",input:""},AreaData:[],LastSelection:[]}},methods:{LoadCheckPlanType:function(){var e=this,t=this,s=t.axiosConfig("web.INMQualControlComm","FindQualTypeList","RecQuery","type$");t.$ajax.request(s).then(function(s){s.data instanceof Object?(t.PlanTypeStore=s.data.rows,t.PlanTypeStore instanceof Array&&t.PlanTypeStore.length>0&&(t.WardTool.CheckType=t.PlanTypeStore[0].rw),e.RefreshWardData()):t.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取质控类型失败",showClose:!0,customClass:"error_class"})})},GetAreaData:function(){var e=this,t=e.axiosConfig("web.INMDBComm","FindWardAreaList","RecQuery","parr$Y");e.$ajax.request(t).then(function(t){t.data instanceof Object?e.AreaData=t.data.rows:e.$message({type:"error",message:"获取系统片区列表失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取系统片区列表失败",showClose:!0,customClass:"error_class"})})},RefreshWardData:function(){this.LoadAllWard(),this.LoadCheckWard()},LoadAllWard:function(){var e=this,t=e.SysFinds.area,s=e.SysFinds.input,a=e.WardTool.CheckType;a?(e.WardStore=new Array,e.$ajax.request(e.axiosConfig("web.INMQualControlComm","FindSysWardForTypeList","RecQuery","type$"+a,"area$"+t,"input$"+s)).then(function(t){t.data instanceof Object?e.WardStore=t.data.rows:e.$message({type:"error",message:"获取系统病区列表失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取系统病区列表失败",showClose:!0,customClass:"error_class"})})):e.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},LoadCheckWard:function(e){var t=this,s=t.CheckFinds.input,a=t.CheckFinds.area,o=t.WardTool.CheckType;o?(t.CheckedWardStore=new Array,t.$ajax.request(t.axiosConfig("web.INMQualControlComm","FindCheckWardForTypeList","RecQuery","type$"+o,"area$"+a,"input$"+s,"flag$0")).then(function(s){s.data instanceof Object?(t.CheckedWardStore=s.data.rows,e&&t.$nextTick(function(){t.LastSelection.forEach(function(e){var s=t.CheckedWardStore.find(function(t){return e.RowID==t.RowID});s&&t.$refs.CheckedWardStore.toggleRowSelection(s,!0)})})):t.$message({type:"error",message:"获取检查病区列表失败",showClose:!0,customClass:"error_class"})}).catch(function(e){t.$message({type:"error",message:"获取检查病区列表失败",showClose:!0,customClass:"error_class"})})):t.$message({type:"warning",message:"类型未取到，请刷新页面",showClose:!0,customClass:"warning_class"})},IsSelectAble:function(e,t){var s=1;return 1!=e.flag&&(s=0),s},SysRowClick:function(e){1==e.flag&&this.$refs.WardStore.toggleRowSelection(e)},CheckRowClick:function(e){this.$refs.CheckedWardStore.toggleRowSelection(e)},SetSelectionChange:function(e){this.LeftSelection=e},CheckSelectionChange:function(e){this.RightSelection=e},MoveLeft:function(){var e=this,t=e.WardTool.CheckType;if(t){var s=e.RightSelection.map(function(e){return e.RowID}).join("^");s?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","RemoveCheckWard","Method","type$"+t,"parr$"+s)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功",showClose:!0,customClass:"success_class"}),e.RefreshWardData()):e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择检查病区",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择类型！",showClose:!0,customClass:"warning_class"})},MoveRight:function(){var e=this,t=e.WardTool.CheckType;if(t){var s=e.LeftSelection.map(function(e){return e.wardid}).join("^");s?e.$ajax.request(e.axiosConfig("web.INMQualControlComm","AddCheckWard","Method","type$"+t,"parr$"+s)).then(function(t){1==t.data?(e.$message({type:"success",message:"操作成功！",showClose:!0,customClass:"success_class"}),e.RefreshWardData()):e.$message({type:"error",message:"操作失败！",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})}):e.$message({type:"warning",message:"请选择系统病区",showClose:!0,customClass:"warning_class"})}else e.$message({type:"warning",message:"请选择类型！",showClose:!0,customClass:"warning_class"})},MoveRec:function(e){var t=this;if(t.RightSelection&&0!=t.RightSelection.length){t.RightSelection.sort(function(e,t){return e.WardSort-t.WardSort}),"D"==e&&t.RightSelection.reverse();for(var s="",a=0;a<t.RightSelection.length;a++){var o=t.RightSelection[a];if(1==o.WardSort&&"U"==e)return void t.$message({type:"warning",message:"当前记录已在最上方，不可上移",showClose:!0,customClass:"warning_class"});if(t.CheckedWardStore.indexOf(o)==t.CheckedWardStore.length-1&&"D"==e)return void t.$message({type:"warning",message:"当前记录已在最下方，不可下移",showClose:!0,customClass:"warning_class"});s=""==s?o.RowID:s+","+o.RowID}t.LastSelection=t.RightSelection,t.$ajax.request(t.axiosConfig("web.INMQualControlComm","MoveCheckWard","Method","type$"+e,"parr$"+s)).then(function(e){1==e.data?t.LoadCheckWard(!0):t.$message({type:"warning",message:"操作失败",showClose:!0,customClass:"warning_class"})}).catch(function(e){t.$message({type:"error",message:"操作失败",showClose:!0,customClass:"error_class"})})}else t.$message({type:"warning",message:"请选择要移动的行",showClose:!0,customClass:"warning_class"})}},created:function(){this.LoadCheckPlanType(),this.GetAreaData()}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"nur-checkward-panel"},[s("div",{staticClass:"top-tool-inputDiv"},[s("el-form",{attrs:{model:e.WardTool,inline:!0}},[s("el-form-item",{attrs:{label:e.$t("menu.NurCheckWard.5nrnbr7613k0")}},[s("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"",size:"mini"},on:{change:e.RefreshWardData},model:{value:e.WardTool.CheckType,callback:function(t){e.$set(e.WardTool,"CheckType",t)},expression:"WardTool.CheckType"}},e._l(e.PlanTypeStore,function(e){return s("el-option",{key:e.rw,attrs:{value:e.rw,label:e.SubDesc}})}),1)],1)],1)],1),e._v(" "),s("div",[s("el-row",{staticStyle:{padding:"10px 12px 9px 10px"}},[s("el-col",{attrs:{span:11}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurCheckWard.5nrnbr77ms40"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[s("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[s("el-form",{attrs:{model:e.SysFinds,inline:!0}},[s("el-form-item",[s("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",clearable:"",placeholder:e.$t("menu.NurCheckWard.5nrnbr797k00"),size:"mini"},on:{change:e.LoadAllWard},model:{value:e.SysFinds.area,callback:function(t){e.$set(e.SysFinds,"area",t)},expression:"SysFinds.area"}},e._l(e.AreaData,function(e){return s("el-option",{key:e.rw,attrs:{value:e.rw,label:e.AreaDesc}})}),1)],1),e._v(" "),s("el-form-item",[s("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini","suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search",placeholder:e.$t("menu.NurCheckWard.5nrnbr7b8o40")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadAllWard(t)}},model:{value:e.SysFinds.input,callback:function(t){e.$set(e.SysFinds,"input",t)},expression:"SysFinds.input"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"WardStore",staticStyle:{width:"100%","border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.WardStore,height:e.styleCode?e.Height-169:e.Height-167,"header-cell-style":e.headerCellFontWeight,"row-style":e.elrowstyle,"highlight-current-row":!0,border:e.styleCode},on:{"selection-change":e.SetSelectionChange,"row-click":e.SysRowClick}},[s("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{type:"selection",align:"center",width:"55",selectable:e.IsSelectAble}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurCheckWard.5nrnbr7e67o0"),prop:"warddesc"}})],1)],1)])],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"bottom-button",staticStyle:{width:"100%",margin:"0 auto"},style:{height:e.Height-67+"px"}},[s("div",{staticStyle:{"text-align":"center","padding-bottom":"20px"},style:{"padding-top":(e.Height-107)/2+"px"}},[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.LeftSelection||0==e.LeftSelection.length},on:{click:e.MoveRight}},[s("i",{class:e.styleCode?"el-icon-arrow-right":"nm-icon-lite-right-arrow"})])],1),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,disabled:!e.RightSelection||0==e.RightSelection.length},on:{click:e.MoveLeft}},[s("i",{class:e.styleCode?"el-icon-arrow-left":"nm-icon-lite-left-arrow"})])],1)])]),e._v(" "),s("el-col",{attrs:{span:11}},[s("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.NurCheckWard.5nrnbr7f6q00"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-82}},[s("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[s("el-form",{attrs:{model:e.CheckFinds,inline:!0}},[s("el-form-item",[s("el-select",{staticStyle:{width:"100px"},attrs:{filterable:"",clearable:"",placeholder:e.$t("menu.NurCheckWard.5nrnbr797k00"),size:"mini"},on:{change:e.LoadCheckWard},model:{value:e.CheckFinds.area,callback:function(t){e.$set(e.CheckFinds,"area",t)},expression:"CheckFinds.area"}},e._l(e.AreaData,function(e){return s("el-option",{key:e.rw,attrs:{value:e.rw,label:e.AreaDesc}})}),1)],1),e._v(" "),s("el-form-item",[s("el-input",{staticStyle:{width:"110px"},attrs:{"suffix-icon":e.styleCode?"nm-icon-w-find":"nm-icon-lite-search",placeholder:e.$t("menu.NurCheckWard.5nrnbr7hrcg0"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.LoadCheckWard(t)}},model:{value:e.CheckFinds.input,callback:function(t){e.$set(e.CheckFinds,"input",t)},expression:"CheckFinds.input"}})],1),e._v(" "),s("el-form-item",[s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.MoveRec("U")}}},[e._v("↑")]),e._v(" "),s("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.MoveRec("D")}}},[e._v("↓")])],1)],1)],1),e._v(" "),s("div",{staticClass:"top-tool-table"},[s("el-table",{ref:"CheckedWardStore",staticStyle:{width:"100%","border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.CheckedWardStore,height:e.styleCode?e.Height-169:e.Height-167,"header-cell-style":e.headerCellFontWeight,"row-style":e.elrowstyle,"highlight-current-row":!0,border:e.styleCode},on:{"selection-change":e.CheckSelectionChange,"row-click":e.CheckRowClick}},[s("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurCheckWard.5nrnbr7e67o0"),prop:"WardDesc","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurCheckWard.5nrnbr7613k0"),prop:"WardTypeDesc",width:"80","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("menu.NurCheckWard.5nrnbr7d69g0"),prop:"WardSort",width:"50","show-overflow-tooltip":""}})],1)],1)])],1)],1)],1)])},staticRenderFns:[]};var c=s("VU/8")(l,i,!1,function(e){s("0Xzi")},null,null);t.default=c.exports}});