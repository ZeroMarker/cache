webpackJsonp([211],{LAhJ:function(e,t){},yGtF:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Dd8w"),l=o.n(s),c=o("NYxO"),a=o("XlQt"),i={components:{hgpanel:o("z8xk").default,Hgbutton:a.default},name:"BookCheck",computed:l()({},Object(c.b)(["Height","styleCode"])),data:function(){return{elementlist:{},CheckItemStore:[],NurToolForm:{NurName:""},NurTable:[],SelectNurRow:{},CheckToolForm:{Year:new Date},CheckTable:[],SelectCheckRow:"",CheckResultTable:[],CheckDialogVisible:!1,CheckLoading:!1,CheckForm:{Item:[],Reason:"",rw:""},CheckItemAll:"0",CheckItemStyle:!1,winFlag:0,selectFinished:!1}},methods:{LoadSysNurHead:function(){var e=this,t=this.NurToolForm.NurName;this.NurTable=[];var o=this.axiosConfig("web.INMHBComm","FindNurseHead","RecQuery","post$正护士长!科护士长","input$"+t);this.$ajax.request(o).then(function(t){t instanceof Object?(e.NurTable=t.data.rows,e.SelectNurRow=""):e.$message({type:"error",message:"获取系统护士长失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取系统护士长失败",showClose:!0,customClass:"error_class"})})},NurRowClick:function(e){this.SelectNurRow=e,this.LoadNurCheck()},LoadNurCheck:function(){var e=this;this.CheckTable=[],this.CheckResultTable=[];var t="";this.CheckToolForm.Year instanceof Date&&(t=this.CheckToolForm.Year.Format("YYYY"));var o=t+"^"+this.SelectNurRow.Per;this.SelectCheckRow="";var s=this.axiosConfig("web.INMHBComm","FindCheckList","RecQuery","parr$"+o);this.$ajax.request(s).then(function(t){t.data instanceof Object?(t.data.rows.forEach(function(e){e.CreateDateTime=e.CreateDate+" "+e.CreateTime,e.CheckItem=e.CheckItem?e.CheckItem.replace(/__/g,"||").split(","):[]}),e.CheckTable=t.data.rows):e.$message({type:"error",message:"获取审阅记录失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({type:"error",message:"获取审阅记录失败",showClose:!0,customClass:"error_class"})})},SearchNurCheckClick:function(){this.SelectNurRow&&this.SelectNurRow.Per?this.LoadNurCheck():this.$message({type:"warning",message:"请先选择一条人员数据",showClose:!0,customClass:"warning_class"})},CheckAddClick:function(){var e=this;this.winFlag=0,this.SelectNurRow&&this.SelectNurRow.Per?(this.CheckDialogVisible=!0,this.$nextTick(function(){e.$refs.CheckForm.resetFields(),e.CheckForm.rw="",e.CheckItemAll="0",e.CheckItemStyle=!1})):this.$message({type:"warning",message:"请先选择一条人员数据",showClose:!0,customClass:"warning_class"})},CheckAllChange:function(){var e=this;1==this.CheckItemAll?(this.CheckForm.Item.splice(0,this.CheckForm.Item.length),this.CheckItemStore.forEach(function(t){e.CheckForm.Item.push(t.SubValue)})):this.CheckForm.Item.splice(0,this.CheckForm.Item.length),this.CheckItemChange()},CheckItemChange:function(){0==this.CheckForm.Item.length?(this.CheckItemStyle=!1,this.CheckItemAll="0"):this.CheckForm.Item.length<this.CheckItemStore.length?this.CheckItemStyle=!0:(this.CheckItemStyle=!1,this.CheckItemAll="1")},SaveCheckForm:function(){var e=this,t="";this.CheckToolForm.Year instanceof Object&&(t=this.CheckToolForm.Year.Format("YYYY"));var o=t+"^"+this.SelectNurRow.Per+"^"+this.CheckForm.Item.join(",")+"^"+this.CheckForm.Reason+"^"+this.CheckForm.rw;this.CheckLoading=!0;var s=this.axiosConfig("web.INMHBComm","SaveBookCheck","Method","parr$"+o,"nurseid$"+sessionStorage.loginID);this.$ajax.request(s).then(function(t){e.CheckLoading=!1,1==t.data?(e.$message({type:"success",message:"保存成功",showClose:!0,customClass:"success_class"}),e.CheckDialogVisible=!1,e.LoadNurCheck()):e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})}).catch(function(t){e.CheckLoading=!1,e.$message({type:"error",message:"保存失败",showClose:!0,customClass:"error_class"})})},EditCheck:function(e){var t=this;this.winFlag=1,this.SelectCheckRow=e,this.CheckDialogVisible=!0,this.$nextTick(function(){t.$refs.CheckForm.resetFields(),t.CheckForm.Item=t.SelectCheckRow.CheckItem,t.CheckForm.Reason=t.SelectCheckRow.CheckReason,t.CheckForm.rw=t.SelectCheckRow.rw,t.CheckItemChange()})},CheckDeleteClick:function(){var e=this;this.SelectCheckRow&&this.SelectCheckRow.rw?this.$confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",closeOnClickModal:!1,type:"warning"}).then(function(){var t=e.axiosConfig("web.INMHBComm","DeleteBookCheck","Method","id$"+e.SelectCheckRow.rw);e.$ajax.request(t).then(function(t){1==t.data?(e.$message({message:"删除成功",type:"success",showClose:!0,customClass:"success_class"}),e.LoadNurCheck()):e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})}).catch(function(t){e.$message({message:"删除失败",type:"error",showClose:!0,customClass:"error_class"})})}).catch(function(){e.$message({type:"info",message:"取消删除",showClose:!0,customClass:"info_class"})}):this.$message({type:"warning",message:"请先选择一条审阅数据",showClose:!0,customClass:"warning_class"})},CheckRowClick:function(e){this.SelectCheckRow=e,this.LoadSelectCheckItem()},LoadSelectCheckItem:function(){var e=this;this.CheckResultTable=[];var t=[];this.CheckItemStore.forEach(function(o){t.push({CheckItem:o.SubDesc,CreateDateTime:e.SelectCheckRow.CreateDateTime,SubValue:o.SubValue})}),this.CheckResultTable=t;var o=this.CheckResultTable.filter(function(t){return e.SelectCheckRow.CheckItem.some(function(e){return e==t.SubValue})});o.length>0&&(this.selectFinished=!1,o.forEach(function(t,s){e.$nextTick(function(){e.$refs.CheckResultTable.toggleRowSelection(t,!0),s===o.length-1&&e.$nextTick(function(){e.selectFinished=!0})})}))},ResultSelectAble:function(e,t){return!this.selectFinished}},created:function(){this.loadSysParamSubData("审阅项目","CheckItemStore"),this.LoadSysNurHead();var e=this.$router.currentRoute.path.slice(1,this.$router.currentRoute.path.length);this.loadElementsForRouter("elementlist",e)}},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"book-check-panel"},[o("div",[o("el-row",{staticStyle:{padding:"10px 12px 10px 10px"},attrs:{gutter:12}},[o("el-col",{attrs:{span:8}},[o("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.BookCheck.5ncy67004d00"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-31}},[o("div",{staticClass:"panel-button-space",attrs:{slot:"tool"},slot:"tool"},[o("el-form",{attrs:{model:e.NurToolForm,inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-form-item",[o("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:e.$t("menu.BookCheck.5ncy670057g0"),size:"mini"},model:{value:e.NurToolForm.NurName,callback:function(t){e.$set(e.NurToolForm,"NurName",t)},expression:"NurToolForm.NurName"}})],1),e._v(" "),o("el-form-item",[o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.LoadSysNurHead}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb36ne940")))])],1)],1)],1),e._v(" "),o("div",{staticClass:"top-tool-table"},[o("el-table",{staticStyle:{"border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.NurTable,"highlight-current-row":"","header-cell-style":e.headerCellFontWeight,border:e.styleCode,height:e.styleCode?e.Height-118:e.Height-116},on:{"row-click":e.NurRowClick}},[o("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5nrnb36qz500"),prop:"PerName","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5nrnb36sq900"),prop:"WardDesc","show-overflow-tooltip":""}})],1)],1)])],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.BookCheck.5ncy67007jg0"),styleCode:e.styleCode,icon:"#nm-icon-paper",panelHeight:e.Height-31}},[o("div",{attrs:{slot:"tool"},slot:"tool"},[o("div",{staticClass:"top-tool-inputDiv"},[o("el-form",{attrs:{model:e.CheckToolForm,inline:!0}},[o("el-form-item",[o("el-date-picker",{staticStyle:{width:"100px"},attrs:{type:"year",size:"mini"},model:{value:e.CheckToolForm.Year,callback:function(t){e.$set(e.CheckToolForm,"Year",t)},expression:"CheckToolForm.Year"}})],1),e._v(" "),o("el-form-item",[o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.SearchNurCheckClick}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb36ne940")))])],1)],1)],1),e._v(" "),o("div",{staticClass:"top-tool-button"},[0==this.$store.state.login.LoginId||e.elementlist.recadd?o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-stamp":"nm-icon-lite-stamp"},on:{click:e.CheckAddClick}},[e._v(e._s(e.$t("menu.BookCheck.5ncy67008vw0")))]):e._e(),e._v(" "),0==this.$store.state.login.LoginId||e.elementlist.recdel?o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-cancel":"nm-icon-lite-cancel"},on:{click:e.CheckDeleteClick}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb36swi80")))]):e._e()],1)]),e._v(" "),o("div",{staticClass:"top-tool-table"},[o("el-table",{staticStyle:{"border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.CheckTable,"highlight-current-row":"","header-cell-style":e.headerCellFontWeight,border:e.styleCode,height:e.styleCode?e.Height-155:e.Height-149},on:{"row-click":e.CheckRowClick,"row-dblclick":e.EditCheck}},[o("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5ncy67009zc0"),prop:"CreateDateTime","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5ncy6700a6s0"),prop:"CreatorName","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5nrnb36xdz80"),width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-edit":"nm-icon-lite-w-edit"},on:{click:function(o){return e.EditCheck(t.row)}}})]}}])})],1)],1)])],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("hgpanel",{staticStyle:{width:"100%"},attrs:{title:e.$t("menu.BookCheck.5ncy6700bh00"),icon:"#nm-icon-paper",styleCode:e.styleCode,panelHeight:e.Height-31}},[o("div",{staticClass:"top-tool-table",staticStyle:{"margin-top":"2px"}},[o("el-table",{ref:"CheckResultTable",staticStyle:{"border-bottom-right-radius":"4px","border-bottom-left-radius":"4px","border-bottom":"0"},attrs:{data:e.CheckResultTable,"highlight-current-row":"",border:e.styleCode,height:e.styleCode?e.Height-71:e.Height-68,"header-cell-style":e.headerCellFontWeight}},[o("el-table-column",{attrs:{type:"selection",selectable:e.ResultSelectAble,align:"center",width:"50"}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5ncy6700c6o0"),prop:"CheckItem","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:e.$t("menu.BookCheck.5ncy67009zc0"),prop:"CreateDateTime","show-overflow-tooltip":""}})],1)],1)])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:0==e.winFlag?e.$t("menu.BookCheck.5ncy67008vw0"):e.$t("menu.BookCheck.5nrnb36xg0g1"),visible:e.CheckDialogVisible,"close-on-click-modal":!1,width:"650px"},on:{"update:visible":function(t){e.CheckDialogVisible=t}}},[o("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?o("i",{class:[0==e.winFlag?"nm-icon-w-paper":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?o("span",[e._v(e._s(e.$t("menu.BookCheck.5ncy67008vw0")))]):1==e.winFlag?o("span",[e._v(e._s(e.$t("menu.BookCheck.5nrnb36xg0g1")))]):e._e()]),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.CheckLoading,expression:"CheckLoading"}],staticClass:"check-book-item",attrs:{"element-loading-text":e.$t("menu.BookCheck.5nrnb3716pc0")}},[o("el-form",{ref:"CheckForm",attrs:{model:e.CheckForm,"label-position":"right","label-width":"70px",align:"left"}},[o("el-form-item",{attrs:{label:e.$t("menu.BookCheck.5ncy6700djk0"),prop:"Item"}},[o("el-col",{attrs:{span:24}},[o("el-checkbox",{attrs:{"true-label":"1","false-label":"0",indeterminate:e.CheckItemStyle,size:"mini"},on:{change:e.CheckAllChange},model:{value:e.CheckItemAll,callback:function(t){e.CheckItemAll=t},expression:"CheckItemAll"}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb371a4w0")))])],1),e._v(" "),o("el-checkbox-group",{staticClass:"check-item",attrs:{size:"mini"},on:{change:e.CheckItemChange},model:{value:e.CheckForm.Item,callback:function(t){e.$set(e.CheckForm,"Item",t)},expression:"CheckForm.Item"}},e._l(e.CheckItemStore,function(t){return o("el-checkbox-button",{key:t.SubValue,attrs:{label:t.SubValue}},[e._v(e._s(t.SubDesc))])}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:e.$t("menu.BookCheck.5nrnb3742s40"),prop:"Reason"}},[o("el-input",{staticStyle:{width:"556px"},attrs:{type:"textarea",placeholder:"",rows:3,maxlength:"500","show-word-limit":"",size:"mini"},model:{value:e.CheckForm.Reason,callback:function(t){e.$set(e.CheckForm,"Reason",t)},expression:"CheckForm.Reason"}})],1)],1),e._v(" "),o("div",{staticClass:"bottom-button"},[o("hgbutton",{attrs:{type:e.styleCode?"default":"success",styleCode:e.styleCode},on:{click:e.SaveCheckForm}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb3745eg0")))]),e._v(" "),o("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.CheckDialogVisible=!1}}},[e._v(e._s(e.$t("menu.BookCheck.5nrnb3746180")))])],1)],1)])],1)},staticRenderFns:[]};var n=o("VU/8")(i,r,!1,function(e){o("LAhJ")},null,null);t.default=n.exports}});