webpackJsonp([170],{GWJd:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__("Dd8w"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1__hgcommon_pagination_pager_vue__=__webpack_require__("W5Fe"),__WEBPACK_IMPORTED_MODULE_2__hgcommon_button_hgbutton_vue__=__webpack_require__("XlQt"),__WEBPACK_IMPORTED_MODULE_3_vuex__=__webpack_require__("NYxO"),echarts=__webpack_require__("Icdr");__webpack_require__("Vb+l"),__webpack_require__("Oq2I"),__webpack_require__("miEh"),__webpack_exports__.a={name:"NurseResignRate",id:"NurseResignRate",components:{hgpagination:__WEBPACK_IMPORTED_MODULE_1__hgcommon_pagination_pager_vue__.default,hgbutton:__WEBPACK_IMPORTED_MODULE_2__hgcommon_button_hgbutton_vue__.default},computed:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},Object(__WEBPACK_IMPORTED_MODULE_3_vuex__.b)(["styleCode"])),data:function(){return{tableData:[],subbutton:[{index:0,code:"sthireduty",desc:"期初职称"},{index:1,code:"stdegree",desc:"期初学历"},{index:2,code:"styears",desc:"期初年限"},{index:3,code:"endhireduty",desc:"期末职称"},{index:4,code:"enddegree",desc:"期末学历"},{index:5,code:"endyears",desc:"期末年限"},{index:6,code:"resignhireduty",desc:"离职职称"},{index:7,code:"resigndegree",desc:"离职学历"},{index:8,code:"resignyears",desc:"离职年限"}],tableHeight:"",pagesize:20,currentPage:1,totalCount:0,form:{ward:"",stdate:"",enddate:""},ward:"",tablewardrw:"",dialog:{visible:!1,title:"",data:[],name:"",colors:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"]}}},methods:{initdata:function(){var e=new Date;this.form.enddate=new Date,this.form.stdate=new Date(e.setMonth(e.getMonth()-1)),this.loaddata()},loaddata:function(){var e=this,t=e.form.stdate;if(!(t instanceof Date))return e.warnInfo(0==t.length?"开始日期不能为空":"开始日期格式不正确"),!1;t=t.Format("YYYY-MM-dd");var a=e.form.enddate;if(!(a instanceof Date))return e.warnInfo(0==a.length?"结束日期不能为空":"结束日期格式不正确"),!1;a=a.Format("YYYY-MM-dd");var r=e.form.ward+"^"+t+"^"+a;e.$ajax.request(e.axiosConfig("web.INMPersonCountComm","FindWardPersonCountBytime","RecQuery","start$"+(e.currentPage-1)*e.pagesize,"limit$"+e.pagesize,"parr$"+r,"nurseid$"+sessionStorage.getItem("loginID"))).then(function(t){e.tableData=t.data.rows,e.totalCount=parseInt(t.data.results),e.tablewardrw=""}).catch(function(e){})},loadchartdata:function loadchartdata(index){var that=this;that.dialog.colors=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"];var ward=that.tablewardrw;""==ward&&(ward=that.form.ward),""==ward&&(ward=0);var stdate=that.form.stdate;if(!(stdate instanceof Date))return that.warnInfo(0==stdate.lenght?"开始日期不能为空":"开始日期格式不正确"),!1;stdate=stdate.Format("YYYY-MM-dd");var enddate=that.form.enddate;if(!(enddate instanceof Date))return that.warnInfo(0==enddate.lenght?"结束日期不能为空":"结束日期格式不正确"),!1;enddate=enddate.Format("YYYY-MM-dd");var parr=ward+"^"+stdate+"^"+enddate+"^"+that.subbutton[index].code;that.$ajax.request(that.axiosConfig("web.INMPersonCountComm","getCountByTime","Method","parr$"+parr)).then(function(res){if(""!=res.data){for(var data=eval(res.data),total=0,adata=new Array,colors=new Array,i=0;i<data.length;i++)total+=data[i].value,void 0!=data[i].color&&colors.push(data[i].color);if(0!=total){0!=colors.length&&(that.dialog.colors=colors);for(var warddesc="全院",i=0;i<that.ward.length;i++){var itm=that.ward[i];itm.rw==ward&&(warddesc=itm.WardDesc)}that.dialog.name=that.subbutton[index].desc,that.dialog.title=warddesc+that.subbutton[index].desc+"统计(总人数:"+total+")",that.dialog.visible=!0,that.dialog.data=data,that.drawCharts()}else that.$message({type:"warning",message:"总数据为0",showClose:!0,customClass:"warning_class"})}}).catch(function(e){})},drawCharts:function(){var e=this;this.$nextTick(function(){document.getElementById("chartsdiv");echarts.dispose(document.getElementById("chartsdiv")),echarts.init(document.getElementById("chartsdiv")).setOption({title:{show:!1},color:e.dialog.colors,tooltip:{trigger:"item",formatter:"{b}人数 : {c} ({d}%)"},series:[{name:"",type:"pie",hoverAnimation:!1,radius:"50%",center:["50%","50%"],itemStyle:{normal:{label:{show:!0,formatter:"{b}({c}人):{d}%"},labelLine:{show:!0}},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:e.dialog.data}]})})},row_click:function(e,t,a){this.tablewardrw=e.rw},handleSizeChange:function(e){this.pagesize=e,this.loaddata()},handleCurrentChange:function(e){this.currentPage=e.currentPage,this.loaddata()},loadWardData:function(){var e=this,t=e.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","nurseid$"+sessionStorage.getItem("loginID"));e.$ajax.request(t).then(function(t){e.ward=t.data.rows})},warnInfo:function(e){this.$message({message:e,type:"warning",showClose:!0,customClass:"warning_class"})}},created:function(){this.tableHeight=this.$store.state.mainframe.Height-175,this.loadWardData(),this.initdata()}}},"Q+Oi":function(e,t){},g07M:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("GWJd"),o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nurresignrate-panel"},[a("div",{staticClass:"top-tool-button-dialog-toph dialog-div-top-radius"},[a("el-form",{attrs:{inline:!0,"label-position":"left"}},[a("el-form-item",{attrs:{label:e.$t("menu.NurseResignRate.5nrnbfugmms0")}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,clearable:!1,placeholder:e.$t("menu.NurseResignRate.5nrnbfugmms0"),size:"mini"},on:{change:e.loaddata},model:{value:e.form.stdate,callback:function(t){e.$set(e.form,"stdate",t)},expression:"form.stdate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurseResignRate.5nrnbfukoxs0")}},[a("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,clearable:!1,placeholder:e.$t("menu.NurseResignRate.5nrnbfukoxs0"),size:"mini"},on:{change:e.loaddata},model:{value:e.form.enddate,callback:function(t){e.$set(e.form,"enddate",t)},expression:"form.enddate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("menu.NurseResignRate.5nrnbfup1e40")}},[a("el-select",{staticStyle:{width:"300px"},attrs:{multiple:"",filterable:"",clearable:"","collapse-tags":"",placeholder:e.$t("menu.NurseResignRate.5nrnbfuqon40"),size:"mini"},on:{change:e.loaddata},model:{value:e.form.ward,callback:function(t){e.$set(e.form,"ward",t)},expression:"form.ward"}},e._l(e.ward,function(e){return a("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1)],1)],1),e._v(" "),a("div",{staticClass:"top-tool-buttonDiv resign-rate-button"},e._l(e.subbutton,function(t){return a("hgbutton",{key:t.index,attrs:{type:"text",styleCode:e.styleCode},on:{click:function(a){return e.loadchartdata(t.index)}}},[e._v(e._s(t.desc))])}),1),e._v(" "),a("div",{staticClass:"top-tool-dialog-table dialog-table-bottom-radius"},[a("el-table",{attrs:{data:e.tableData,height:e.tableHeight,width:"100%",border:e.styleCode,"header-cell-style":e.headerCellFontWeight,"highlight-current-row":"",align:"left"},on:{"row-click":e.row_click}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"WardCode",label:e.$t("menu.NurseResignRate.5nrnbfuu9cg0"),"show-overflow-tooltip":"",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"WardDesc",label:e.$t("menu.NurseResignRate.5nrnbfup1e40"),"show-overflow-tooltip":"",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"StNum",label:e.$t("menu.NurseResignRate.5ncy6djy9zk0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"NewNum",label:e.$t("menu.NurseResignRate.5ncy6djyai40"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ResignNum",label:e.$t("menu.NurseResignRate.5ncy6djyawc0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TransinNum",label:e.$t("menu.NurseResignRate.5ncy6djyb9o0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TransoutNum",label:e.$t("menu.NurseResignRate.5ncy6djyblc0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"EndNum",label:e.$t("menu.NurseResignRate.5ncy6djyc2o0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ResignRate",label:e.$t("menu.NurseResignRate.5nrnbfuzm700"),"show-overflow-tooltip":"",width:""}}),e._v(" "),e._e()],1),e._v(" "),a("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.totalCount,pageNumber:e.currentPage,pageSize:e.pagesize},on:{changePage:e.handleCurrentChange,getPageSize:e.handleSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialog.title,width:"40%",modal:"","append-to-body":!0,"close-on-click-modal":!1,top:"4%",visible:e.dialog.visible,align:"center"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[a("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?a("i",{staticClass:"nm-icon-w-paper"}):e._e(),e._v(" "),a("span",[e._v(e._s(e.dialog.title))])]),e._v(" "),a("div",{staticStyle:{width:"100%",height:"400px"},attrs:{id:"chartsdiv"}})])],1)},staticRenderFns:[]};var n=function(e){a("Q+Oi")},i=a("VU/8")(r.a,o,!1,n,null,null);t.default=i.exports}});