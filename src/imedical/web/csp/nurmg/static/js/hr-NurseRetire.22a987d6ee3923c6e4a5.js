webpackJsonp([223],{"72wS":function(e,t){},CS4J:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("Dd8w"),r=n.n(s),a=n("NYxO"),i=n("XlQt"),o=n("W5Fe"),l=n("Icdr");n("GbHy"),n("Vb+l"),n("Oq2I"),n("miEh");var u={components:{hgbutton:i.default,hgpagination:o.default},computed:r()({},Object(a.b)(["Height","SysTomcat","LoginId","DateFormat","MonthFormat","styleCode"])),name:"NurseResign",data:function(){return{nursename:{},pageSize:{width:"",height:""},tableHeight:"",nursewarddata:[],nurseresigntable:[],nurseresigntableAll:[],nurseresignform:{nurseno:"",nursenward:"",stdate:new Date((new Date).getFullYear(),(new Date).getMonth(),1),enddate:new Date((new Date).getFullYear(),(new Date).getMonth()+1,0),state:""},checkrow:"",pagesize:20,currentPage:1,totalCount:0,elementlist:[],dialogResignVisible:!1,nurseresignedit:{RetireName:"",ResignDate:"",nurseidno:"",ResignReason:[],ResignOther:"",RowID:""},rules:{nurseidno:[{required:!0,message:"工号不能为空",trigger:"blur"}],RetireName:[{required:!0,message:"姓名不能为空！",trigger:"blur"}],ResignDate:[{required:!0,message:"退休日期不能为空！",trigger:"change",type:"date"}],ResignReason:[{required:!0,message:"退休原因不能为空！",trigger:"change",type:"array"}]},showFlag:!1,resignInfoStore:[],resignWardStore:[],reasonstore:[],nurseresigncheck:{Opinion:""},dialogReasonVisible:!1,xData:[],yData:[],legendData:[],rateData:[],year:(new Date).getMonthDate(1).getMonthDate(1),colors:["#c1232B","#b6a2de","#5ab1ef","#ffb980","#d87a80","#d898b3","#e5cf0d","#97b552","#dc69aa","#07a2a4","#9a7fd1","#f5994e","#c05050","#c14089","#c9ab00","#7eb00a","#6f5553"],winFlag:0}},methods:{setSize:function(){this.pageSize.width=document.documentElement.clientWidth-180+"px",this.pageSize.height=document.documentElement.clientHeight-100+"px"},retireStatic:function(){this.dialogReasonVisible=!0,this.loadReasonChart()},loadReasonChart:function(){var e=this;e.yData=new Array,e.legendData=new Array,e.rateData=[];var t=e.year;t instanceof Date&&(t=t.Format("YYYY-MM-dd")),e.$ajax.request(e.axiosConfig("web.INMInternComm","GetResignReason","Method","parr$退休原因")).then(function(n){e.$ajax(e.axiosConfig("web.INMInternComm","GetResignData","Method","parr$退休原因","year$"+t,"type$N")).then(function(t){e.xData=n.data,e.rateData=t.data,e.drawPieCharts()})})},drawPieCharts:function(){var e=this,t=e.yData;t||(t=new Array);e.$nextTick(function(){l.dispose(document.getElementById("RetireReasonChart")),l.init(document.getElementById("RetireReasonChart")).setOption({title:{text:"退休原因占比",x:"center",textStyle:{fontWeight:"normal"}},color:e.colors,tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c}({d}%)"},legend:{orient:"vertical",left:"2",data:e.xData,textStyle:{color:"#000"}},toolbox:{show:!0,right:"0",feature:{mark:{show:!0},dataView:{show:!1,readOnly:!1},magicType:{show:!0,type:["pie","funnel"],opinion:{funnel:{x:"25%",width:"50%",funnelAlign:"left",max:1548}}},restore:{show:!1},saveAsImage:{show:!0}}},calculbale:!0,series:[{name:"退休原因占比",type:"pie",redius:"55%",center:["50%","50%"],data:e.rateData}]})})},yearChangeEvent:function(e){this.loadReasonChart()},loadLocData:function(){var e,t=this;e=t.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","role$"+sessionStorage.getItem("loginRoleCodes"),"nurseid$"+sessionStorage.getItem("loginID")),t.$ajax.request(e).then(function(e){t.nursewarddata=e.data.rows})},addResignData:function(){var e=this;e.winFlag=0,e.dialogResignVisible=!0,e.nursename="",e.$nextTick(function(){e.$refs.nurseresignedit.resetFields(),e.nurseresignedit.RowID="",e.showFlag=!0})},rowDbClickEvent:function(e,t){var n=this;n.winFlag=1,n.$ajax.request(n.axiosConfig("web.INMInternComm","GetResignStatu","Method","id$"+e.rowid)).then(function(t){if(""==t.data||"N"==t.data||"B"==t.data)n.dialogResignVisible=!0,n.$nextTick(function(){n.$refs.nurseresignedit.resetFields(),n.$refs.nurseresigncheck.resetFields(),n.showFlag=!0,n.loadEditData(e.rowid)});else{if("Y"==t.data)return void n.$message({type:"warning",message:"已经提交，不能修改",showClose:!0,customClass:"warning_class"});if("A"==t.data)return void n.$message({type:"warning",message:"已经提交，不能修改",showClose:!0,customClass:"warning_class"})}})},rowClickEvent:function(e,t,n){this.checkrow=e.rowid},searchResignData:function(){var e,t=this,n=t.nurseresignform.nurseno,s=t.nurseresignform.nursenward,r=t.nurseresignform.stdate;r=r instanceof Date?r.Format("YYYY-MM-dd"):"";var a=t.nurseresignform.enddate;e=n+"^"+s+"^"+r+"^"+(a=a instanceof Date?a.Format("YYYY-MM-dd"):"")+"^"+t.nurseresignform.state,t.$ajax.request(t.axiosConfig("web.INMInternComm","FindRetireLists","RecQuery","parr$"+e,"nursetype$N","role$"+sessionStorage.getItem("loginRoleCodes"),"nurseid$"+sessionStorage.getItem("loginID"))).then(function(e){t.nurseresigntable=e.data.rows.slice((t.currentPage-1)*t.pagesize,(t.currentPage-1)*t.pagesize+t.pagesize),t.nurseresigntableAll=e.data.rows,NaN!=parseInt(e.data.results)?t.totalCount=parseInt(e.data.results):t.totalCount=0,t.checkrow=""})},handleSizeChange:function(e){this.pagesize=e,this.searchResignData()},handleCurrentChange:function(e){this.currentPage=e.currentPage,this.searchResignData()},loadResignInfoStore:function(){var e=this;e.$ajax.request(e.axiosConfig("web.INMInternComm","FindInternInfo","RecQuery","start$0","limit$10000","parr$","nursetype$N","role$"+sessionStorage.getItem("loginRoleCodes"),"nurseid$"+sessionStorage.getItem("loginID"))).then(function(t){e.resignInfoStore=t.data.rows})},loadResignWardStore:function(){var e=this,t=e.axiosConfig("web.INMDataLimit","FindRoleWardList","RecQuery","role$"+sessionStorage.getItem("loginRoleCodes"),"nurseid$"+sessionStorage.getItem("loginID"));e.$ajax.request(t).then(function(t){e.resignWardStore=t.data.rows})},loadEditData:function(e){var t=this;t.$nextTick(function(){e&&t.$ajax.request(t.axiosConfig("web.INMInternComm","GetResign","RecMethod","id$"+e)).then(function(e){t.isEmptyObject(e.data)||t.setFormValue(e.data,"nurseresignedit")})})},setFormValue:function(e,t){for(var n in this[t]){for(var s=this.$refs[t].$children,r=s.length,a=0;a<r;a++)s[a].$options.propsData.prop==n&&("el-date-picker"==s[a].$children[0].$options._componentTag?e[n]?this[t][n]=new Date(Date.parse(e[n].replace(/-/g,"/"))):this[t][n]=e[n]:"el-checkbox-group"==s[a].$children[0].$options._componentTag?e.ResignReason&&(this[t][n]=e.ResignReason.split("~")):this[t][n]=e[n]);"RowID"!=n&&"ResignOther"!=n||(this[t][n]=e[n])}},handlerSure:function(e){var t=this,n=t[e].ResignDate;n=n instanceof Date?n.Format("YYYY-MM-dd"):"";var s=s+"^RowID|"+t[e].RowID+"^ResignDate|"+n+"^ResignReason|"+t[e].ResignReason+"^ResignCreater|"+sessionStorage.getItem("loginID")+"^ResignOther|"+t[e].ResignOther+"^ResignName|"+t.nursename.id+"^ResignWard|"+t.nursename.nurward;this.$refs[e].validate(function(e){if(!e)return!1;t.$confirm("确认提交？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$nextTick(function(){t.$ajax.request(t.axiosConfig("web.INMInternComm","CheckRetireRec","Method","parr$"+s)).then(function(e){if(e.data>0)t.$message({type:"success",message:"提交成功！",showClose:!0,customClass:"success_class"}),t.dialogResignVisible=!1,t.searchResignData(),t.clearnurmessage();else if(0==e.data)return t.$message({type:"warning",message:"提交失败",showClose:!0,customClass:"warning_class"}),void t.clearnurmessage()})})}).catch(function(){t.$message({type:"info",message:"已取消操作",showClose:!0,customClass:"info_class"})})})},nurno_change:function(){var e=this;e.nurseresignedit.nurseidno&&e.$ajax.request(e.axiosConfig("web.INMPersonComm","GetNurseMessage","RecMethod","nurseno$"+e.nurseresignedit.nurseidno)).then(function(t){return"-1"==t.data.flags?(e.$message({type:"warning",message:"工号不存在",showClose:!0,customClass:"warning_class"}),void e.clearnurmessage()):"0"==t.data.flags?(e.$message({type:"info",message:"员工已退休",showClose:!0,customClass:"info_class"}),void e.clearnurmessage()):void(e.nursename=t.data)})},clearnurmessage:function(){this.nurseresignedit.nurseidno="",this.nursename=""},isEmptyObject:function(e){var t;for(t in e)return!1;return!0}},created:function(){var e=this;e.setSize(),e.tableHeight=e.$store.state.mainframe.Height-130,e.loadLocData(),e.searchResignData(),e.loadSysParamSubData("退休原因","reasonstore"),e.loadResignWardStore();var t=e.$router.currentRoute.path.slice(1,e.$router.currentRoute.path.length);e.$nextTick(function(){e.loadElementsForRouter("elementlist",t)})}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"nurse-retire-panel"},[n("div",{staticClass:"top-tool-inputDiv"},[n("el-form",{attrs:{inline:!0,model:e.nurseresignform,"label-position":"left"}},[n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgn6uks0")}},[n("el-select",{staticStyle:{width:"140px"},attrs:{filterable:"",clearable:"",placeholder:e.$t("menu.NurseRetire.5nrnbgn7rp00"),size:"mini"},model:{value:e.nurseresignform.nursenward,callback:function(t){e.$set(e.nurseresignform,"nursenward",t)},expression:"nurseresignform.nursenward"}},e._l(e.nursewarddata,function(e){return n("el-option",{key:e.rw,attrs:{label:e.WardDesc,value:e.rw}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgn8o8o0")}},[n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:e.$t("menu.NurseRetire.5nrnbgn9o340"),size:"mini"},model:{value:e.nurseresignform.nurseno,callback:function(t){e.$set(e.nurseresignform,"nurseno",t)},expression:"nurseresignform.nurseno"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgnb4rk0")}},[n("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.NurseRetire.5nrnbgnb4rk0"),size:"mini"},model:{value:e.nurseresignform.stdate,callback:function(t){e.$set(e.nurseresignform,"stdate",t)},expression:"nurseresignform.stdate"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgndf5o0")}},[n("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.NurseRetire.5nrnbgndf5o0"),size:"mini"},model:{value:e.nurseresignform.enddate,callback:function(t){e.$set(e.nurseresignform,"enddate",t)},expression:"nurseresignform.enddate"}})],1),e._v(" "),n("el-form-item",[this.elementlist.resignsearch||0==e.LoginId?n("hgbutton",{ref:"resignsearch",attrs:{type:"default",styleCode:e.styleCode,icon:"nm-icon-w-find"},on:{click:e.searchResignData}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgned7k0")))]):e._e()],1)],1)],1),e._v(" "),n("div",{staticClass:"top-tool-button"},[this.elementlist.resignadd||0==e.LoginId?n("hgbutton",{ref:"resignadd",attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-add":"nm-icon-lite-add"},on:{click:e.addResignData}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnee6w0")))]):e._e(),e._v(" "),this.elementlist.retirereason||0==e.LoginId?n("hgbutton",{ref:"retirereason",attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-wax_stat":"nm-icon-lite-caseload"},on:{click:e.retireStatic}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnef3w0")))]):e._e(),e._v(" "),this.elementlist.exportedit||0==e.LoginId?n("hgbutton",{attrs:{type:"text",issvg:e.styleCode,icon:e.styleCode?"#nm-icon-export":"nm-icon-lite-export"},on:{click:function(t){e.exportData("nurseresigntable",e.nurseresigntableAll,e.$t("menu.NurseRetire.5ncy6e7tabs0"))}}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnefmo0")))]):e._e()],1),e._v(" "),n("div",{staticClass:"top-tool-table"},[n("el-table",{ref:"nurseresigntable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,data:e.nurseresigntable,"header-cell-style":e.headerCellFontWeight,border:e.styleCode,height:e.styleCode?e.tableHeight:e.tableHeight+6},on:{"row-dblclick":e.rowDbClickEvent,"row-click":e.rowClickEvent}},[n("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"nurseID",label:e.$t("menu.NurseRetire.5nrnbgng8y80"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"resignName",label:e.$t("menu.NurseRetire.5nrnbgnh4sc0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"resignWard",label:e.$t("menu.NurseRetire.5nrnbgn6uks0"),"show-overflow-tooltip":"",width:"120"}}),e._v(" "),n("el-table-column",{attrs:{prop:"resignDate",label:e.$t("menu.NurseRetire.5nrnbgnjgbo0"),"show-overflow-tooltip":"",width:"100",formatter:e.PTableDateHisShow}}),e._v(" "),n("el-table-column",{attrs:{prop:"resignReason",label:e.$t("menu.NurseRetire.5nrnbgnef3w0"),"show-overflow-tooltip":"",width:""}}),e._v(" "),n("el-table-column",{attrs:{prop:"creater",label:e.$t("menu.NurseRetire.5nrnbgnm3x40"),"show-overflow-tooltip":"",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{prop:"createDate",label:e.$t("menu.NurseRetire.5nrnbgnn2jw0"),"show-overflow-tooltip":"",width:"100",formatter:e.PTableDateHisShow}}),e._v(" "),e._e()],1),e._v(" "),n("hgpagination",{attrs:{styleCode:e.styleCode,sizes:[20,40,50,100],totalCount:e.totalCount,pageNumber:e.currentPage,pageSize:e.pagesize},on:{changePage:e.handleCurrentChange,getPageSize:e.handleSizeChange}})],1),e._v(" "),n("el-dialog",{staticClass:"retire-reason",attrs:{title:0==e.winFlag?e.$t("menu.NurseRetire.5nrnbgnee6w0"):e.$t("menu.NurseRetire.5nrnbgnee6w1"),modal:"","close-on-click-modal":!1,visible:e.dialogResignVisible,width:"450px"},on:{"update:visible":function(t){e.dialogResignVisible=t}}},[n("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?n("i",{class:[0==e.winFlag?"nm-icon-w-plus":"nm-icon-w-edit"]}):e._e(),e._v(" "),0==e.winFlag?n("span",[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnee6w0")))]):1==e.winFlag?n("span",[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnee6w0")))]):e._e()]),e._v(" "),n("el-form",{ref:"nurseresignedit",attrs:{model:e.nurseresignedit,rules:e.rules,inline:!0,"label-position":"right","label-width":"140px",align:"left"}},[n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgng8y80"),prop:"nurseidno"}},[n("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:e.$t("menu.NurseRetire.5ncy6e7vkuw0"),size:"mini"},on:{blur:e.nurno_change},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nurno_change(t)}},model:{value:e.nurseresignedit.nurseidno,callback:function(t){e.$set(e.nurseresignedit,"nurseidno",t)},expression:"nurseresignedit.nurseidno"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgnh4sc0"),prop:""}},[n("el-input",{staticStyle:{width:"250px"},attrs:{value:e.nursename.name,placeholder:e.$t("menu.NurseRetire.5nrnbgnh4sc0"),disabled:!0,size:"mini"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.NurseRetire.5nrnbgnjgbo0"),prop:"ResignDate"}},[n("el-date-picker",{staticStyle:{width:"250px"},attrs:{type:"date",format:this.$store.state.mainframe.DateFormat,placeholder:e.$t("menu.NurseRetire.5nrnbgnxefk0"),size:"mini",disabled:!1},model:{value:e.nurseresignedit.ResignDate,callback:function(t){e.$set(e.nurseresignedit,"ResignDate",t)},expression:"nurseresignedit.ResignDate"}})],1),e._v(" "),n("el-form-item",{staticClass:"retirecheck-panel",attrs:{label:e.$t("menu.NurseRetire.5ncy6e7vne80"),prop:"ResignReason"}},[n("div",[n("el-checkbox-group",{staticStyle:{width:"250px"},model:{value:e.nurseresignedit.ResignReason,callback:function(t){e.$set(e.nurseresignedit,"ResignReason",t)},expression:"nurseresignedit.ResignReason"}},e._l(e.reasonstore,function(t){return n("el-checkbox",{key:t.SubValue,staticStyle:{width:"100%",margin:"0",padding:"0px"},attrs:{label:t.SubValue,disabled:!e.showFlag}},[e._v(e._s(t.SubDesc))])}),1)],1)])],1),e._v(" "),n("div",{staticStyle:{margin:"10px 0 0 0","text-align":"center","font-size":"0"}},[n("hgbutton",{directives:[{name:"show",rawName:"v-show",value:e.showFlag,expression:"showFlag"}],ref:"resignsubmit",attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){return e.handlerSure("nurseresignedit")}}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnxhyw0")))]),e._v(" "),n("hgbutton",{attrs:{type:"default",styleCode:e.styleCode},on:{click:function(t){e.dialogResignVisible=!1}}},[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnximk0")))])],1)],1),e._v(" "),n("div",[n("el-dialog",{attrs:{title:e.$t("menu.NurseRetire.5nrnbgnef3w0"),modal:"","close-on-click-modal":!1,visible:e.dialogReasonVisible,width:"864px"},on:{"update:visible":function(t){e.dialogReasonVisible=t}}},[n("div",{staticClass:"dialog-header-title",attrs:{slot:"title"},slot:"title"},[e.styleCode?n("i",{staticClass:"nm-icon-w-paper"}):e._e(),e._v(" "),n("span",[e._v(e._s(e.$t("menu.NurseRetire.5nrnbgnef3w0")))])]),e._v(" "),n("div",{staticStyle:{"text-align":"left"}},[n("el-date-picker",{staticStyle:{"margin-left":"7px"},attrs:{size:"mini",type:"year",placeholder:e.$t("menu.NurseRetire.5nrnbgo0cxw0")},on:{change:e.yearChangeEvent},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}}),e._v(" "),n("div",{staticStyle:{height:"400px","margin-top":"10px","margin-bottom":"20px"},attrs:{id:"RetireReasonChart"}})],1)])],1)],1)},staticRenderFns:[]};var d=n("VU/8")(u,g,!1,function(e){n("72wS")},null,null);t.default=d.exports}});