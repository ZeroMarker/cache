<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
    i ##Class(websys.SessionEvents).SessionExpired() q 1
    q 1
</csp:method>
<csp:content charset="UTF-8">

<script language="cache" runat="server">

    s Action=$Get(%request.Data("actiontype",1))
    s Start=$Get(%request.Data("start",1))
    s Limit=$Get(%request.Data("limit",1))
    s Sort=$Get(%request.Data("sort",1))
    s Dir=$Get(%request.Data("dir",1))
    
    //科室的支配科室
    i Action = "getSubLocList" d
    .s mainLoc=$Get(%request.Data("mainLoc",1))
    .s result = ##class(web.DHCSTM.DHCSubLocReqConfig).jsSubLocList(Start,Limit,Sort,Dir,mainLoc)
    .i result = "" d
    ..w "{results:0,rows:[]}"
    .e  d
    ..w result

    //
    i Action = "getSubLocReqConfig" d
    .s subLoc=$Get(%request.Data("subLoc",1))
    .s userGrp=$Get(%request.Data("userGrp",1))
    .s configtype=$Get(%request.Data("configtype",1))
    .s result = ##class(web.DHCSTM.DHCSubLocReqConfig).jsSubLocReqConfig(Start,Limit,Sort,Dir,subLoc,userGrp,configtype)
    .i result = "" d
    ..w "{results:0,rows:[]}"
    .e  d
    ..w result

    //
    i Action = "getSubLocUserReqConfig" d
    .s subLoc=$Get(%request.Data("subLoc",1))
    .s configType=$Get(%request.Data("configType",1))
    .s result = ##class(web.DHCSTM.DHCSubLocReqConfig).jsSubLocUserReqConfig(Start,Limit,Sort,Dir,subLoc,configType)
    .i result = "" d
    ..w "{results:0,rows:[]}"
    .e  d
    ..w result

	i Action="SaveLocReq" d
	.s d=$Get(%request.Data("data",1))
	.s result=##class(web.DHCSTM.DHCSubLocReqConfig).SaveLocReq(d)
	.i result = "0" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	.


	i Action="DelLocReq" d
	.s r=$Get(%request.Data("RowId",1))
	.s result=##class(web.DHCSTM.DHCSubLocReqConfig).DeleteSubLocReqConfig(r)
	.i result = "0" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"



	i Action="SaveLocUserReq" d
	.s d=$Get(%request.Data("data",1))
	.s result=##class(web.DHCSTM.DHCSubLocReqConfig).SaveLocUserReq(d)
	.i result = "0" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"
	.


	i Action="DelLocUserReq" d
	.s r=$Get(%request.Data("RowId",1))
	.s result=##class(web.DHCSTM.DHCSubLocReqConfig).DeleteSubLocUserReqConfig(r)
	.i result = "0" d
	..w "{success:'true',info:''}"
	.e  d
	..w "{success:'false',info:'"_result_"'}"



</script>