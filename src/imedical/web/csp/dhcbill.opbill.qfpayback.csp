<!-- 
 * FileName: dhcbill.opbill.qfpayback.csp
 * Anchor: ZhYW
 * Date: 2019-10-10
 * Description: 门诊欠费补回
-->
<!DOCTYPE html>
<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
 if ##class(websys.SessionEvents).SessionExpired() quit 1
 quit 1
</csp:method>
<html>
<head>
	<TITLE><EXTHEALTH:TRANSLATE id=title>##(%session.Get("TITLE"))##</EXTHEALTH:TRANSLATE></TITLE>
	<EXTHEALTH:HEAD></EXTHEALTH:HEAD>
	<HISUI/>
	<DHCBILL/>
	<ADDINS/>
	<link rel='stylesheet' type='text/css' href='../scripts/dhcbill/themes/default/dhcbill.opbill.qfpayback.css'/>
	<script type="text/javascript" src="../scripts/dhcbill/dhcopbill/dhcbill.opbill.common.js"></script>
	<script type='text/javascript' src='../scripts/DHCWeb.OPCommonManageCard.js'></script>
	<script type='text/javascript' src='../scripts/DHCInsuPort.js'></script>
	<script type='text/javascript' src='../scripts/DHCWeb.OPYBComm.js'></script>
	<server>
		do ##class(web.UDHCCardCommLinkRegister).GetCardHardJSFunction()
		w "<input id='ReadAccExpEncrypt' name='ReadAccExpEncrypt' type='hidden' value='"_##class(%CSP.Page).Encrypt($lb("web.UDHCAccManageCLSIF.getaccinfofromcardno"))_"'>",$c(13,10)
		w "<input id='ReadOPDataEncrypt' name='ReadOPDataEncrypt' type='hidden' value='"_##class(%CSP.Page).Encrypt($lb("web.UDHCOPINVPrtIF.GetOPPrtData"))_"'>",$c(13,10)
		w "<input id='ReadCommOPDataEncrypt' name='ReadCommOPDataEncrypt' type='hidden' value='"_##class(%CSP.Page).Encrypt($lb("web.UDHCOPINVPrtIF.GetOPCommPrtData"))_"'>",$c(13,10)
		w "<input id='papmi' name='papmi' type='hidden'>",$c(13,10)
		w "<input id='insTypeId' name='insTypeId' type='hidden'>",$c(13,10)
	</server>
</head>

<body class="hisui-layout" data-options="fit:true">
	<div data-options="region:'north',border:false" style="height:66px;border-bottom:1px solid #ccc;padding:0 10px;overflow:hidden;">
		<a href="javascript:;" class="hisui-linkbutton big" id="btn-readCard" data-options="iconCls:'icon-big-card-reader',plain:true">读卡(F4)</a>
		<a href="javascript:;" class="hisui-linkbutton big" id="btn-find" data-options="iconCls:'icon-big-paper-search',plain:true">查询(F8)</a>
		<div class="datagrid-btn-separator big"></div>
		<a href="javascript:;" class="hisui-linkbutton big" id="btn-restore" data-options="iconCls:'icon-big-fee-arrow',plain:true">补回(F9)</a>
		<div class="datagrid-btn-separator big"></div>
		<a href="javascript:;" class="hisui-linkbutton big" id="btn-clear" data-options="iconCls:'icon-big-clear',plain:true">清屏(F7)</a>
	</div>
	<div data-options="region:'center',border:false" style="padding:10px;">
		<div class="hisui-layout" data-options="fit:true">
			<div data-options="region:'west',border:false" style="width:515px;padding-right:10px;">
				<div class="hisui-layout" id="head-menu" data-options="fit:true">
					<div data-options="region:'north',border:false" style="height:165px;">
						<div class="hisui-panel" data-options="title:'欠费收据查询',fit:true,headerCls:'panel-header-gray',iconCls:'icon-apply-check'" style="border-bottom-style:none;border-radius:0;">
							<table class="search-table" style="width:100%">
								<tr>
									<td class="r-label td-first-col"><label>卡类型</label></td>
									<td><input id="cardType" class="textbox"/></td>
									<td class="r-label td-second-col"><label>卡号</label></td>
									<td><input id="cardNo" class="textbox"/></td>
								</tr>
								<tr>
									<td class="r-label"><label>开始日期</label></td>
									<td><input id="stDate" class="hisui-datebox textbox"/></td>
									<td class="r-label"><label>结束日期</label></td>
									<td><input id="endDate" class="hisui-datebox textbox"/></td>
								</tr>
								<tr>
									<td class="r-label"><label>登记号</label></td>
									<td><input id="patientNo" class="textbox"/></td>
								</tr>
							</table>
						</div>
					</div>
					<div data-options="region:'center',bodyCls:'panel-body-gray'" style="border-radius:0 0 4px 4px;">
						<table class="hisui-datagrid" id="invList"></table>
		        	</div>
				</div>
			</div>
			<div data-options="region:'center',border:false">
				<div class="hisui-layout" data-options="fit:true">
					<div data-options="region:'north',border:false" style="height:136px;padding-bottom:10px;">
						<div class="hisui-panel" data-options="title:'补回',fit:true,headerCls:'panel-header-gray',iconCls:'icon-fee'">
							<table class="search-table">
								<tr>
									<td class="r-label td-first-col"><label>新费别</label></td>
									<td><input id="newInsType" class="hisui-combobox textbox"/></td>
									<td class="r-label r-label-1"><label>补回方式</label></td>
									<td><input id="refundMode" class="hisui-combobox textbox"/></td>
									<td class="r-label r-label-1">支付信息</td>
									<td rowspan="3">
										<div id="item-tip" style="display:none">
											<div class="messager-popover info tip-area">
												<span class="content">
													<span id="paymList" class="paym-content"></span>
												</span>
											</div>
										</div>
									</td>
								</tr>
								<tr>
									<td class="r-label"><label>补回金额</label></td>
									<td><input id="restoreAmt" class="hisui-numberbox textbox fontCls" data-options="min:0,precision:2,disabled:true" value="0" style="color:#ff0000;"/></td>
									<td class="r-label r-label-1"><label>当前票据号</label></td>
									<td><input id="receiptNo" class="textbox" style="font-weight: bold;" disabled/><a href="javascript:;" id="btn-tip" class="hisui-linkbutton" data-options="iconCls:'icon-tip',plain:true"></a></td>
								</tr>
							</table>
						</div>
					</div>
					<div data-options="region:'center',border:false">
						<table class="hisui-datagrid" id="ordItmList"></table>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="../scripts/dhcbill/dhcopbill/dhcbill.opbill.qfpayback.js"></script>
</body>
</html>