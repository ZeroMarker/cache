<server>
	//Put this first to avoid extra new lines before the XML
	d ..Display()
</server>
<csp:method name=OnPreHTTP arguments="" returntype=%Boolean>
 //<!-- Copyright (c) 2010 DHC Software Co.,Ltd. ALL RIGHTS RESERVED. -->
 //<!-- Copyright (c) 2002 TrakHealth Pty Limited. ALL RIGHTS RESERVED. --> 
 s %response.ContentType="text/xml"
 q 1
 quit 1
</csp:method>
<csp:method name=Display arguments="" returntype=%Boolean>
	n xmlData,xmlCount,xmlArray,mradm,MRPicRowId,FileName,AnnotRowId,ind,OEOrdResId
	s (xmlData,xmlArray,mradm,MRPicRowId,FileName,AnnotRowId,OEOrdResId)=""
	s xmlCount=1
	;ANA MRROWID passed from Java could be either of these 2 :- mradm,MRPicRowId
	;s ^zanju($zn,"hello ")=""
	;m xmlArray=%request.Data
	;m ^zanju($zn,"DATA ")=%request.Data
	s OEOrdResId=%request.Data("OEORDRESID",1)
	s MRROWID=%request.Data("MRROWID",1)
	i MRROWID'="",'(MRROWID["||"),##class(User.MRAdm).%OpenId(MRROWID) d
	. s mradm=MRROWID
	i MRROWID'="",(MRROWID["||"),##class(User.MRPictures).%OpenId(MRROWID) d
	. s MRPicRowId=MRROWID
	i MRPicRowId'="" d
	.&SQL(SELECT ANNOT_RowId
	INTO :AnnotRowId
	FROM SQLUser.OE_Annotation
	WHERE ANNOT_MRPic_DR=:MRPicRowId
	)
	i OEOrdResId'="" d
	. &SQL(SELECT ANNOT_RowId
	INTO :AnnotRowId
	FROM SQLUser.OE_Annotation
	WHERE ANNOT_OEOrdRes_DR=:OEOrdResId	
	)
	i AnnotRowId'="" d
	. s ind=0 f  s ind=$o(^OEAN(AnnotRowId,"TXT",ind)) q:ind=""  d
	. . w $g(^OEAN(AnnotRowId,"TXT",ind))
 q 1
</csp:method>
